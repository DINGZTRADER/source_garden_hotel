/*! For license information please see main.21537a79.js.LICENSE.txt */
(()=>{"use strict";var e={43(e,t,n){e.exports=n(202)},153(e,t,n){var r=n(43),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,p(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,N=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var s,i={},a=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)N.call(t,s)&&!k.hasOwnProperty(s)&&(i[s]=t[s]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===i[s]&&(i[s]=l[s]);return{$$typeof:n,type:e,key:a,ref:o,props:i,_owner:S.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,s,i,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===i?"."+E(l,0):i,w(a)?(s="",null!=e&&(s=e.replace(I,"$&/")+"/"),C(a,t,s,"",function(e){return e})):null!=a&&(_(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var u=i+E(o=e[c],c);l+=C(o,t,s,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,s,u=i+E(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],s=0;return C(e,r,"","",function(e){return t.call(n,e,s++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},P={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:S};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=a,t.PureComponent=x,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=p({},e.props),i=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)N.call(t,c)&&!k.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:i,ref:a,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<i(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,a=s>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<s&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<s&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!p)if(null!==r(c))p=!0,R(N);else{var t=r(u);null!==t&&P(w,t.startTime-e)}}function N(e,n){p=!1,g&&(g=!1,y(_),_=-1),m=!0;var i=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&s(c),b(n)}else s(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&P(w,d.startTime-n),l=!1}return l}finally{h=null,f=i,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,j=null,_=-1,I=5,E=-1;function C(){return!(t.unstable_now()-E<I)}function T(){if(null!==j){var e=t.unstable_now();E=e;var n=!0;try{n=j(!0,e)}finally{n?S():(k=!1,j=null)}}else k=!1}if("function"===typeof x)S=function(){x(T)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=T,S=function(){D.postMessage(null)}}else S=function(){v(T,0)};function R(e){j=e,k||(k=!0,S())}function P(e,n){_=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,R(N))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,s,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(y(_),_=-1):g=!0,P(w,i-a))):(e.sortIndex=o,n(c,e),p||m||(p=!0,R(N))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391(e,t,n){var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579(e,t,n){e.exports=n(153)},730(e,t,n){var r=n(43),s=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,n,r,s,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,n,r){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!d.call(m,e)||!d.call(f,e)&&(h.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),N=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),I=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var L,M=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),i=r.stack.split("\n"),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(1!==a||1!==o)do{if(a--,0>--o||s[a]!==i[o]){var l="\n"+s[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case N:return"Portal";case j:return"Profiler";case k:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function $(e,t){Y(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(fe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ne=null,Se=null,ke=null;function je(e){if(e=xs(e)){if("function"!==typeof Ne)throw Error(i(280));var t=e.stateNode;t&&(t=ws(t),Ne(e.stateNode,e.type,t))}}function _e(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ie(){if(Se){var e=Se,t=ke;if(ke=Se=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var Te=!1;function Ae(e,t,n){if(Te)return e(t,n);Te=!0;try{return Ee(e,t,n)}finally{Te=!1,(null!==Se||null!==ke)&&(Ce(),Ie())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Re=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){Re=!1}function Oe(e,t,n,r,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Me=null,Fe=!1,Ue=null,Ve={onError:function(e){Le=!0,Me=e}};function ze(e,t,n,r,s,i,a,o,l){Le=!1,Me=null,Oe.apply(Ve,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(r=s.return)){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return He(s),e;if(a===r)return He(s),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=s.unstable_scheduleCallback,Qe=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Je=s.unstable_requestPaint,Ye=s.unstable_now,$e=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~s;0!==o?r=dt(o):0!==(i&=a)&&(r=dt(i))}else 0!==(a=n&~s)?r=dt(a):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(i=t&-t)||16===s&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-at(t)),r|=e[n],t&=~s;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Nt,St,kt,jt,_t=!1,It=[],Et=null,Ct=null,Tt=null,At=new Map,Dt=new Map,Rt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,n,r,s,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},null!==t&&(null!==(t=xs(t))&&Nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Mt(e){var t=ys(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void jt(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xs(n))&&Nt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){_t=!1,null!==Et&&Ft(Et)&&(Et=null),null!==Ct&&Ft(Ct)&&(Ct=null),null!==Tt&&Ft(Tt)&&(Tt=null),At.forEach(Ut),Dt.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Vt)))}function Bt(e){function t(t){return zt(t,e)}if(0<It.length){zt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&zt(Et,e),null!==Ct&&zt(Ct,e),null!==Tt&&zt(Tt,e),At.forEach(t),Dt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Rt.shift()}var qt=b.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var s=xt,i=qt.transition;qt.transition=null;try{xt=1,Kt(e,t,n,r)}finally{xt=s,qt.transition=i}}function Wt(e,t,n,r){var s=xt,i=qt.transition;qt.transition=null;try{xt=4,Kt(e,t,n,r)}finally{xt=s,qt.transition=i}}function Kt(e,t,n,r){if(Ht){var s=Xt(e,t,n,r);if(null===s)Hr(e,t,r,Qt,n),Ot(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return Et=Lt(Et,e,t,n,r,s),!0;case"dragenter":return Ct=Lt(Ct,e,t,n,r,s),!0;case"mouseover":return Tt=Lt(Tt,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return At.set(i,Lt(At.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Dt.set(i,Lt(Dt.get(i)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==s;){var i=xs(s);if(null!==i&&wt(i),null===(i=Xt(e,t,n,r))&&Hr(e,t,r,Qt,n),i===s)break;s=i}null!==s&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Qt=null;function Xt(e,t,n,r){if(Qt=null,null!==(e=ys(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,s="value"in Yt?Yt.value:Yt.textContent,i=s.length;for(e=0;e<r&&n[e]===s[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===s[i-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=M({},cn,{view:0,detail:0}),hn=sn(dn),fn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=sn(fn),pn=sn(M({},fn,{dataTransfer:0})),gn=sn(M({},dn,{relatedTarget:0})),vn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=sn(yn),bn=sn(M({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function jn(){return kn}var _n=M({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(_n),En=sn(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),Tn=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(An),Rn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Ln=u&&"TextEvent"in window&&!On,Mn=u&&(!Pn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Gn(e,t,n,r){_e(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Kn=null;function Qn(e){Fr(e,0)}function Xn(e){if(K(bs(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Yn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Kn=Wn=null)}function nr(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Gn(t,Kn,e,we(e)),Ae(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function ir(e,t){if("click"===e)return Xn(t)}function ar(e,t){if("input"===e||"change"===e)return Xn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!d.call(t,s)||!or(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=void 0===r.end?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ur(n,i);var a=ur(n,r);s&&a&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,xr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Wr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},kr={};function jr(e){if(Sr[e])return Sr[e];if(!Nr[e])return e;var t,n=Nr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Sr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);var _r=jr("animationend"),Ir=jr("animationiteration"),Er=jr("animationstart"),Cr=jr("transitionend"),Tr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Tr.set(e,t),l(t,[e])}for(var Rr=0;Rr<Ar.length;Rr++){var Pr=Ar[Rr];Dr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Dr(_r,"onAnimationEnd"),Dr(Ir,"onAnimationIteration"),Dr(Er,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,a,o,l,c){if(ze.apply(this,arguments),Le){if(!Le)throw Error(i(198));var u=Me;Le=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[ps];void 0===n&&(n=t[ps]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Vr("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Jt(t)){case 1:var s=Gt;break;case 4:s=Wt;break;default:s=Kt}n=s.bind(null,t,n,e),s=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,s){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;a=a.return}for(;null!==o;){if(null===(a=ys(o)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}o=o.parentNode}}r=r.return}Ae(function(){var r=i,s=we(n),a=[];e:{var o=Tr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case _r:case Ir:case Er:l=vn;break;case Cr:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=r;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==h&&(null!=(p=De(m,h))&&u.push(Gr(m,p,f)))),d)break;m=m.return}0<u.length&&(o=new l(o,c,null,n,s),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[ms])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,p="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=En,p="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?o:bs(l),f=null==c?o:bs(c),(o=new u(p,m+"leave",l,n,s)).target=d,o.relatedTarget=f,p=null,ys(s)===r&&((u=new u(h,m+"enter",c,n,s)).target=f,u.relatedTarget=d,p=u),d=p,l&&c)e:{for(h=c,m=0,f=u=l;f;f=Kr(f))m++;for(f=0,p=h;p;p=Kr(p))f++;for(;0<m-f;)u=Kr(u),m--;for(;0<f-m;)h=Kr(h),f--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Qr(a,o,l,u,!1),null!==c&&null!==d&&Qr(a,d,c,u,!0)}if("select"===(l=(o=r?bs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Hn(o))if(Yn)g=ar;else{g=sr;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?Gn(a,g,n,s):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?bs(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,br(a,n,s);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":br(a,n,s)}var y;if(Pn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Bn?Vn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Mn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Bn&&(y=en()):($t="value"in(Yt=s)?Yt.value:Yt.textContent,Bn=!0)),0<(v=Wr(r,x)).length&&(x=new bn(x,e,null,n,s),a.push({event:x,listeners:v}),y?x.data=y:null!==(y=zn(n))&&(x.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Pn&&Vn(e,t)?(e=en(),Zt=$t=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(s=new bn("onBeforeInput","beforeinput",null,n,s),a.push({event:s,listeners:r}),s.data=y))}Fr(a,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,i=s.stateNode;5===s.tag&&null!==i&&(s=i,null!=(i=De(e,n))&&r.unshift(Gr(e,i,s)),null!=(i=De(e,t))&&r.push(Gr(e,i,s))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,s){for(var i=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=De(n,i))&&a.unshift(Gr(n,l,o)):s||null!=(l=De(n,i))&&a.push(Gr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Xr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Jr,"")}function $r(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(i(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,is="function"===typeof Promise?Promise:void 0,as="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof is?function(e){return is.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout(function(){throw e})}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Bt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,fs="__reactProps$"+ds,ms="__reactContainer$"+ds,ps="__reactEvents$"+ds,gs="__reactListeners$"+ds,vs="__reactHandles$"+ds;function ys(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ms]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function xs(e){return!(e=e[hs]||e[ms])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ws(e){return e[fs]||null}var Ns=[],Ss=-1;function ks(e){return{current:e}}function js(e){0>Ss||(e.current=Ns[Ss],Ns[Ss]=null,Ss--)}function _s(e,t){Ss++,Ns[Ss]=e.current,e.current=t}var Is={},Es=ks(Is),Cs=ks(!1),Ts=Is;function As(e,t){var n=e.type.contextTypes;if(!n)return Is;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,i={};for(s in n)i[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ds(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rs(){js(Cs),js(Es)}function Ps(e,t,n){if(Es.current!==Is)throw Error(i(168));_s(Es,t),_s(Cs,n)}function Os(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(i(108,q(e)||"Unknown",s));return M({},n,r)}function Ls(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Is,Ts=Es.current,_s(Es,e),_s(Cs,Cs.current),!0}function Ms(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Os(e,t,Ts),r.__reactInternalMemoizedMergedChildContext=e,js(Cs),js(Es),_s(Es,e)):js(Cs),_s(Cs,n)}var Fs=null,Us=!1,Vs=!1;function zs(e){null===Fs?Fs=[e]:Fs.push(e)}function Bs(){if(!Vs&&null!==Fs){Vs=!0;var e=0,t=xt;try{var n=Fs;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fs=null,Us=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),Ke(Ze,Bs),s}finally{xt=t,Vs=!1}}return null}var qs=[],Hs=0,Gs=null,Ws=0,Ks=[],Qs=0,Xs=null,Js=1,Ys="";function $s(e,t){qs[Hs++]=Ws,qs[Hs++]=Gs,Gs=e,Ws=t}function Zs(e,t,n){Ks[Qs++]=Js,Ks[Qs++]=Ys,Ks[Qs++]=Xs,Xs=e;var r=Js;e=Ys;var s=32-at(r)-1;r&=~(1<<s),n+=1;var i=32-at(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Js=1<<32-at(t)+s|n<<s|r,Ys=i+e}else Js=1<<i|n<<s|r,Ys=e}function ei(e){null!==e.return&&($s(e,1),Zs(e,1,0))}function ti(e){for(;e===Gs;)Gs=qs[--Hs],qs[Hs]=null,Ws=qs[--Hs],qs[Hs]=null;for(;e===Xs;)Xs=Ks[--Qs],Ks[Qs]=null,Ys=Ks[--Qs],Ks[Qs]=null,Js=Ks[--Qs],Ks[Qs]=null}var ni=null,ri=null,si=!1,ii=null;function ai(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xs?{id:Js,overflow:Ys}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(si){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=cs(n.nextSibling);var r=ni;t&&oi(e,t)?ai(r,n):(e.flags=-4097&e.flags|2,si=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,si=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!si)return ui(e),si=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)ai(e,t),t=cs(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?cs(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=cs(e.nextSibling)}function fi(){ri=ni=null,si=!1}function mi(e){null===ii?ii=[e]:ii.push(e)}var pi=b.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var s=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=s.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&yi(i)===t.type)?((r=s(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,i)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case N:return(t=Uc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Lc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function f(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case N:return n.key===s?u(e,t,n,r):null;case D:return f(e,t,(s=n._init)(n._payload),r)}if(te(n)||O(n))return null!==s?null:d(e,t,n,r,null);vi(e,n)}return null}function m(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case N:return u(t,e=e.get(null===r.key?n:r.key)||null,r,s);case D:return m(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,s,null);vi(t,r)}return null}function p(s,i,o,l){for(var c=null,u=null,d=i,p=i=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=f(s,d,o[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(s,d),i=a(v,i,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===o.length)return n(s,d),si&&$s(s,p),c;if(null===d){for(;p<o.length;p++)null!==(d=h(s,o[p],l))&&(i=a(d,i,p),null===u?c=d:u.sibling=d,u=d);return si&&$s(s,p),c}for(d=r(s,d);p<o.length;p++)null!==(g=m(d,s,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),i=a(g,i,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(s,e)}),si&&$s(s,p),c}function g(s,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,p=o,g=o=0,v=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var x=f(s,p,y.value,c);if(null===x){null===p&&(p=v);break}e&&p&&null===x.alternate&&t(s,p),o=a(x,o,g),null===d?u=x:d.sibling=x,d=x,p=v}if(y.done)return n(s,p),si&&$s(s,g),u;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=h(s,y.value,c))&&(o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return si&&$s(s,g),u}for(p=r(s,p);!y.done;g++,y=l.next())null!==(y=m(p,s,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(s,e)}),si&&$s(s,g),u}return function e(r,i,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=i;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(i=s(u,a.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&yi(c)===u.type){n(r,u.sibling),(i=s(u,a.props)).ref=gi(r,u,a),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((i=Lc(a.props.children,r.mode,l,a.key)).return=r,r=i):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=gi(r,i,a),l.return=r,r=l)}return o(r);case N:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=s(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Uc(a,r.mode,l)).return=r,r=i}return o(r);case D:return e(r,i,(u=a._init)(a._payload),l)}if(te(a))return p(r,i,a,l);if(O(a))return g(r,i,a,l);vi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=s(i,a)).return=r,r=i):(n(r,i),(i=Fc(a,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var bi=xi(!0),wi=xi(!1),Ni=ks(null),Si=null,ki=null,ji=null;function _i(){ji=ki=Si=null}function Ii(e){var t=Ni.current;js(Ni),e._currentValue=t}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t){Si=e,ji=ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(ji!==e)if(e={context:e,memoizedValue:t,next:null},null===ki){if(null===Si)throw Error(i(308));ki=e,Si.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var Ai=null;function Di(e){null===Ai?Ai=[e]:Ai.push(e)}function Ri(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Di(t)):(n.next=s.next,s.next=n),t.interleaved=n,Pi(e,r)}function Pi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ui(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Pi(e,n)}return null===(s=r.interleaved)?(t.next=t,Di(r)):(t.next=s.next,s.next=t),r.interleaved=t,Pi(e,n)}function Vi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function zi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?s=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?s=i=t:i=i.next=t}else s=i=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var s=e.updateQueue;Oi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=s.baseState;for(a=0,u=c=l=null,o=i;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,f=n,p.tag){case 1:if("function"===typeof(m=p.payload)){d=m.call(f,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=p.payload)?m.call(f,d,h):m)||void 0===h)break e;d=M({},d,h);break e;case 2:Oi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{a|=s.lane,s=s.next}while(s!==t)}else null===i&&(s.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function qi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(i(191,s));s.call(r)}}}var Hi={},Gi=ks(Hi),Wi=ks(Hi),Ki=ks(Hi);function Xi(e){if(e===Hi)throw Error(i(174));return e}function Ji(e,t){switch(_s(Ki,t),_s(Wi,e),_s(Gi,Hi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}js(Gi),_s(Gi,t)}function Yi(){js(Gi),js(Wi),js(Ki)}function $i(e){Xi(Ki.current);var t=Xi(Gi.current),n=le(t,e.type);t!==n&&(_s(Wi,e),_s(Gi,n))}function Zi(e){Wi.current===e&&(js(Gi),js(Wi))}var ea=ks(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var sa=b.ReactCurrentDispatcher,ia=b.ReactCurrentBatchConfig,aa=0,oa=null,la=null,ca=null,ua=!1,da=!1,ha=0,fa=0;function ma(){throw Error(i(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,s,a){if(aa=a,oa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,sa.current=null===e||null===e.memoizedState?eo:to,e=n(r,s),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(i(301));a+=1,ca=la=null,t.updateQueue=null,sa.current=no,e=n(r,s)}while(da)}if(sa.current=Za,t=null!==la&&null!==la.next,aa=0,ca=la=oa=null,ua=!1,t)throw Error(i(300));return e}function va(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?oa.memoizedState=ca=e:ca=ca.next=e,ca}function xa(){if(null===la){var e=oa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?oa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(i(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?oa.memoizedState=ca=e:ca=ca.next=e}return ca}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=la,s=r.baseQueue,a=n.pending;if(null!==a){if(null!==s){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(null!==s){a=s.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((aa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,oa.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{a=s.lane,oa.lanes|=a,Ml|=a,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Na(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,a=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{a=e(a,o.action),o=o.next}while(o!==s);or(a,t.memoizedState)||(wo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function ka(e,t){var n=oa,r=xa(),s=t(),a=!or(r.memoizedState,s);if(a&&(r.memoizedState=s,wo=!0),r=r.queue,La(Ia.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,Aa(9,_a.bind(null,n,r,s,t),void 0,null),null===Tl)throw Error(i(349));0!==(30&aa)||ja(n,t,s)}return s}function ja(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oa.updateQueue)?(t={lastEffect:null,stores:null},oa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _a(e,t,n,r){t.value=n,t.getSnapshot=r,Ea(t)&&Ca(e)}function Ia(e,t,n){return n(function(){Ea(t)&&Ca(e)})}function Ea(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ca(e){var t=Pi(e,1);null!==t&&rc(t,e,1,-1)}function Ta(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Xa.bind(null,oa,e),[t.memoizedState,e]}function Aa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oa.updateQueue)?(t={lastEffect:null,stores:null},oa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Da(){return xa().memoizedState}function Ra(e,t,n,r){var s=ya();oa.flags|=e,s.memoizedState=Aa(1|t,n,void 0,void 0===r?null:r)}function Pa(e,t,n,r){var s=xa();r=void 0===r?null:r;var i=void 0;if(null!==la){var a=la.memoizedState;if(i=a.destroy,null!==r&&pa(r,a.deps))return void(s.memoizedState=Aa(t,n,i,r))}oa.flags|=e,s.memoizedState=Aa(1|t,n,i,r)}function Oa(e,t){return Ra(8390656,8,e,t)}function La(e,t){return Pa(2048,8,e,t)}function Ma(e,t){return Pa(4,2,e,t)}function Fa(e,t){return Pa(4,4,e,t)}function Ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Va(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4,4,Ua.bind(null,t,e),n)}function za(){}function qa(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ha(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ga(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=pt(),oa.lanes|=n,Ml|=n,e.baseState=!0),t)}function Wa(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{xt=n,ia.transition=r}}function Ka(){return xa().memoizedState}function Qa(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ja(e))Ya(t,n);else if(null!==(n=Ri(e,t,n,r))){rc(n,e,r,tc()),$a(n,t,r)}}function Xa(e,t,n){var r=nc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ja(e))Ya(t,s);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=i(a,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(s.next=s,Di(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Ri(e,t,s,r))&&(rc(n,e,r,s=tc()),$a(n,t,r))}}function Ja(e){var t=e.alternate;return e===oa||null!==t&&t===oa}function Ya(e,t){da=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $a(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Za={readContext:Ti,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useInsertionEffect:ma,useLayoutEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useMutableSource:ma,useSyncExternalStore:ma,useId:ma,unstable_isNewReconciler:!1},eo={readContext:Ti,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ra(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ra(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ra(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qa.bind(null,oa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ta,useDebugValue:za,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ta(!1),t=e[0];return e=Wa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oa,s=ya();if(si){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Tl)throw Error(i(349));0!==(30&aa)||ja(r,t,n)}s.memoizedState=n;var a={value:n,getSnapshot:t};return s.queue=a,Oa(Ia.bind(null,r,a,e),[e]),r.flags|=2048,Aa(9,_a.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Tl.identifierPrefix;if(si){var n=Ys;t=":"+t+"R"+(n=(Js&~(1<<32-at(Js)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},to={readContext:Ti,useCallback:qa,useContext:Ti,useEffect:La,useImperativeHandle:Va,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:Ha,useReducer:wa,useRef:Da,useState:function(){return wa(ba)},useDebugValue:za,useDeferredValue:function(e){return Ga(xa(),la.memoizedState,e)},useTransition:function(){return[wa(ba)[0],xa().memoizedState]},useMutableSource:Sa,useSyncExternalStore:ka,useId:Ka,unstable_isNewReconciler:!1},no={readContext:Ti,useCallback:qa,useContext:Ti,useEffect:La,useImperativeHandle:Va,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:Ha,useReducer:Na,useRef:Da,useState:function(){return Na(ba)},useDebugValue:za,useDeferredValue:function(e){var t=xa();return null===la?t.memoizedState=e:Ga(t,la.memoizedState,e)},useTransition:function(){return[Na(ba)[0],xa().memoizedState]},useMutableSource:Sa,useSyncExternalStore:ka,useId:Ka,unstable_isNewReconciler:!1};function ro(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function so(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),s=nc(e),i=Fi(r,s);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,s))&&(rc(t,e,s,r),Vi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),s=nc(e),i=Fi(r,s);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,s))&&(rc(t,e,s,r),Vi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),s=Fi(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Ui(e,s,r))&&(rc(t,e,r,n),Vi(t,e,r))}};function ao(e,t,n,r,s,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,i))}function oo(e,t,n){var r=!1,s=Is,i=t.contextType;return"object"===typeof i&&null!==i?i=Ti(i):(s=Ds(t)?Ts:Es.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?As(e,s):Is),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function co(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?s.context=Ti(i):(i=Ds(t)?Ts:Es.current,s.context=As(e,i)),s.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(so(e,t,i,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&io.enqueueReplaceState(s,s.state,null),Bi(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function uo(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var s=n}catch(i){s="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:s,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var mo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Fi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gl||(Gl=!0,Wl=r),fo(0,t)},n}function go(e,t,n){(n=Fi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fo(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new mo;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fi(-1,1)).tag=2,Ui(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var bo=b.ReactCurrentOwner,wo=!1;function No(e,t,n,r){t.child=null===e?wi(t,null,n,r):bi(t,e.child,n,r)}function So(e,t,n,r,s){n=n.render;var i=t.ref;return Ci(t,s),r=ga(e,t,n,r,i,s),n=va(),null===e||wo?(si&&n&&ei(t),t.flags|=1,No(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Go(e,t,s))}function ko(e,t,n,r,s){if(null===e){var i=n.type;return"function"!==typeof i||Rc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,jo(e,t,i,r,s))}if(i=e.child,0===(e.lanes&s)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Go(e,t,s)}return t.flags|=1,(e=Pc(i,r)).ref=t.ref,e.return=t,t.child=e}function jo(e,t,n,r,s){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=i,0===(e.lanes&s))return t.lanes=e.lanes,Go(e,t,s);0!==(131072&e.flags)&&(wo=!0)}}return Eo(e,t,n,r,s)}function _o(e,t,n){var r=t.pendingProps,s=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_s(Pl,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_s(Pl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,_s(Pl,Rl),Rl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,_s(Pl,Rl),Rl|=r;return No(e,t,s,n),t.child}function Io(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,r,s){var i=Ds(n)?Ts:Es.current;return i=As(t,i),Ci(t,s),n=ga(e,t,n,r,i,s),r=va(),null===e||wo?(si&&r&&ei(t),t.flags|=1,No(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Go(e,t,s))}function Co(e,t,n,r,s){if(Ds(n)){var i=!0;Ls(t)}else i=!1;if(Ci(t,s),null===t.stateNode)Ho(e,t),oo(t,n,r),co(t,n,r,s),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ti(c):c=As(t,c=Ds(n)?Ts:Es.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&lo(t,a,r,c),Oi=!1;var h=t.memoizedState;a.state=h,Bi(t,r,a,s),l=t.memoizedState,o!==r||h!==l||Cs.current||Oi?("function"===typeof u&&(so(t,n,u,r),l=t.memoizedState),(o=Oi||ao(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Mi(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ro(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ti(l):l=As(t,l=Ds(n)?Ts:Es.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&lo(t,a,r,l),Oi=!1,h=t.memoizedState,a.state=h,Bi(t,r,a,s);var m=t.memoizedState;o!==d||h!==m||Cs.current||Oi?("function"===typeof f&&(so(t,n,f,r),m=t.memoizedState),(c=Oi||ao(t,n,c,r,h,m,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,m,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return To(e,t,n,r,i,s)}function To(e,t,n,r,s,i){Io(e,t);var a=0!==(128&t.flags);if(!r&&!a)return s&&Ms(t,n,!1),Go(e,t,i);r=t.stateNode,bo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=bi(t,e.child,null,i),t.child=bi(t,null,o,i)):No(e,t,o,i),t.memoizedState=r.state,s&&Ms(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Ps(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ps(0,t.context,!1),Ji(e,t.containerInfo)}function Do(e,t,n,r,s){return fi(),mi(s),t.flags|=256,No(e,t,n,r),t.child}var Ro,Po,Oo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,s=t.pendingProps,a=ea.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),_s(ea,1&a),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,s,0,null),e=Lc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Lo,e):Uo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,s,a,o){if(n)return 256&t.flags?(t.flags&=-257,Vo(e,t,o,r=ho(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=Mc({mode:"visible",children:r.children},s,0,null),(a=Lc(a,s,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&bi(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,a);if(0===(1&t.mode))return Vo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Vo(e,t,o,r=ho(a=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(r=Tl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==a.retryLane&&(a.retryLane=s,Pi(e,s),rc(r,e,s,-1))}return gc(),Vo(e,t,o,r=ho(Error(i(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ri=cs(s.nextSibling),ni=t,si=!0,ii=null,null!==e&&(Ks[Qs++]=Js,Ks[Qs++]=Ys,Ks[Qs++]=Xs,Js=e.id,Ys=e.overflow,Xs=t),t=Uo(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,a,n);if(o){o=s.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==a?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Pc(r,o):(o=Lc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,s}return e=(o=e.child).sibling,s=Pc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Uo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vo(e,t,n,r){return null!==r&&mi(r),bi(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function Bo(e,t,n,r,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function qo(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(No(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_s(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Bo(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ta(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Bo(t,!0,n,null,i);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Go(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wo(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qo(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ds(t.type)&&Rs(),Ko(t),null;case 3:return r=t.stateNode,Yi(),js(Cs),js(Es),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),Ko(t),null;case 5:Zi(t);var s=Xi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Ko(t),null}if(e=Xi(Gi.current),di(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hs]=t,r[fs]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(s=0;s<Or.length;s++)Ur(Or[s],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":se(r,a),Ur("invalid",r)}for(var l in ye(n,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,a,!0);break;case"textarea":W(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[fs]=r,Ro(e,t),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),s=r;break;case"iframe":case"object":case"embed":Ur("load",e),s=r;break;case"video":case"audio":for(s=0;s<Or.length;s++)Ur(Or[s],e);s=r;break;case"source":Ur("error",e),s=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),s=r;break;case"details":Ur("toggle",e),s=r;break;case"input":J(e,r),s=X(e,r),Ur("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Ur("invalid",e)}for(a in ye(n,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&x(e,a,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Oo(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Xi(Ki.current),Xi(Gi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(a=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Ko(t),null;case 13:if(js(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(si&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),fi(),t.flags|=98560,a=!1;else if(a=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[hs]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),a=!1}else null!==ii&&(oc(ii),ii=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Yi(),null===e&&Br(t.stateNode.containerInfo),Ko(t),null;case 10:return Ii(t.type._context),Ko(t),null;case 19:if(js(ea),null===(a=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Wo(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Wo(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _s(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Ye()>ql&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!si)return Ko(t),null}else 2*Ye()-a.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ye(),t.sibling=null,n=ea.current,_s(ea,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xo(e,t){switch(ti(t),t.tag){case 1:return Ds(t.type)&&Rs(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yi(),js(Cs),js(Es),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(js(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return js(ea),null;case 4:return Yi(),null;case 10:return Ii(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Xi(Gi.current);var i,a=null;switch(n){case"input":s=X(e,s),r=X(e,r),a=[];break;case"select":s=M({},s,{value:void 0}),r=M({},r,{value:void 0}),a=[];break;case"textarea":s=re(e,s),r=re(e,r),a=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=s?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Jo=!1,Yo=!1,$o="function"===typeof WeakSet?WeakSet:Set,Zo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){jc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){jc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,void 0!==i&&tl(t,n,i)}s=s.next}while(s!==r)}}function sl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[fs],delete t[ps],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,hl=!1;function fl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Yo||el(n,t);case 6:var r=dl,s=hl;dl=null,fl(e,t,n),hl=s,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Bt(e)):ls(dl,n.stateNode));break;case 4:r=dl,s=hl,dl=n.stateNode.containerInfo,hl=!0,fl(e,t,n),dl=r,hl=s;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&tl(n,t,a),s=s.next}while(s!==r)}fl(e,t,n);break;case 1:if(!Yo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){jc(n,t,o)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,fl(e,t,n),Yo=r):fl(e,t,n);break;default:fl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $o),t.forEach(function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(i(160));ml(a,o,s),dl=null,hl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){jc(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),sl(3,e)}catch(g){jc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){jc(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){jc(e,e.return,g)}}if(4&r&&null!=(s=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Y(s,a),xe(l,o);var u=xe(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):x(s,d,h,u)}switch(l){case"input":$(s,a);break;case"textarea":ie(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;null!=m?ne(s,!!a.multiple,m,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(s,!!a.multiple,a.defaultValue,!0):ne(s,!!a.multiple,a.multiple?[]:"",!1))}s[fs]=a}catch(g){jc(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(i(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){jc(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){jc(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(s=e.child).flags&&(a=null!==s.memoizedState,s.stateNode.isHidden=a,!a||null!==s.alternate&&null!==s.alternate.memoizedState||(Bl=Ye())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(u=Yo)||d,gl(t,e),Yo=u):gl(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zo=e,d=e.child;null!==d;){for(h=Zo=d;null!==Zo;){switch(m=(f=Zo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){jc(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){Nl(h);continue}}null!==m?(m.return=f,Zo=m):Nl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(g){jc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){jc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),ul(e,ll(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;cl(e,ll(e),a);break;default:throw Error(i(161))}}catch(Ba){jc(e,e.return,Ba)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){Zo=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Zo;){var s=Zo,i=s.child;if(22===s.tag&&r){var a=null!==s.memoizedState||Jo;if(!a){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Jo;var c=Yo;if(Jo=a,(Yo=l)&&!c)for(Zo=s;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?Sl(s):null!==l?(l.return=a,Zo=l):Sl(s);for(;null!==i;)Zo=i,bl(i,t,n),i=i.sibling;Zo=s,Jo=o,Yo=c}wl(e)}else 0!==(8772&s.subtreeFlags)&&null!==i?(i.return=s,Zo=i):wl(e)}}function wl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||sl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:ro(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&qi(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(i(163))}Yo||512&t.flags&&il(t)}catch(f){jc(t,t.return,f)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function Nl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function Sl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sl(4,t)}catch(Ba){jc(t,n,Ba)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(Ba){jc(t,s,Ba)}}var i=t.return;try{il(t)}catch(Ba){jc(t,i,Ba)}break;case 5:var a=t.return;try{il(t)}catch(Ba){jc(t,a,Ba)}}}catch(Ba){jc(t,t.return,Ba)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var kl,jl=Math.ceil,_l=b.ReactCurrentDispatcher,Il=b.ReactCurrentOwner,El=b.ReactCurrentBatchConfig,Cl=0,Tl=null,Al=null,Dl=0,Rl=0,Pl=ks(0),Ol=0,Ll=null,Ml=0,Fl=0,Ul=0,Vl=null,zl=null,Bl=0,ql=1/0,Hl=null,Gl=!1,Wl=null,Kl=null,Ql=!1,Xl=null,Jl=0,Yl=0,$l=null,Zl=-1,ec=0;function tc(){return 0!==(6&Cl)?Ye():-1!==Zl?Zl:Zl=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Dl?Dl&-Dl:null!==pi.transition?(0===ec&&(ec=pt()),ec):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function rc(e,t,n,r){if(50<Yl)throw Yl=0,$l=null,Error(i(185));vt(e,n,r),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Fl|=n),4===Ol&&lc(e,Dl)),sc(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(ql=Ye()+500,Us&&Bs()))}function sc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),o=1<<a,l=s[a];-1===l?0!==(o&n)&&0===(o&r)||(s[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Tl?Dl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Us=!0,zs(e)}(cc.bind(null,e)):zs(cc.bind(null,e)),as(function(){0===(6&Cl)&&Bs()}),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Zl=-1,ec=0,0!==(6&Cl))throw Error(i(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var s=Cl;Cl|=2;var a=pc();for(Tl===e&&Dl===t||(Hl=null,ql=Ye()+500,fc(e,t));;)try{xc();break}catch(l){mc(e,l)}_i(),_l.current=a,Cl=s,null!==Al?t=0:(Tl=null,Dl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(r=s,t=ac(e,s))),1===t)throw n=Ll,fc(e,0),lc(e,r),sc(e,Ye()),n;if(6===t)lc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!or(i(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=vc(e,r))&&(0!==(a=mt(e))&&(r=a,t=ac(e,a))),1===t))throw n=Ll,fc(e,0),lc(e,r),sc(e,Ye()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:Nc(e,zl,Hl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Bl+500-Ye())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(Nc.bind(null,e,zl,Hl),t);break}Nc(e,zl,Hl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>s&&(s=o),r&=~a}if(r=s,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jl(r/1960))-r)){e.timeoutHandle=rs(Nc.bind(null,e,zl,Hl),r);break}Nc(e,zl,Hl);break;default:throw Error(i(329))}}}return sc(e,Ye()),e.callbackNode===n?ic.bind(null,e):null}function ac(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~Ul,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Cl))throw Error(i(327));Sc();var t=ht(e,0);if(0===(1&t))return sc(e,Ye()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ll,fc(e,0),lc(e,t),sc(e,Ye()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Nc(e,zl,Hl),sc(e,Ye()),null}function uc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(ql=Ye()+500,Us&&Bs())}}function dc(e){null!==Xl&&0===Xl.tag&&0===(6&Cl)&&Sc();var t=Cl;Cl|=1;var n=El.transition,r=xt;try{if(El.transition=null,xt=1,e)return e()}finally{xt=r,El.transition=n,0===(6&(Cl=t))&&Bs()}}function hc(){Rl=Pl.current,js(Pl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Rs();break;case 3:Yi(),js(Cs),js(Es),ra();break;case 5:Zi(r);break;case 4:Yi();break;case 13:case 19:js(ea);break;case 10:Ii(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Al=e=Pc(e.current,null),Dl=Rl=t,Ol=0,Ll=null,Ul=Fl=Ml=0,zl=Vl=null,null!==Ai){for(t=0;t<Ai.length;t++)if(null!==(r=(n=Ai[t]).interleaved)){n.interleaved=null;var s=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=s,r.next=a}n.pending=r}Ai=null}return e}function mc(e,t){for(;;){var n=Al;try{if(_i(),sa.current=Za,ua){for(var r=oa.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=oa=null,da=!1,ha=0,Il.current=null,null===n||null===n.return){Ol=1,Ll=t,Al=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=yo(o);if(null!==m){m.flags&=-257,xo(m,o,l,0,t),1&m.mode&&vo(a,u,t),c=u;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){vo(a,u,t),gc();break e}c=Error(i(426))}else if(si&&1&l.mode){var v=yo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),xo(v,o,l,0,t),mi(uo(c,l));break e}}a=c=uo(c,l),4!==Ol&&(Ol=2),null===Vl?Vl=[a]:Vl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zi(a,po(0,c,t));break e;case 1:l=c;var y=a.type,x=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Kl||!Kl.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t,zi(a,go(a,l,t));break e}}a=a.return}while(null!==a)}wc(n)}catch(b){t=b,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=_l.current;return _l.current=Za,null===e?Za:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Tl||0===(268435455&Ml)&&0===(268435455&Fl)||lc(Tl,Dl)}function vc(e,t){var n=Cl;Cl|=2;var r=pc();for(Tl===e&&Dl===t||(Hl=null,fc(e,t));;)try{yc();break}catch(s){mc(e,s)}if(_i(),Cl=n,_l.current=r,null!==Al)throw Error(i(261));return Tl=null,Dl=0,Ol}function yc(){for(;null!==Al;)bc(Al)}function xc(){for(;null!==Al&&!Xe();)bc(Al)}function bc(e){var t=kl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?wc(e):Al=t,Il.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qo(n,t,Rl)))return void(Al=n)}else{if(null!==(n=Xo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function Nc(e,t,n){var r=xt,s=El.transition;try{El.transition=null,xt=1,function(e,t,n,r){do{Sc()}while(null!==Xl);if(0!==(6&Cl))throw Error(i(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-at(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}(e,a),e===Tl&&(Al=Tl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Tc(tt,function(){return Sc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=El.transition,El.transition=null;var o=xt;xt=1;var l=Cl;Cl|=4,Il.current=null,function(e,t){if(es=Ht,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(Qi){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++u===s&&(l=o),f===a&&++d===r&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Ht=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ro(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(Qi){jc(t,t.return,Qi)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}p=nl,nl=!1}(e,n),vl(n,e),mr(ts),Ht=!!es,ts=es=null,e.current=n,xl(n,e,s),Je(),Cl=l,xt=o,El.transition=a}else e.current=n;if(Ql&&(Ql=!1,Xl=e,Jl=s),a=e.pendingLanes,0===a&&(Kl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Gl)throw Gl=!1,e=Wl,Wl=null,e;0!==(1&Jl)&&0!==e.tag&&Sc(),a=e.pendingLanes,0!==(1&a)?e===$l?Yl++:(Yl=0,$l=e):Yl=0,Bs()}(e,t,n,r)}finally{El.transition=s,xt=r}return null}function Sc(){if(null!==Xl){var e=bt(Jl),t=El.transition,n=xt;try{if(El.transition=null,xt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Jl=0,0!==(6&Cl))throw Error(i(331));var s=Cl;for(Cl|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var d=Zo;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Zo=h;else for(;null!==Zo;){var f=(d=Zo).sibling,m=d.return;if(al(d),d===u){Zo=null;break}if(null!==f){f.return=m,Zo=f;break}Zo=m}}}var p=a.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var x=e.current;for(Zo=x;null!==Zo;){var b=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Zo=b;else e:for(o=x;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:sl(9,l)}}catch(N){jc(l,l.return,N)}if(l===o){Zo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zo=w;break e}Zo=l.return}}if(Cl=s,Bs(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(st,e)}catch(N){}r=!0}return r}finally{xt=n,El.transition=t}}return!1}function kc(e,t,n){e=Ui(e,t=po(0,t=uo(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),sc(e,t))}function jc(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Ui(t,e=go(t,e=uo(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),sc(t,e));break}}t=t.return}}function _c(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Dl&n)===n&&(4===Ol||3===Ol&&(130023424&Dl)===Dl&&500>Ye()-Bl?fc(e,0):Ul|=n),sc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Pi(e,t))&&(vt(e,t,n),sc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ic(e,n)}function Tc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Ac(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,s,a){var o=2;if(r=e,"function"===typeof e)Rc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Lc(n.children,s,a,t);case k:o=8,s|=8;break;case j:return(e=Dc(12,n,t,2|s)).elementType=j,e.lanes=a,e;case C:return(e=Dc(13,n,t,s)).elementType=C,e.lanes=a,e;case T:return(e=Dc(19,n,t,s)).elementType=T,e.lanes=a,e;case R:return Mc(n,s,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:o=10;break e;case I:o=9;break e;case E:o=11;break e;case A:o=14;break e;case D:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Dc(o,n,t,s)).elementType=e,t.type=r,t.lanes=a,t}function Lc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,s,i,a,o,l){return e=new Vc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Dc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Bc(e){if(!e)return Is;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ds(n))return Os(e,n,t)}return t}function qc(e,t,n,r,s,i,a,o,l){return(e=zc(n,r,!0,e,0,i,0,o,l)).context=Bc(null),n=e.current,(i=Fi(r=tc(),s=nc(n))).callback=void 0!==t&&null!==t?t:null,Ui(n,i,s),e.current.lanes=s,vt(e,s,r),sc(e,r),e}function Hc(e,t,n,r){var s=t.current,i=tc(),a=nc(s);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fi(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ui(s,t,a))&&(rc(e,s,a,i),Vi(e,s,a)),a}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cs.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),fi();break;case 5:$i(t);break;case 1:Ds(t.type)&&Ls(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;_s(Ni,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_s(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(_s(ea,1&ea.current),null!==(e=Go(e,t,n))?e.sibling:null);_s(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),_s(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,_o(e,t,n)}return Go(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,si&&0!==(1048576&t.flags)&&Zs(t,Ws,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var s=As(t,Es.current);Ci(t,n),s=ga(null,t,r,e,s,n);var a=va();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ds(r)?(a=!0,Ls(t)):a=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Li(t),s.updater=io,t.stateNode=s,s._reactInternals=t,co(t,r,e,n),t=To(null,t,r,!0,a,n)):(t.tag=0,si&&a&&ei(t),No(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===A)return 14}return 2}(r),e=ro(r,e),s){case 0:t=Eo(null,t,r,e,n);break e;case 1:t=Co(null,t,r,e,n);break e;case 11:t=So(null,t,r,e,n);break e;case 14:t=ko(null,t,r,ro(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,Eo(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 1:return r=t.type,s=t.pendingProps,Co(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 3:e:{if(Ao(t),null===e)throw Error(i(387));r=t.pendingProps,s=(a=t.memoizedState).element,Mi(e,t),Bi(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Do(e,t,r,n,s=uo(Error(i(423)),t));break e}if(r!==s){t=Do(e,t,r,n,s=uo(Error(i(424)),t));break e}for(ri=cs(t.stateNode.containerInfo.firstChild),ni=t,si=!0,ii=null,n=wi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===s){t=Go(e,t,n);break e}No(e,t,r,n)}t=t.child}return t;case 5:return $i(t),null===e&&ci(t),r=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==a&&ns(r,a)&&(t.flags|=32),Io(e,t),No(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Fo(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bi(t,null,r,n):No(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,So(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 7:return No(e,t,t.pendingProps,n),t.child;case 8:case 12:return No(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,_s(Ni,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===s.children&&!Cs.current){t=Go(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Fi(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ei(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ei(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}No(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ci(t,n),r=r(s=Ti(s)),t.flags|=1,No(e,t,r,n),t.child;case 14:return s=ro(r=t.type,t.pendingProps),ko(e,t,r,s=ro(r.type,s),n);case 15:return jo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:ro(r,s),Ho(e,t),t.tag=1,Ds(r)?(e=!0,Ls(t)):e=!1,Ci(t,n),oo(t,r,s),co(t,r,s,n),To(null,t,r,!0,e,n);case 19:return qo(e,t,n);case 22:return _o(e,t,n)}throw Error(i(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof s){var o=s;s=function(){var e=Gc(a);o.call(e)}}Hc(t,a,e,s)}else a=function(e,t,n,r,s){if(s){if("function"===typeof r){var i=r;r=function(){var e=Gc(a);i.call(e)}}var a=qc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[ms]=a.current,Br(8===e.nodeType?e.parentNode:e),dc(),a}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Gc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[ms]=l.current,Br(8===e.nodeType?e.parentNode:e),dc(function(){Hc(t,l,n,r)}),l}(n,t,e,s,r);return Gc(a)}Jc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Jc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Hc(null,e,null,null)}),t[ms]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Mt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),sc(t,Ye()),0===(6&Cl)&&(ql=Ye()+500,Bs()))}break;case 13:dc(function(){var t=Pi(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}}),Kc(e,1)}},Nt=function(e){if(13===e.tag){var t=Pi(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Pi(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},kt=function(){return xt},jt=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},Ne=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(i(90));K(r),$(r,s)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=uc,Ce=dc;var tu={usingClientEntryPoint:!1,Events:[xs,bs,ws,_e,Ie,uc]},nu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{st=su.inject(ru),it=su}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:N,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(i(299));var n=!1,r="",s=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,s),e[ms]=t.current,Br(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,s=!1,a="",o=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,s,0,a,o),e[ms]=t.current,Br(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Jc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(dc(function(){eu(null,null,e,!1,function(){e._reactRootContainer=null,e[ms]=null})}),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853(e,t,n){e.exports=n(234)},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var r=n(43),s=n(391);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const d=["color","size","strokeWidth","absoluteStrokeWidth","children"];var h=(e,t)=>{const n=(0,r.forwardRef)((n,s)=>{let{color:i="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:h}=n,f=function(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(n,d);return(0,r.createElement)("svg",c(c({ref:s},u),{},{width:a,height:a,stroke:i,strokeWidth:l?24*Number(o)/Number(a):o,className:"lucide lucide-".concat((m=e,m.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},f),[...t.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...(Array.isArray(h)?h:[h])||[]]);var m});return n.displayName="".concat(e),n};const f=h("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]),m=h("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),p=h("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),g=h("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),v=h("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),y=h("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),x=h("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),b=h("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),w=h("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),N=h("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),S=h("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),k=h("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),j=h("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),_=h("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),I=h("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),E=h("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),C=h("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),T=h("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),A=h("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),D=h("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),R=h("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),P=h("FileWarning",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),O=h("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),L=h("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]),M=h("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),F=h("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),U=h("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),V=h("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),z=h("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),B=h("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),q=h("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),H=h("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),G=h("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),W=h("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),K=h("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Q=h("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),X=h("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),J=h("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),Y=h("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),$=h("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Z=h("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ee=h("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),te=h("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ne=h("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),re=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},se={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],i=s+1<e.length,a=i?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,i||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(re(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],i=s<e.length?n[e.charAt(s)]:0;++s;const a=s<e.length?n[e.charAt(s)]:64;++s;const o=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==i||null==a||null==o)throw new ie;const l=t<<2|i>>4;if(r.push(l),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class ie extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ae=function(e){return function(e){const t=re(e);return se.encodeByteArray(t,!0)}(e).replace(/\./g,"")},oe=function(e){try{return se.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function le(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const ce=()=>{try{return le().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&oe(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},ue=e=>{var t,n;return null===(n=null===(t=ce())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},de=()=>{var e;return null===(e=ce())||void 0===e?void 0:e.config},he=e=>{var t;return null===(t=ce())||void 0===t?void 0:t["_".concat(e)]};class fe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function me(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function pe(e){return(await fetch(e,{credentials:"include"})).ok}const ge={};let ve=!1;function ye(e,t){if("undefined"===typeof window||"undefined"===typeof document||!me(window.location.host)||ge[e]===t||ge[e]||ve)return;function n(e){return"__firebase__banner__".concat(e)}ge[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(ge))ge[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{ve=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}s?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function xe(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function be(){var e;const t=null===(e=ce())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function we(){return!be()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ne(){try{return"object"===typeof indexedDB}catch(e){return!1}}class Se extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Se.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ke.prototype.create)}}class ke{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],s=r?function(e,t){return e.replace(je,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",i="".concat(this.serviceName,": ").concat(s," (").concat(n,").");return new Se(n,i,t)}}const je=/\{\$([^}]+)}/g;function _e(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(Ie(n)&&Ie(i)){if(!_e(n,i))return!1}else if(n!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ie(e){return null!==e&&"object"===typeof e}function Ee(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Ce(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Te(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Ae{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=De),void 0===r.error&&(r.error=De),void 0===r.complete&&(r.complete=De);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function De(){}function Re(e){return e&&e._delegate?e._delegate:e}class Pe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oe="[DEFAULT]";class Le{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new fe;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Oe})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===Oe?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe;return this.component?this.component.multipleInstances?e:Oe:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Me{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Le(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Fe=[];var Ue;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ue||(Ue={}));const Ve={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},ze=Ue.INFO,Be={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},qe=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Be[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class He{constructor(e){this.name=e,this._logLevel=ze,this._logHandler=qe,this._userLogHandler=null,Fe.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Ve[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...t),this._logHandler(this,Ue.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...t),this._logHandler(this,Ue.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...t),this._logHandler(this,Ue.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...t),this._logHandler(this,Ue.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...t),this._logHandler(this,Ue.ERROR,...t)}}let Ge,We;const Ke=new WeakMap,Qe=new WeakMap,Xe=new WeakMap,Je=new WeakMap,Ye=new WeakMap;let $e={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Qe.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Xe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ze(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(We||(We=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(nt(this),n),tt(Ke.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tt(e.apply(nt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const i=e.call(nt(this),t,...r);return Xe.set(i,t.sort?t.sort():[t]),tt(i)}}function et(e){return"function"===typeof e?Ze(e):(e instanceof IDBTransaction&&function(e){if(Qe.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});Qe.set(e,t)}(e),t=e,(Ge||(Ge=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,$e):e);var t}function tt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(tt(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&Ke.set(t,e)}).catch(()=>{}),Ye.set(t,e),t}(e);if(Je.has(e))return Je.get(e);const t=et(e);return t!==e&&(Je.set(e,t),Ye.set(t,e)),t}const nt=e=>Ye.get(e);const rt=["get","getKey","getAll","getAllKeys","count"],st=["put","add","delete","clear"],it=new Map;function at(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(it.get(t))return it.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=st.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!rt.includes(n))return;const i=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let i=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),s&&t.done]))[0]};return it.set(t,i),i}$e=(e=>c(c({},e),{},{get:(t,n,r)=>at(t,n)||e.get(t,n,r),has:(t,n)=>!!at(t,n)||e.has(t,n)}))($e);class ot{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const lt="@firebase/app",ct="0.13.2",ut=new He("@firebase/app"),dt="@firebase/app-compat",ht="@firebase/analytics-compat",ft="@firebase/analytics",mt="@firebase/app-check-compat",pt="@firebase/app-check",gt="@firebase/auth",vt="@firebase/auth-compat",yt="@firebase/database",xt="@firebase/data-connect",bt="@firebase/database-compat",wt="@firebase/functions",Nt="@firebase/functions-compat",St="@firebase/installations",kt="@firebase/installations-compat",jt="@firebase/messaging",_t="@firebase/messaging-compat",It="@firebase/performance",Et="@firebase/performance-compat",Ct="@firebase/remote-config",Tt="@firebase/remote-config-compat",At="@firebase/storage",Dt="@firebase/storage-compat",Rt="@firebase/firestore",Pt="@firebase/ai",Ot="@firebase/firestore-compat",Lt="firebase",Mt="[DEFAULT]",Ft={[lt]:"fire-core",[dt]:"fire-core-compat",[ft]:"fire-analytics",[ht]:"fire-analytics-compat",[pt]:"fire-app-check",[mt]:"fire-app-check-compat",[gt]:"fire-auth",[vt]:"fire-auth-compat",[yt]:"fire-rtdb",[xt]:"fire-data-connect",[bt]:"fire-rtdb-compat",[wt]:"fire-fn",[Nt]:"fire-fn-compat",[St]:"fire-iid",[kt]:"fire-iid-compat",[jt]:"fire-fcm",[_t]:"fire-fcm-compat",[It]:"fire-perf",[Et]:"fire-perf-compat",[Ct]:"fire-rc",[Tt]:"fire-rc-compat",[At]:"fire-gcs",[Dt]:"fire-gcs-compat",[Rt]:"fire-fst",[Ot]:"fire-fst-compat",[Pt]:"fire-vertex","fire-js":"fire-js",[Lt]:"fire-js-all"},Ut=new Map,Vt=new Map,zt=new Map;function Bt(e,t){try{e.container.addComponent(t)}catch(n){ut.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function qt(e){const t=e.name;if(zt.has(t))return ut.debug("There were multiple attempts to register component ".concat(t,".")),!1;zt.set(t,e);for(const n of Ut.values())Bt(n,e);for(const n of Vt.values())Bt(n,e);return!0}function Ht(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Gt(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Wt=new ke("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Kt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Pe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wt.create("app-deleted",{appName:this._name})}}const Qt="11.10.0";function Xt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Mt,automaticDataCollectionEnabled:!0},t),s=r.name;if("string"!==typeof s||!s)throw Wt.create("bad-app-name",{appName:String(s)});if(n||(n=de()),!n)throw Wt.create("no-options");const i=Ut.get(s);if(i){if(_e(n,i.options)&&_e(r,i.config))return i;throw Wt.create("duplicate-app",{appName:s})}const a=new Me(s);for(const l of zt.values())a.addComponent(l);const o=new Kt(n,r,a);return Ut.set(s,o),o}function Jt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;const t=Ut.get(e);if(!t&&e===Mt&&de())return Xt();if(!t)throw Wt.create("no-app",{appName:e});return t}function Yt(e,t,n){var r;let s=null!==(r=Ft[e])&&void 0!==r?r:e;n&&(s+="-".concat(n));const i=s.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),i&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ut.warn(e.join(" "))}qt(new Pe("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const $t="firebase-heartbeat-store";let Zt=null;function en(){return Zt||(Zt=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=tt(a);return r&&a.addEventListener("upgradeneeded",e=>{r(tt(a.result),e.oldVersion,e.newVersion,tt(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore($t)}catch(n){console.warn(n)}}}).catch(e=>{throw Wt.create("idb-open",{originalErrorMessage:e.message})})),Zt}async function tn(e,t){try{const n=(await en()).transaction($t,"readwrite"),r=n.objectStore($t);await r.put(t,nn(e)),await n.done}catch(n){if(n instanceof Se)ut.warn(n.message);else{const e=Wt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});ut.warn(e.message)}}}function nn(e){return"".concat(e.name,"!").concat(e.options.appId)}class rn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new an(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=sn();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ut.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=sn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),on(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),on(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=ae(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ut.warn(t),""}}}function sn(){return(new Date).toISOString().substring(0,10)}class an{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Ne()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await en()).transaction($t),n=await t.objectStore($t).get(nn(e));return await t.done,n}catch(t){if(t instanceof Se)ut.warn(t.message);else{const e=Wt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});ut.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function on(e){return ae(JSON.stringify({version:2,heartbeats:e})).length}var ln;ln="",qt(new Pe("platform-logger",e=>new ot(e),"PRIVATE")),qt(new Pe("heartbeat",e=>new rn(e),"PRIVATE")),Yt(lt,ct,ln),Yt(lt,ct,"esm2017"),Yt("fire-js","");Yt("firebase","11.10.0","app");function cn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function un(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dn=un,hn=new ke("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fn=new He("@firebase/auth");function mn(e){if(fn.logLevel<=Ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];fn.error("Auth (".concat(Qt,"): ").concat(e),...n)}}function pn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw bn(e,...n)}function gn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return bn(e,...n)}function vn(e,t,n){const r=Object.assign(Object.assign({},dn()),{[t]:n});return new ke("auth","Firebase",r).create(t,{appName:e.name})}function yn(e){return vn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&pn(e,"argument-error"),vn(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function bn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return hn.create(e,...n)}function wn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];throw bn(t,...r)}}function Nn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw mn(t),new Error(t)}function Sn(e,t){e||Nn(t)}function kn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function jn(){return"http:"===_n()||"https:"===_n()}function _n(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function In(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(jn()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class En{constructor(e,t){this.shortDelay=e,this.longDelay=t,Sn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xe())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return In()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Cn(e,t){Sn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Tn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Nn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Nn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Nn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const An={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Dn=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Rn=new En(3e4,6e4);function Pn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function On(e,t,n,r){return Ln(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},i={};r&&("GET"===t?i=r:s={body:JSON.stringify(r)});const a=Ee(Object.assign({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},s);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&me(e.emulatorConfig.host)&&(l.credentials="include"),Tn.fetch()(await Fn(e,e.config.apiHost,n,a),l)})}async function Ln(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},An),t);try{const t=new Vn(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw zn(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw zn(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw zn(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw zn(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw vn(e,o,a);pn(e,o)}}catch(s){if(s instanceof Se)throw s;pn(e,"network-request-failed",{message:String(s)})}}async function Mn(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await On(e,t,n,r,s);return"mfaPendingCredential"in i&&pn(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function Fn(e,t,n,r){const s="".concat(t).concat(n,"?").concat(r),i=e,a=i.config.emulator?Cn(e.config,s):"".concat(e.config.apiScheme,"://").concat(s);if(Dn.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(a).toString()}return a}function Un(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Vn{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(gn(this.auth,"network-request-failed")),Rn.get())})}}function zn(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=gn(e,t,r);return s.customData._tokenResponse=n,s}function Bn(e){return void 0!==e&&void 0!==e.enterprise}class qn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Un(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Hn(e,t){return On(e,"GET","/v2/recaptchaConfig",Pn(e,t))}async function Gn(e,t){return On(e,"POST","/v1/accounts:lookup",t)}function Wn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Kn(e){return 1e3*Number(e)}function Qn(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return mn("JWT malformed, contained fewer than 3 sections"),null;try{const e=oe(n);return e?JSON.parse(e):(mn("Failed to decode base64 JWT payload"),null)}catch(s){return mn("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}function Xn(e){const t=Qn(e);return wn(t,"internal-error"),wn("undefined"!==typeof t.exp,"internal-error"),wn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Jn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof Se&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Yn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class $n{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wn(this.lastLoginAt),this.creationTime=Wn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zn(e){var t;const n=e.auth,r=await e.getIdToken(),s=await Jn(e,Gn(n,{idToken:r}));wn(null===s||void 0===s?void 0:s.users.length,n,"internal-error");const i=s.users[0];e._notifyReloadListener(i);const a=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?er(i.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new $n(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function er(e){return e.map(e=>{var{providerId:t}=e,n=cn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class tr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wn(e.idToken,"internal-error"),wn("undefined"!==typeof e.idToken,"internal-error"),wn("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Xn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wn(0!==e.length,"internal-error");const t=Xn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(wn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await Ln(e,{},async()=>{const n=Ee({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,i=await Fn(e,r,"/v1/token","key=".concat(s)),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:n};return e.emulatorConfig&&me(e.emulatorConfig.host)&&(o.credentials="include"),Tn.fetch()(i,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new tr;return n&&(wn("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(wn("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(wn("number"===typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tr,this.toJSON())}_performRefresh(){return Nn("not implemented")}}function nr(e,t){wn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class rr{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=cn(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Yn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new $n(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Jn(this,this.stsTokenManager.getToken(this.auth,e));return wn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Re(e),r=await n.getIdToken(t),s=Qn(r);wn(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i="object"===typeof s.firebase?s.firebase:void 0,a=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Wn(Kn(s.auth_time)),issuedAtTime:Wn(Kn(s.iat)),expirationTime:Wn(Kn(s.exp)),signInProvider:a||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Re(e);await Zn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(wn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new rr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){wn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Zn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gt(this.auth.app))return Promise.reject(yn(this.auth));const e=await this.getIdToken();return await Jn(this,async function(e,t){return On(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,i,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,m=null!==(a=t.tenantId)&&void 0!==a?a:void 0,p=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:x,isAnonymous:b,providerData:w,stsTokenManager:N}=t;wn(y&&N,e,"internal-error");const S=tr.fromJSON(this.name,N);wn("string"===typeof y,e,"internal-error"),nr(u,e.name),nr(d,e.name),wn("boolean"===typeof x,e,"internal-error"),wn("boolean"===typeof b,e,"internal-error"),nr(h,e.name),nr(f,e.name),nr(m,e.name),nr(p,e.name),nr(g,e.name),nr(v,e.name);const k=new rr({uid:y,auth:e,email:d,emailVerified:x,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:h,tenantId:m,stsTokenManager:S,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(k.providerData=w.map(e=>Object.assign({},e))),p&&(k._redirectEventId=p),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new tr;r.updateFromServerResponse(t);const s=new rr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Zn(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];wn(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?er(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===s||void 0===s?void 0:s.length),a=new tr;a.updateFromIdToken(n);const o=new rr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new $n(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===s||void 0===s?void 0:s.length)};return Object.assign(o,l),o}}const sr=new Map;function ir(e){Sn(e instanceof Function,"Expected a class definition");let t=sr.get(e);return t?(Sn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,sr.set(e,t),t)}class ar{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ar.type="NONE";const or=ar;function lr(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class cr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=lr(this.userKey,r.apiKey,s),this.fullPersistenceKey=lr("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Gn(this.auth,{idToken:e}).catch(()=>{});return t?rr._fromGetAccountInfoResponse(this.auth,t,e):null}return rr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new cr(ir(or),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||ir(or);const i=lr(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(i);if(t){let n;if("string"===typeof t){const r=await Gn(e,{idToken:t}).catch(()=>{});if(!r)break;n=await rr._fromGetAccountInfoResponse(e,r,t)}else n=rr._fromJSON(e,t);c!==s&&(a=n),s=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&o.length?(s=o[0],a&&await s._set(i,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(i)}catch(l){}})),new cr(s,e,n)):new cr(s,e,n)}}function ur(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(mr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(dr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(gr(t))return"Blackberry";if(vr(t))return"Webos";if(hr(t))return"Safari";if((t.includes("chrome/")||fr(t))&&!t.includes("edge/"))return"Chrome";if(pr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function dr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/firefox\//i.test(e)}function hr(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/crios\//i.test(e)}function mr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/iemobile/i.test(e)}function pr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/android/i.test(e)}function gr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/blackberry/i.test(e)}function vr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/webos/i.test(e)}function yr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function xr(){return function(){const e=xe();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function br(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe();return yr(e)||pr(e)||vr(e)||gr(e)||/windows phone/i.test(e)||mr(e)}function wr(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ur(xe());break;case"Worker":t="".concat(ur(xe()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Qt,"/").concat(r)}class Nr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(s){r(s)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Sr{constructor(e){var t,n,r,s;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(s=e.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,i,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(s=o.containsUppercaseLetter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class kr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _r(this),this.idTokenSubscription=new _r(this),this.beforeStateQueue=new Nr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ir(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await cr.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Gn(this,{idToken:e}),n=await rr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Gt(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==i||!(null===a||void 0===a?void 0:a.user)||(r=a.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return wn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Zn(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gt(this.app))return Promise.reject(yn(this));const t=e?Re(e):null;return t&&wn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&wn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gt(this.app)?Promise.reject(yn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gt(this.app)?Promise.reject(yn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ir(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return On(e,"GET","/v2/passwordPolicy",Pn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Sr(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ke("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return On(e,"POST","/v2/accounts:revokeToken",Pn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ir(e)||this._popupRedirectResolver;wn(t,this,"argument-error"),this.redirectPersistenceManager=await cr.create(this,[ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"===typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(wn(a,this,"internal-error"),a.then(()=>{i||s(this.currentUser)}),"function"===typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Gt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(fn.logLevel<=Ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];fn.warn("Auth (".concat(Qt,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function jr(e){return Re(e)}class _r{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Ae(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return wn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ir={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Er(e){return Ir.loadJS(e)}function Cr(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Tr{constructor(){this.enterprise=new Ar}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ar{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Dr="NO_RECAPTCHA";class Rr{constructor(e){this.type="recaptcha-enterprise",this.auth=jr(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const s=window.grecaptcha;Bn(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Dr)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Tr).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Hn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new qn(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(s=>{if(!t&&Bn(window.grecaptcha))n(s,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ir.recaptchaEnterpriseScript;0!==t.length&&(t+=s),Er(t).then(()=>{n(s,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Pr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Rr(e);let a;if(s)a=Dr;else try{a=await i.verify(n)}catch(l){a=await i.verify(n,!0)}const o=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Or(e,t,n,r,s){var i,a;if("EMAIL_PASSWORD_PROVIDER"===s){if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Pr(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if(s.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const s=await Pr(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}if("PHONE_PROVIDER"===s){if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("PHONE_PROVIDER")){const s=await Pr(e,t,n);return r(e,s).catch(async s=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&(s.code==="auth/".concat("missing-recaptcha-token")||s.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const s=await Pr(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)})}{const s=await Pr(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}async function Lr(e){const t=jr(e),n=await Hn(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new qn(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Rr(t).verify()}}function Mr(e,t,n){const r=jr(e);wn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!(null===n||void 0===n?void 0:n.disableWarnings),i=Fr(t),{host:a,port:o}=function(e){const t=Fr(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:Ur(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ur(t)}}}(t),l=null===o?"":":".concat(o),c={url:"".concat(i,"//").concat(a).concat(l,"/")},u=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator)return wn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void wn(_e(c,r.config.emulator)&&_e(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,me(a)?(pe("".concat(i,"//").concat(a).concat(l)),ye("Auth",!0)):s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Fr(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ur(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Vr{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nn("not implemented")}_getIdTokenResponse(e){return Nn("not implemented")}_linkToIdToken(e,t){return Nn("not implemented")}_getReauthenticationResolver(e){return Nn("not implemented")}}async function zr(e,t){return On(e,"POST","/v1/accounts:signUp",t)}async function Br(e,t){return Mn(e,"POST","/v1/accounts:signInWithPassword",Pn(e,t))}class qr extends Vr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new qr(e,t,"password")}static _fromEmailAndCode(e,t){return new qr(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Or(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Br,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithEmailLink",Pn(e,t))}(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Or(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zr,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithEmailLink",Pn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hr(e,t){return Mn(e,"POST","/v1/accounts:signInWithIdp",Pn(e,t))}class Gr extends Vr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Gr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=cn(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new Gr(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return Hr(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Hr(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hr(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ee(t)}return e}}async function Wr(e,t){return On(e,"POST","/v1/accounts:sendVerificationCode",Pn(e,t))}const Kr={USER_NOT_FOUND:"user-not-found"};class Qr extends Vr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Qr({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Qr({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",Pn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",Pn(e,t));if(n.temporaryProof)throw zn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",Pn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Kr)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new Qr({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class Xr{constructor(e){var t,n,r,s,i,a;const o=Ce(Te(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);wn(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(s=o.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(i=o.lang)&&void 0!==i?i:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=Ce(Te(e)).link,n=t?Ce(Te(t)).deep_link_id:null,r=Ce(Te(e)).deep_link_id;return(r?Ce(Te(r)).link:null)||r||n||t||e}(e);try{return new Xr(t)}catch(n){return null}}}class Jr{constructor(){this.providerId=Jr.PROVIDER_ID}static credential(e,t){return qr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Xr.parseLink(t);return wn(n,"argument-error"),qr._fromEmailAndCode(e,n.code,n.tenantId)}}Jr.PROVIDER_ID="password",Jr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Jr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Yr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $r extends Yr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zr extends $r{constructor(){super("facebook.com")}static credential(e){return Gr._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Zr.credential(t.oauthAccessToken)}catch(n){return null}}}Zr.FACEBOOK_SIGN_IN_METHOD="facebook.com",Zr.PROVIDER_ID="facebook.com";class es extends $r{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Gr._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return es.credential(n,r)}catch(s){return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com",es.PROVIDER_ID="google.com";class ts extends $r{constructor(){super("github.com")}static credential(e){return Gr._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ts.credential(t.oauthAccessToken)}catch(n){return null}}}ts.GITHUB_SIGN_IN_METHOD="github.com",ts.PROVIDER_ID="github.com";class ns extends $r{constructor(){super("twitter.com")}static credential(e,t){return Gr._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return ns.credential(n,r)}catch(s){return null}}}async function rs(e,t){return Mn(e,"POST","/v1/accounts:signUp",Pn(e,t))}ns.TWITTER_SIGN_IN_METHOD="twitter.com",ns.PROVIDER_ID="twitter.com";class ss{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await rr._fromIdTokenResponse(e,n,r),i=is(n);return new ss({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=is(n);return new ss({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function is(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class as extends Se{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,as.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new as(e,t,n,r)}}function os(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw as._fromErrorAndOperation(e,n,t,r);throw n})}async function ls(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Jn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ss._forOperation(e,"link",r)}async function cs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Gt(r.app))return Promise.reject(yn(r));const s="reauthenticate";try{const i=await Jn(e,os(r,s,t,e),n);wn(i.idToken,r,"internal-error");const a=Qn(i.idToken);wn(a,r,"internal-error");const{sub:o}=a;return wn(e.uid===o,r,"user-mismatch"),ss._forOperation(e,s,i)}catch(i){throw(null===i||void 0===i?void 0:i.code)==="auth/".concat("user-not-found")&&pn(r,"user-mismatch"),i}}async function us(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Gt(e.app))return Promise.reject(yn(e));const r="signIn",s=await os(e,r,t),i=await ss._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}async function ds(e,t){return us(jr(e),t)}async function hs(e){const t=jr(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function fs(e,t){return On(e,"POST","/v2/accounts/mfaEnrollment:start",Pn(e,t))}new WeakMap;const ms="__sak";class ps{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ms,"1"),this.storage.removeItem(ms),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class gs extends ps{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=br(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);xr()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}gs.type="LOCAL";const vs=gs;function ys(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),s=RegExp("".concat(r,"=([^;]+)"));return null!==(n=null===(t=document.cookie.match(s))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function xs(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class bs{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=xs(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return ys(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=xs(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=xs(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=ys(n);const s=setInterval(()=>{const e=ys(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(s))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}bs.type="COOKIE";class ws extends ps{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ws.type="SESSION";const Ns=ws;class Ss{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ss(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(i).map(async e=>e(t.origin,s)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ss.receivers=[];class js{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise((a,o)=>{const l=ks("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(c),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function _s(){return window}function Is(){return"undefined"!==typeof _s().WorkerGlobalScope&&"function"===typeof _s().importScripts}const Es="firebaseLocalStorageDb",Cs="firebaseLocalStorage",Ts="fbase_key";class As{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ds(e,t){return e.transaction([Cs],t?"readwrite":"readonly").objectStore(Cs)}function Rs(){const e=indexedDB.open(Es,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Cs,{keyPath:Ts})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Cs)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Es);return new As(e).toPromise()}(),t(await Rs()))})})}async function Ps(e,t,n){const r=Ds(e,!0).put({[Ts]:t,value:n});return new As(r).toPromise()}function Os(e,t){const n=Ds(e,!0).delete(t);return new As(n).toPromise()}class Ls{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Rs()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Is()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ss._getInstance(Is()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new js(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rs();return await Ps(e,ms,"1"),await Os(e,ms),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ps(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Ds(e,!1).get(t),r=await new As(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Os(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Ds(e,!1).getAll();return new As(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ls.type="LOCAL";const Ms=Ls;function Fs(e,t){return On(e,"POST","/v2/accounts/mfaSignIn:start",Pn(e,t))}Cr("rcb"),new En(3e4,6e4);const Us="recaptcha";async function Vs(e,t,n){var r;if(!e._getRecaptchaConfig())try{await Lr(e)}catch(s){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){wn("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=Or(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Dr){wn((null===n||void 0===n?void 0:n.type)===Us,e,"argument-error");return fs(e,await zs(e,t,n))}return fs(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{wn("signin"===t.type,e,"internal-error");const i=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;wn(i,e,"missing-multi-factor-info");const a={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Or(e,a,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Dr){wn((null===n||void 0===n?void 0:n.type)===Us,e,"argument-error");return Fs(e,await zs(e,t,n))}return Fs(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Or(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Dr){wn((null===n||void 0===n?void 0:n.type)===Us,e,"argument-error");return Wr(e,await zs(e,t,n))}return Wr(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function zs(e,t,n){wn(n.type===Us,e,"argument-error");const r=await n.verify();wn("string"===typeof r,e,"argument-error");const s=Object.assign({},t);if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,i=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class Bs{constructor(e){this.providerId=Bs.PROVIDER_ID,this.auth=jr(e)}verifyPhoneNumber(e,t){return Vs(this.auth,e,Re(t))}static credential(e,t){return Qr._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Bs.credentialFromTaggedObject(t)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Qr._fromTokenResponse(n,r):null}}function qs(e,t){return t?ir(t):(wn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Bs.PROVIDER_ID="phone",Bs.PHONE_SIGN_IN_METHOD="phone";class Hs extends Vr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Gs(e){return us(e.auth,new Hs(e),e.bypassAuthState)}function Ws(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),cs(n,new Hs(e),e.bypassAuthState)}async function Ks(e){const{auth:t,user:n}=e;return wn(n,t,"internal-error"),ls(n,new Hs(e),e.bypassAuthState)}class Qs{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Gs;case"linkViaPopup":case"linkViaRedirect":return Ks;case"reauthViaPopup":case"reauthViaRedirect":return Ws;default:pn(this.auth,"internal-error")}}resolve(e){Sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Xs=new En(2e3,1e4);class Js extends Qs{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wn(e,this.auth,"internal-error"),e}async onExecution(){Sn(1===this.filter.length,"Popup operations only handle one event");const e=ks();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(gn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Xs.get())};e()}}Js.currentPopupAction=null;const Ys=new Map;class $s extends Qs{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Ys.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ti(t),r=ei(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Ys.set(this.auth._key(),e)}return this.bypassAuthState||Ys.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Zs(e,t){Ys.set(e._key(),t)}function ei(e){return ir(e._redirectPersistence)}function ti(e){return lr("pendingRedirect",e.config.apiKey,e.name)}async function ni(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Gt(e.app))return Promise.reject(yn(e));const r=jr(e),s=qs(r,t),i=new $s(r,s,n),a=await i.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class ri{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ii(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ii(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(gn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(si(e))}saveEventToCache(e){this.cachedEventUids.add(si(e)),this.lastProcessedEventTime=Date.now()}}function si(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function ii(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const ai=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oi=/^https?/;async function li(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return On(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(ci(r))return}catch(n){}pn(e,"unauthorized-domain")}function ci(e){const t=kn(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!oi.test(n))return!1;if(ai.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const ui=new En(3e4,6e4);function di(){const e=_s().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function hi(e){return new Promise((t,n)=>{var r,s,i;function a(){di(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{di(),n(gn(e,"network-request-failed"))},timeout:ui.get()})}if(null===(s=null===(r=_s().gapi)||void 0===r?void 0:r.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=_s().gapi)||void 0===i?void 0:i.load)){const t=Cr("iframefcb");return _s()[t]=()=>{gapi.load?a():n(gn(e,"network-request-failed"))},Er("".concat(Ir.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}a()}}).catch(e=>{throw fi=null,e})}let fi=null;const mi=new En(5e3,15e3),pi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vi(e){const t=e.config;wn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Cn(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Qt},s=gi.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(Ee(r).slice(1))}async function yi(e){const t=await function(e){return fi=fi||hi(e),fi}(e),n=_s().gapi;return wn(n,e,"internal-error"),t.open({where:document.body,url:vi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pi,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=gn(e,"network-request-failed"),i=_s().setTimeout(()=>{r(s)},mi.get());function a(){_s().clearTimeout(i),n(t)}t.ping(a).then(a,()=>{r(s)})}))}const xi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class bi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function wi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},xi),{width:r.toString(),height:s.toString(),top:i,left:a}),c=xe().toLowerCase();n&&(o=fr(c)?"_blank":n),dr(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return yr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new bi(null);const d=window.open(t||"",o,u);wn(d,e,"popup-blocked");try{d.focus()}catch(h){}return new bi(d)}const Ni="__/auth/handler",Si="emulator/auth/handler",ki=encodeURIComponent("fac");async function ji(e,t,n,r,s,i){wn(e.config.authDomain,e,"auth-domain-config-required"),wn(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Qt,eventId:s};if(t instanceof Yr){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))a[e]=t}if(t instanceof $r){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(ki,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Ni);return Cn(t,Si)}(e),"?").concat(Ee(o).slice(1)).concat(c)}const _i="webStorageSupport";const Ii=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ns,this._completeRedirectFn=ni,this._overrideRedirectResult=Zs}async _openPopup(e,t,n,r){var s;Sn(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return wi(e,await ji(e,t,n,kn(),r),ks())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){_s().location.href=e}(await ji(e,t,n,kn(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Sn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await yi(e),n=new ri(e);return t.register("authEvent",t=>{wn(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(_i,{type:_i},n=>{var r;const s=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[_i];void 0!==s&&t(!!s),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=li(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return br()||hr()||yr()}};var Ei="@firebase/auth",Ci="1.10.8";class Ti{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ai=he("authIdTokenMaxAge")||300;let Di=null;var Ri;Ir={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=gn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ri="Browser",qt(new Pe("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;wn(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:Ri,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wr(Ri)},c=new kr(r,s,i,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ir);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),qt(new Pe("auth-internal",e=>(e=>new Ti(e))(jr(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Yt(Ei,Ci,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ri)),Yt(Ei,Ci,"esm2017");var Pi,Oi,Li="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Mi={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],a=t+(i^n&(s^i))+r[0]+3614090360&4294967295;a=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=n+(a<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=n+((a=t+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((s=i+((a=s+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,s=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(s[i++]=e.charCodeAt(a++),i==this.blockSize){n(this,s),i=0;break}}else for(;a<t;)if(s[i++]=e[a++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var s={};function i(e){return-128<=e&&128>e?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],n=1,s=0;e>=n;s++)t[s]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],s=0;s<t;s++)n[s]=~e.g[s];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function p(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new p(o,o);if(d(e))return t=g(h(e),t),new p(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new p(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var s=y(n,1),i=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=i.add(r);0>=c.l(e)&&(s=s.add(n),i=c),r=y(r,1),n=y(n,1)}return t=f(e,s.j(t)),new p(s,t)}for(s=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(i=a(n)).j(t);d(c)||0<c.l(e);)c=(i=a(n-=r)).j(t);u(i)&&(i=l),s=s.add(i),e=f(e,c)}return new p(s,e)}function v(e){for(var t=e.g.length+1,n=[],s=0;s<t;s++)n[s]=e.i(s)<<1|e.i(s-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var s=e.g.length-n,i=[],a=0;a<s;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var s=g(n,t).g,i=((0<(n=f(n,s.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0,i=0;i<=t;i++){var a=s+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);s=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],s=0;s<2*t;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(var i=0;i<e.g.length;i++){var l=this.i(s)>>>16,f=65535&this.i(s),p=e.i(i)>>>16,g=65535&e.i(i);n[2*s+2*i]+=f*g,m(n,2*s+2*i),n[2*s+2*i+1]+=l*g,m(n,2*s+2*i+1),n[2*s+2*i+1]+=f*p,m(n,2*s+2*i+1),n[2*s+2*i+2]+=l*p,m(n,2*s+2*i+2)}for(s=0;s<t;s++)n[s]=n[2*s+1]<<16|n[2*s];for(s=t;s<2*t;s++)n[s]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)&e.i(s);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)|e.i(s);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)^e.i(s);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Oi=Mi.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),s=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),n);8>l?(l=a(Math.pow(n,l)),s=s.j(l).add(a(c))):s=(s=s.j(r)).add(a(c))}return s},Pi=Mi.Integer=r}).apply("undefined"!==typeof Li?Li:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Fi,Ui,Vi,zi,Bi,qi,Hi,Gi,Wi="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Ki={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Wi&&Wi];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in s))break e;s=s[a]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,s={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,function(e,t){return t})}});var r=r||{},s=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function m(e){return/^[\s\xa0]*$/.test(e)}function p(){var e=s.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=p().indexOf("Gecko")&&!(-1!=p().toLowerCase().indexOf("webkit")&&-1==p().indexOf("Edge"))&&!(-1!=p().indexOf("Trident")||-1!=p().indexOf("MSIE"))&&-1==p().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function x(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function N(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){s.setTimeout(()=>{throw e},0)}function k(){var e=C;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var j=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new _,e=>e.reset());class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let I,E=!1,C=new class{constructor(){this.h=this.g=null}add(e,t){const n=j.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=s.Promise.resolve(void 0);I=()=>{e.then(A)}};var A=()=>{for(var e;e=k();){try{e.h.call(e.g)}catch(n){S(n)}var t=j;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}E=!1};function D(){this.s=this.s,this.C=this.C}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.s=!1,D.prototype.ma=function(){this.s||(this.s=!0,this.N())},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var s=!0;break e}catch(i){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}d(O,R);var L={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}z.prototype.add=function(e,t,n,r,s){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=q(e,t,r,s);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new U(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),G={};function W(e,t,n,r,s){if(r&&r.once)return Q(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)W(e,t[i],n,r,s);return null}return n=te(n),e&&e[M]?e.K(t,n,a(r)?!!r.capture:!!r,s):K(e,t,n,!1,r,s)}function K(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,l=Z(e);if(l||(e[H]=l=new z(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=$;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(Y(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Q(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Q(e,t[i],n,r,s);return null}return n=te(n),e&&e[M]?e.L(t,n,a(r)?!!r.capture:!!r,s):K(e,t,n,!0,r,s)}function X(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)X(e,t[i],n,r,s);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=q(i=e.g[t],n,r,s))&&(V(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,r,s)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Y(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[H]=null)):V(e)}}}function Y(e){return e in G?G[e]:G[e]="on"+e}function $(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&J(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){D.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var s=t;w(t=new R(r,e),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=t.g=n[i];s=se(a,r,!0,t)&&s}if(s=se(a=t.g=e,r,!0,t)&&s,s=se(a,r,!1,t)&&s,n)for(i=0;i<n.length;i++)s=se(a=t.g=n[i],r,!1,t)&&s}function se(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&B(e.i,a),s=!1!==o.call(l,r)&&s}}return s&&!r.defaultPrevented}function ie(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function ae(e){e.g=ie(()=>{e.g=null,e.i&&(e.i=!1,ae(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,D),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){X(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends D{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){D.call(this),this.h=e,this.g={}}d(le,D);var ce=[];function ue(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&J(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=s.JSON.stringify,he=s.JSON.parse,fe=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function me(){}function pe(e){return e.h||(e.h=e.i())}function ge(){}me.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){R.call(this,"d")}function xe(){R.call(this,"c")}d(ye,R),d(xe,R);var be={},we=null;function Ne(){return we=we||new ne}function Se(e){R.call(this,be.La,e)}function ke(e){const t=Ne();re(t,new Se(t))}function je(e,t){R.call(this,be.STAT_EVENT,e),this.stat=t}function _e(e){const t=Ne();re(t,new je(t,e))}function Ie(e,t){R.call(this,be.Ma,e),this.size=t}function Ee(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Ce(){this.g=!0}function Te(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<s.length;a++)s[a]=""}}}return de(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}be.La="serverreachability",d(Se,R),be.STAT_EVENT="statevent",d(je,R),be.Ma="timingevent",d(Ie,R),Ce.prototype.xa=function(){this.g=!1},Ce.prototype.info=function(){};var Ae,De={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Re={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Oe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}d(Pe,me),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},Ae=new Pe;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=dt(at(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),qe(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),jt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var s="readystatechange";Array.isArray(s)||(s&&(ce[0]=s.toString()),s=ce);for(var i=0;i<s.length;i++){var a=W(n,s[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?x(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ke(),function(e,t,n,r,s,i){e.info(function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function qe(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ee(c(e.ba,e),t)}function Ge(e){e.B&&(s.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){Ge(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Qe(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Jt(n)}rn(n),_e(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ee(c(n.Za,n),6e3));if(1>=$e(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!m(t))for(s=n.Da.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=hn(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(Ge(o),qe(o)),r.g=a}else nn(r);0<n.i.length&&$t(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Xt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}ke()}catch(u){}}Oe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Gt(e)?t.j():this.Y(e)},Oe.prototype.Y=function(e){try{if(e==this.g)e:{const h=Gt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Wt(this.g)))){this.J||4!=h||7==t||ke(),Ge(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Wt(this.g);e="";var i=r.length,a=4==Gt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var o="";break t}this.h.i=new s.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,s,i,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,_e(12),Ke(this),We(this);break e}Te(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qe(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Fe){4==h&&(this.s=4,_e(14),n=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,_e(15),Te(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Te(this.i,this.l,e,null),Qe(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,_e(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),sn(d),d.M=!0,_e(11))}}else Te(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),We(this)}else Te(this.i,this.l,o,null),Qe(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=Gt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(m(e[r]))continue;var n=N(e[r]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),Ke(this),We(this)}}}catch(h){}},Oe.prototype.cancel=function(){this.J=!0,Ke(this)},Oe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(ke(),_e(17)),Ke(this),this.s=2,We(this)):He(this,this.S-e)};var Xe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,s.PerformanceNavigationTiming?e=0<(e=s.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function $e(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,a=0;a<s;a++)t.call(void 0,r[a],n&&n[a],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new wt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(st))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new wt(null,this.h))}function at(e){return new it(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof wt?(e.i=t,function(e,t){t&&!e.j&&(Nt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(St(this,t),jt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,xt)),e.i=new wt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,mt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,bt)),e.join("")};var pt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,xt=/[#\?@]/g,bt=/#/g;function wt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Nt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function St(e,t){Nt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function kt(e,t){return Nt(e),t=_t(e,t),e.g.has(t)}function jt(e,t,n){St(e,t),0<n.length&&(e.i=null,e.g.set(_t(e,t),h(n)),e.h+=n.length)}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function It(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(i){}}function Et(){this.g=new fe}function Ct(e,t,n){const r=n||"";try{rt(e,function(e,n){let s=e;a(e)&&(s=de(e)),t.push(r+n+"="+encodeURIComponent(s))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function Tt(e){this.l=e.Ub||null,this.j=e.eb||!1}function At(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Dt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Rt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Pt(e)}function Pt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ot(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ot(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=wt.prototype).add=function(e,t){Nt(this),this.i=null,e=_t(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Nt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Nt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},e.V=function(e){Nt(this);let t=[];if("string"===typeof e)kt(this,e)&&(t=t.concat(this.g.get(_t(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Nt(this),this.i=null,kt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var s=i;""!==a[r]&&(s+="="+encodeURIComponent(String(a[r]))),e.push(s)}}return this.i=e.join("&")},d(Tt,me),Tt.prototype.g=function(){return new At(this.l,this.j)},Tt.prototype.i=(pt={},function(){return pt}),d(At,ne),(e=At.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Pt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||s).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Rt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Pt(this)),this.g&&(this.readyState=3,Pt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Rt(this):Pt(this),3==this.readyState&&Dt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Rt(this))},e.Qa=function(e){this.g&&(this.response=e,Rt(this))},e.ga=function(){this.g&&Rt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(At.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Mt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),qt(e)}function zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Gt(e)||2!=e.Z()))if(e.u&&4==Gt(e))ie(e.Ea,0,e);else if(re(e,"readystatechange"),4==Gt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var a=String(e.D).match(st)[1]||null;!a&&s.self&&s.self.location&&(a=s.self.location.protocol.slice(0,-1)),i=!Ft.test(a?a.toLowerCase():"")}n=i}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<Gt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",zt(e)}}finally{qt(e)}}}function qt(e,t){if(e.g){Ht(e);const r=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function Ht(e){e.I&&(s.clearTimeout(e.I),e.I=null)}function Gt(e){return e.g?e.g.readyState:0}function Wt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Qt(e){this.Aa=0,this.i=[],this.j=new Ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new Et,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Xt(e){if(Yt(e),3==e.G){var t=e.U++,n=at(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Oe(e,e.j,t)).L=2,t.v=dt(at(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}dn(e)}function Jt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Yt(e){Jt(e),e.u&&(s.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&s.clearTimeout(e.s),e.s=null)}function $t(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;I||T(),E||(I(),E=!0),C.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Oe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&y(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),a=!1;else try{Ct(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;I||T(),E||(I(),E=!0),C.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ee(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(s.clearTimeout(e.A),e.A=null)}function an(e){e.g=new Oe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(at(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;re(r=Ne(),new Ie(r,n)),$t(e)}else nn(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==r&&function(e,t){return!($e(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ee(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),s){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new it(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ot(r,"https"),dt(r),t?function(e,t){const n=new Ce;if(s.Image){const r=new Image;r.onload=u(It,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(It,n,"TestLoadImage: error",!1,t,r),r.onabort=u(It,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(It,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ce;const n=new AbortController,r=setTimeout(()=>{n.abort(),It(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?It(0,0,!0,t):It(0,0,!1,t)}).catch(()=>{clearTimeout(r),It(0,0,!1,t)})}(r.toString(),n)}else _e(2);e.G=0,e.l&&e.l.sa(t),dn(e),Yt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var r=n instanceof it?at(n):new it(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new it(null);r&&ot(a,r),t&&(a.g=t),i&&lt(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new Tt({eb:n})):new Mt(e.pa)).Ha(e.J),t}function mn(){}function pn(){}function gn(e,t){ne.call(this),this.g=new Qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!m(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!m(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new xn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){xe.call(this),this.status=1}function xn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?pe(this.o):pe(Ae),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Vt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ht(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Vt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),qt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qt(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Gt(this)?this.g.status:-1}catch(pt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(pt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Qt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){_e(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=hn(this,null,this.W),$t(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const s=new Oe(this,this.j,e);let i=this.o;if(this.S&&(i?(i=x(i),w(i,this.S)):i=this.S),null!==this.m||this.O||(s.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,s,t),ut(n=at(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Ot(i)))+"&"+t:this.m&&Lt(n,this.m,i)),et(this.h,s),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),s.T=!0,Ue(s,n,null)):Ue(s,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Ye(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,an(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ee(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),Jt(this),an(this))},e.Za=function(){null!=this.C&&(this.C=null,Jt(this),rn(this),_e(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=mn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},pn.prototype.g=function(e,t){return new gn(e,t)},d(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Xt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Xe(t.Ya++,e)),3==t.G&&$t(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Xt(this.g),delete this.g,gn.aa.N.call(this)},d(vn,ye),d(yn,xe),d(xn,mn),xn.prototype.ua=function(){re(this.g,"a")},xn.prototype.ta=function(e){re(this.g,new vn(e))},xn.prototype.sa=function(e){re(this.g,new yn)},xn.prototype.ra=function(){re(this.g,"b")},pn.prototype.createWebChannel=pn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Gi=Ki.createWebChannelTransport=function(){return new pn},Hi=Ki.getStatEventTarget=function(){return Ne()},qi=Ki.Event=be,Bi=Ki.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},De.NO_ERROR=0,De.TIMEOUT=8,De.HTTP_ERROR=6,zi=Ki.ErrorCode=De,Re.COMPLETE="complete",Vi=Ki.EventType=Re,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Ui=Ki.WebChannel=ge,Ki.FetchXmlHttpFactory=Tt,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,Fi=Ki.XhrIo=Mt}).apply("undefined"!==typeof Wi?Wi:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Qi="@firebase/firestore",Xi="4.8.0";class Ji{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ji.UNAUTHENTICATED=new Ji(null),Ji.GOOGLE_CREDENTIALS=new Ji("google-credentials-uid"),Ji.FIRST_PARTY=new Ji("first-party-uid"),Ji.MOCK_USER=new Ji("mock-user");let Yi="11.10.0";const $i=new He("@firebase/firestore");function Zi(){return $i.logLevel}function ea(e){if($i.logLevel<=Ue.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(ra);$i.debug("Firestore (".concat(Yi,"): ").concat(e),...s)}}function ta(e){if($i.logLevel<=Ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(ra);$i.error("Firestore (".concat(Yi,"): ").concat(e),...s)}}function na(e){if($i.logLevel<=Ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(ra);$i.warn("Firestore (".concat(Yi,"): ").concat(e),...s)}}function ra(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function sa(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ia(e,r,n)}function ia(e,t,n){let r="FIRESTORE (".concat(Yi,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw ta(r),new Error(r)}function aa(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||ia(t,s,r)}function oa(e,t){return e}const la={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ca extends Se{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class ua{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class da{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class ha{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ji.UNAUTHENTICATED))}shutdown(){}}class fa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ma{constructor(e){this.t=e,this.currentUser=Ji.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){aa(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new ua;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ua,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{ea("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(ea("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ua)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(ea("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(aa("string"==typeof t.accessToken,31837,{l:t}),new da(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return aa(null===e||"string"==typeof e,2055,{h:e}),new Ji(e)}}class pa{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ji.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ga{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new pa(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ji.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class va{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ya{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){aa(void 0===this.o,3512);const n=e=>{null!=e.error&&ea("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,ea("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{ea("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):ea("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new va(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(aa("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new va(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function xa(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function ba(){return new TextEncoder}class wa{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=xa(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Na(e,t){return e<t?-1:e>t?1:0}function Sa(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),s=t.codePointAt(n);if(r!==s){if(r<128&&s<128)return Na(r,s);{const i=ba(),a=ja(i.encode(ka(e,n)),i.encode(ka(t,n)));return 0!==a?a:Na(r,s)}}n+=r>65535?2:1}return Na(e.length,t.length)}function ka(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function ja(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Na(e[n],t[n]);return Na(e.length,t.length)}function _a(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ia="__name__";class Ea{constructor(e,t,n){void 0===t?t=0:t>e.length&&sa(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&sa(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Ea.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ea?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Ea.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Na(e.length,t.length)}static compareSegments(e,t){const n=Ea.isNumericId(e),r=Ea.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Ea.extractNumericId(e).compare(Ea.extractNumericId(t)):Sa(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}}class Ca extends Ea{construct(e,t,n){return new Ca(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n){if(s.indexOf("//")>=0)throw new ca(la.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push(...s.split("/").filter(e=>e.length>0))}return new Ca(e)}static emptyPath(){return new Ca([])}}const Ta=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Aa extends Ea{construct(e,t,n){return new Aa(e,t,n)}static isValidIdentifier(e){return Ta.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Aa.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ia}static keyField(){return new Aa([Ia])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new ca(la.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ca(la.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ca(la.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new ca(la.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Aa(t)}static emptyPath(){return new Aa([])}}class Da{constructor(e){this.path=e}static fromPath(e){return new Da(Ca.fromString(e))}static fromName(e){return new Da(Ca.fromString(e).popFirst(5))}static empty(){return new Da(Ca.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ca.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ca.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Da(new Ca(e.slice()))}}function Ra(e,t,n){if(!n)throw new ca(la.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Pa(e){if(!Da.isDocumentKey(e))throw new ca(la.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Oa(e){if(Da.isDocumentKey(e))throw new ca(la.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function La(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Ma(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":sa(12329,{type:typeof e})}function Fa(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ca(la.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ma(e);throw new ca(la.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Ua(e,t){if(t<=0)throw new ca(la.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function Va(e,t){const n={typeString:e};return t&&(n.value=t),n}function za(e,t){if(!La(e))throw new ca(la.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const a=e[r];if(s&&typeof a!==s){n="JSON field '".concat(r,"' must be a ").concat(s,".");break}if(void 0!==i&&a!==i.value){n="Expected '".concat(r,"' field to equal '").concat(i.value,"'");break}}if(n)throw new ca(la.INVALID_ARGUMENT,n);return!0}const Ba=-62135596800,qa=1e6;class Ha{static now(){return Ha.fromMillis(Date.now())}static fromDate(e){return Ha.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*qa);return new Ha(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ca(la.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ca(la.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ba)throw new ca(la.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ca(la.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qa}_compareTo(e){return this.seconds===e.seconds?Na(this.nanoseconds,e.nanoseconds):Na(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ha._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(za(e,Ha._jsonSchema))return new Ha(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ba;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ha._jsonSchemaVersion="firestore/timestamp/1.0",Ha._jsonSchema={type:Va("string",Ha._jsonSchemaVersion),seconds:Va("number"),nanoseconds:Va("number")};class Ga{static fromTimestamp(e){return new Ga(e)}static min(){return new Ga(new Ha(0,0))}static max(){return new Ga(new Ha(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Wa=-1;class Ka{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Ka.UNKNOWN_ID=-1;function Qa(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Ga.fromTimestamp(1e9===r?new Ha(n+1,0):new Ha(n,r));return new Ja(s,Da.empty(),t)}function Xa(e){return new Ja(e.readTime,e.key,Wa)}class Ja{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ja(Ga.min(),Da.empty(),Wa)}static max(){return new Ja(Ga.max(),Da.empty(),Wa)}}function Ya(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Da.comparator(e.documentKey,t.documentKey),0!==n?n:Na(e.largestBatchId,t.largestBatchId))}const $a="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Za{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function eo(e){if(e.code!==la.FAILED_PRECONDITION||e.message!==$a)throw e;ea("LocalStore","Unexpectedly lost primary lease")}class to{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&sa(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new to((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof to?t:to.resolve(t)}catch(e){return to.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):to.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):to.reject(t)}static resolve(e){return new to((t,n)=>{t(e)})}static reject(e){return new to((t,n)=>{n(e)})}static waitFor(e){return new to((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=to.resolve(!1);for(const n of e)t=t.next(e=>e?to.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new to((n,r)=>{const s=e.length,i=new Array(s);let a=0;for(let o=0;o<s;o++){const l=o;t(e[l]).next(e=>{i[l]=e,++a,a===s&&n(i)},e=>r(e))}})}static doWhile(e,t){return new to((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}function no(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ro(e){return"IndexedDbTransactionError"===e.name}class so{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}so.ue=-1;const io=-1;function ao(e){return null==e}function oo(e){return 0===e&&1/e==-1/0}function lo(e){return"number"==typeof e&&Number.isInteger(e)&&!oo(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const co="\x01";function uo(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=fo(t)),t=ho(e.get(n),t);return fo(t)}function ho(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="\x01\x10";break;case co:n+="\x01\x11";break;default:n+=t}}return n}function fo(e){return e+co+"\x01"}const mo="remoteDocuments",po="owner",go="mutationQueues",vo="mutations";const yo="documentMutations",xo="remoteDocumentsV14",bo="remoteDocumentGlobal",wo="targets",No="targetDocuments",So="targetGlobal",ko="collectionParents",jo="clientMetadata",_o="bundles",Io="namedQueries",Eo="indexConfiguration",Co="indexState",To="indexEntries",Ao="documentOverlays",Do="globals",Ro=[go,vo,yo,mo,wo,po,So,No,jo,bo,ko,_o,Io],Po=[go,vo,yo,xo,wo,po,So,No,jo,bo,ko,_o,Io,Ao],Oo=Po,Lo=[...Oo,Eo,Co,To];function Mo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Fo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Uo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Vo{constructor(e,t){this.comparator=e,this.root=t||Bo.EMPTY}insert(e,t){return new Vo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bo.BLACK,null,null))}remove(e){return new Vo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zo(this.root,e,this.comparator,!1)}getReverseIterator(){return new zo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zo(this.root,e,this.comparator,!0)}}class zo{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bo{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:Bo.RED,this.left=null!=r?r:Bo.EMPTY,this.right=null!=s?s:Bo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Bo(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Bo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw sa(43730,{key:this.key,value:this.value});if(this.right.isRed())throw sa(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw sa(27949);return e+(this.isRed()?0:1)}}Bo.EMPTY=null,Bo.RED=!0,Bo.BLACK=!1,Bo.EMPTY=new class{constructor(){this.size=0}get key(){throw sa(57766)}get value(){throw sa(16141)}get color(){throw sa(16727)}get left(){throw sa(29726)}get right(){throw sa(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new Bo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class qo{constructor(e){this.comparator=e,this.data=new Vo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ho(this.data.getIterator())}getIteratorFrom(e){return new Ho(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof qo))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qo(this.comparator);return t.data=e,t}}class Ho{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Go{constructor(e){this.fields=e,e.sort(Aa.comparator)}static empty(){return new Go([])}unionWith(e){let t=new qo(Aa.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Go(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _a(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Wo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ko{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Wo("Invalid base64 string: "+e):e}}(e);return new Ko(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ko(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Na(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ko.EMPTY_BYTE_STRING=new Ko("");const Qo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xo(e){if(aa(!!e,39018),"string"==typeof e){let t=0;const n=Qo.exec(e);if(aa(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Jo(e.seconds),nanos:Jo(e.nanos)}}function Jo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Yo(e){return"string"==typeof e?Ko.fromBase64String(e):Ko.fromUint8Array(e)}const $o="server_timestamp",Zo="__type__",el="__previous_value__",tl="__local_write_time__";function nl(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Zo])||void 0===n?void 0:n.stringValue)===$o}function rl(e){const t=e.mapValue.fields[el];return nl(t)?rl(t):t}function sl(e){const t=Xo(e.mapValue.fields[tl].timestampValue);return new Ha(t.seconds,t.nanos)}class il{constructor(e,t,n,r,s,i,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const al="(default)";class ol{constructor(e,t){this.projectId=e,this.database=t||al}static empty(){return new ol("","")}get isDefaultDatabase(){return this.database===al}isEqual(e){return e instanceof ol&&e.projectId===this.projectId&&e.database===this.database}}const ll="__type__",cl="__max__",ul={mapValue:{fields:{__type__:{stringValue:cl}}}},dl="__vector__",hl="value";function fl(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?nl(e)?4:Tl(e)?9007199254740991:El(e)?10:11:sa(28295,{value:e})}function ml(e,t){if(e===t)return!0;const n=fl(e);if(n!==fl(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return sl(e).isEqual(sl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Xo(e.timestampValue),r=Xo(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Yo(e.bytesValue).isEqual(Yo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Jo(e.geoPointValue.latitude)===Jo(t.geoPointValue.latitude)&&Jo(e.geoPointValue.longitude)===Jo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Jo(e.integerValue)===Jo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Jo(e.doubleValue),r=Jo(t.doubleValue);return n===r?oo(n)===oo(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return _a(e.arrayValue.values||[],t.arrayValue.values||[],ml);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Mo(n)!==Mo(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!ml(n[s],r[s])))return!1;return!0}(e,t);default:return sa(52216,{left:e})}}function pl(e,t){return void 0!==(e.values||[]).find(e=>ml(e,t))}function gl(e,t){if(e===t)return 0;const n=fl(e),r=fl(t);if(n!==r)return Na(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Na(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Jo(e.integerValue||e.doubleValue),r=Jo(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return vl(e.timestampValue,t.timestampValue);case 4:return vl(sl(e),sl(t));case 5:return Sa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Yo(e),r=Yo(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=Na(n[s],r[s]);if(0!==e)return e}return Na(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Na(Jo(e.latitude),Jo(t.latitude));return 0!==n?n:Na(Jo(e.longitude),Jo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return yl(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,s,i;const a=e.fields||{},o=t.fields||{},l=null===(n=a[hl])||void 0===n?void 0:n.arrayValue,c=null===(r=o[hl])||void 0===r?void 0:r.arrayValue,u=Na((null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0,(null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:yl(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ul.mapValue&&t===ul.mapValue)return 0;if(e===ul.mapValue)return 1;if(t===ul.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let a=0;a<r.length&&a<i.length;++a){const e=Sa(r[a],i[a]);if(0!==e)return e;const t=gl(n[r[a]],s[i[a]]);if(0!==t)return t}return Na(r.length,i.length)}(e.mapValue,t.mapValue);default:throw sa(23264,{le:n})}}function vl(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Na(e,t);const n=Xo(e),r=Xo(t),s=Na(n.seconds,r.seconds);return 0!==s?s:Na(n.nanos,r.nanos)}function yl(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=gl(n[s],r[s]);if(e)return e}return Na(n.length,r.length)}function xl(e){return bl(e)}function bl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Xo(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Yo(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Da.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=bl(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+="".concat(s,":").concat(bl(e.fields[s]));return n+"}"}(e.mapValue):sa(61005,{value:e})}function wl(e){switch(fl(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=rl(e);return t?16+wl(t):16;case 5:return 2*e.stringValue.length;case 6:return Yo(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+wl(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Fo(e.fields,(e,n)=>{t+=e.length+wl(n)}),t}(e.mapValue);default:throw sa(13486,{value:e})}}function Nl(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Sl(e){return!!e&&"integerValue"in e}function kl(e){return!!e&&"arrayValue"in e}function jl(e){return!!e&&"nullValue"in e}function _l(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Il(e){return!!e&&"mapValue"in e}function El(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[ll])||void 0===n?void 0:n.stringValue)===dl}function Cl(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Fo(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Cl(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Cl(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Tl(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===cl}class Al{constructor(e){this.value=e}static empty(){return new Al({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Il(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cl(t)}setAll(e){let t=Aa.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=Cl(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Il(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ml(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Il(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Fo(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Al(Cl(this.value))}}function Dl(e){const t=[];return Fo(e.fields,(e,n)=>{const r=new Aa([e]);if(Il(n)){const e=Dl(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Go(t)}class Rl{constructor(e,t,n,r,s,i,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=a}static newInvalidDocument(e){return new Rl(e,0,Ga.min(),Ga.min(),Ga.min(),Al.empty(),0)}static newFoundDocument(e,t,n,r){return new Rl(e,1,t,Ga.min(),n,r,0)}static newNoDocument(e,t){return new Rl(e,2,t,Ga.min(),Ga.min(),Al.empty(),0)}static newUnknownDocument(e,t){return new Rl(e,3,t,Ga.min(),Ga.min(),Al.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ga.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Al.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Al.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ga.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Rl&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rl(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Pl{constructor(e,t){this.position=e,this.inclusive=t}}function Ol(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],a=e.position[s];if(r=i.field.isKeyField()?Da.comparator(Da.fromName(a.referenceValue),n.key):gl(a,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Ll(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ml(e.position[n],t.position[n]))return!1;return!0}class Ml{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Fl(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ul{}class Vl extends Ul{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ql(e,t,n):"array-contains"===t?new $l(e,n):"in"===t?new Zl(e,n):"not-in"===t?new ec(e,n):"array-contains-any"===t?new tc(e,n):new Vl(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Xl(e,n):new Jl(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(gl(t,this.value)):null!==t&&fl(this.value)===fl(t)&&this.matchesComparison(gl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return sa(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zl extends Ul{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new zl(e,t)}matches(e){return Bl(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Bl(e){return"and"===e.op}function ql(e){return Hl(e)&&Bl(e)}function Hl(e){for(const t of e.filters)if(t instanceof zl)return!1;return!0}function Gl(e){if(e instanceof Vl)return e.field.canonicalString()+e.op.toString()+xl(e.value);if(ql(e))return e.filters.map(e=>Gl(e)).join(",");{const t=e.filters.map(e=>Gl(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Wl(e,t){return e instanceof Vl?function(e,t){return t instanceof Vl&&e.op===t.op&&e.field.isEqual(t.field)&&ml(e.value,t.value)}(e,t):e instanceof zl?function(e,t){return t instanceof zl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Wl(n,t.filters[r]),!0)}(e,t):void sa(19439)}function Kl(e){return e instanceof Vl?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(xl(e.value))}(e):e instanceof zl?function(e){return e.op.toString()+" {"+e.getFilters().map(Kl).join(" ,")+"}"}(e):"Filter"}class Ql extends Vl{constructor(e,t,n){super(e,t,n),this.key=Da.fromName(n.referenceValue)}matches(e){const t=Da.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xl extends Vl{constructor(e,t){super(e,"in",t),this.keys=Yl("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Jl extends Vl{constructor(e,t){super(e,"not-in",t),this.keys=Yl("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Yl(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Da.fromName(e.referenceValue))}class $l extends Vl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kl(t)&&pl(t.arrayValue,this.value)}}class Zl extends Vl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&pl(this.value.arrayValue,t)}}class ec extends Vl{constructor(e,t){super(e,"not-in",t)}matches(e){if(pl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!pl(this.value.arrayValue,t)}}class tc extends Vl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>pl(this.value.arrayValue,e))}}class nc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=a,this.Pe=null}}function rc(e){return new nc(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function sc(e){const t=oa(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Gl(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ao(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>xl(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>xl(e)).join(",")),t.Pe=e}return t.Pe}function ic(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Fl(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Wl(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ll(e.startAt,t.startAt)&&Ll(e.endAt,t.endAt)}function ac(e){return Da.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class oc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=a,this.endAt=o,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function lc(e,t,n,r,s,i,a,o){return new oc(e,t,n,r,s,i,a,o)}function cc(e){return new oc(e)}function uc(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function dc(e){return null!==e.collectionGroup}function hc(e){const t=oa(e);if(null===t.Te){t.Te=[];const e=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new qo(Aa.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Te.push(new Ml(r,n))}),e.has(Aa.keyField().canonicalString())||t.Te.push(new Ml(Aa.keyField(),n))}return t.Te}function fc(e){const t=oa(e);return t.Ie||(t.Ie=mc(t,hc(e))),t.Ie}function mc(e,t){if("F"===e.limitType)return rc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Ml(e.field,t)});const n=e.endAt?new Pl(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Pl(e.startAt.position,e.startAt.inclusive):null;return rc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function pc(e,t){const n=e.filters.concat([t]);return new oc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function gc(e,t,n){return new oc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vc(e,t){return ic(fc(e),fc(t))&&e.limitType===t.limitType}function yc(e){return"".concat(sc(fc(e)),"|lt:").concat(e.limitType)}function xc(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Kl(e)).join(", "),"]")),ao(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>xl(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>xl(e)).join(",")),"Target(".concat(t,")")}(fc(e)),"; limitType=").concat(e.limitType,")")}function bc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Da.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of hc(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ol(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,hc(e),t))&&!(e.endAt&&!function(e,t,n){const r=Ol(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,hc(e),t))}(e,t)}function wc(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Nc(e){return(t,n)=>{let r=!1;for(const s of hc(e)){const e=Sc(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Sc(e,t,n){const r=e.field.isKeyField()?Da.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?gl(r,s):sa(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return sa(19790,{direction:e.dir})}}class kc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Fo(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return Uo(this.inner)}size(){return this.innerSize}}const jc=new Vo(Da.comparator);function _c(){return jc}const Ic=new Vo(Da.comparator);function Ec(){let e=Ic;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.insert(s.key,s);return e}function Cc(e){let t=Ic;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Tc(){return Dc()}function Ac(){return Dc()}function Dc(){return new kc(e=>e.toString(),(e,t)=>e.isEqual(t))}const Rc=new Vo(Da.comparator),Pc=new qo(Da.comparator);function Oc(){let e=Pc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.add(s);return e}const Lc=new qo(Na);function Mc(){return Lc}function Fc(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oo(t)?"-0":t}}function Uc(e){return{integerValue:""+e}}function Vc(e,t){return lo(t)?Uc(t):Fc(e,t)}class zc{constructor(){this._=void 0}}function Bc(e,t,n){return e instanceof Gc?function(e,t){const n={fields:{[Zo]:{stringValue:$o},[tl]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&nl(t)&&(t=rl(t)),t&&(n.fields[el]=t),{mapValue:n}}(n,t):e instanceof Wc?Kc(e,t):e instanceof Qc?Xc(e,t):function(e,t){const n=Hc(e,t),r=Yc(n)+Yc(e.Ee);return Sl(n)&&Sl(e.Ee)?Uc(r):Fc(e.serializer,r)}(e,t)}function qc(e,t,n){return e instanceof Wc?Kc(e,t):e instanceof Qc?Xc(e,t):n}function Hc(e,t){return e instanceof Jc?function(e){return Sl(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Gc extends zc{}class Wc extends zc{constructor(e){super(),this.elements=e}}function Kc(e,t){const n=$c(t);for(const r of e.elements)n.some(e=>ml(e,r))||n.push(r);return{arrayValue:{values:n}}}class Qc extends zc{constructor(e){super(),this.elements=e}}function Xc(e,t){let n=$c(t);for(const r of e.elements)n=n.filter(e=>!ml(e,r));return{arrayValue:{values:n}}}class Jc extends zc{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Yc(e){return Jo(e.integerValue||e.doubleValue)}function $c(e){return kl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Zc{constructor(e,t){this.field=e,this.transform=t}}class eu{constructor(e,t){this.version=e,this.transformResults=t}}class tu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tu}static exists(e){return new tu(void 0,e)}static updateTime(e){return new tu(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nu(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ru{}function su(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new mu(e.key,tu.none()):new cu(e.key,e.data,tu.none());{const n=e.data,r=Al.empty();let s=new qo(Aa.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new uu(e.key,r,new Go(s.toArray()),tu.none())}}function iu(e,t,n){e instanceof cu?function(e,t,n){const r=e.value.clone(),s=hu(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof uu?function(e,t,n){if(!nu(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=hu(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(du(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function au(e,t,n,r){return e instanceof cu?function(e,t,n,r){if(!nu(e.precondition,t))return n;const s=e.value.clone(),i=fu(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof uu?function(e,t,n,r){if(!nu(e.precondition,t))return n;const s=fu(e.fieldTransforms,r,t),i=t.data;return i.setAll(du(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return nu(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function ou(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=Hc(r.transform,e||null);null!=s&&(null===n&&(n=Al.empty()),n.set(r.field,s))}return n||null}function lu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&_a(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Wc&&t instanceof Wc||e instanceof Qc&&t instanceof Qc?_a(e.elements,t.elements,ml):e instanceof Jc&&t instanceof Jc?ml(e.Ee,t.Ee):e instanceof Gc&&t instanceof Gc}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class cu extends ru{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class uu extends ru{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function du(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function hu(e,t,n){const r=new Map;aa(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let s=0;s<n.length;s++){const i=e[s],a=i.transform,o=t.data.field(i.field);r.set(i.field,qc(a,o,n[s]))}return r}function fu(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,Bc(e,i,t))}return r}class mu extends ru{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pu extends ru{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gu{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&iu(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=au(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=au(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ac();return this.mutations.forEach(r=>{const s=e.get(r.key),i=s.overlayedDocument;let a=this.applyToLocalView(i,s.mutatedFields);a=t.has(r.key)?null:a;const o=su(i,a);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(Ga.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Oc())}isEqual(e){return this.batchId===e.batchId&&_a(this.mutations,e.mutations,(e,t)=>lu(e,t))&&_a(this.baseMutations,e.baseMutations,(e,t)=>lu(e,t))}}class vu{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){aa(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=Rc;const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new vu(e,t,n,r)}}class yu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class xu{constructor(e,t){this.count=e,this.unchangedNames=t}}var bu,wu;function Nu(e){switch(e){case la.OK:return sa(64938);case la.CANCELLED:case la.UNKNOWN:case la.DEADLINE_EXCEEDED:case la.RESOURCE_EXHAUSTED:case la.INTERNAL:case la.UNAVAILABLE:case la.UNAUTHENTICATED:return!1;case la.INVALID_ARGUMENT:case la.NOT_FOUND:case la.ALREADY_EXISTS:case la.PERMISSION_DENIED:case la.FAILED_PRECONDITION:case la.ABORTED:case la.OUT_OF_RANGE:case la.UNIMPLEMENTED:case la.DATA_LOSS:return!0;default:return sa(15467,{code:e})}}function Su(e){if(void 0===e)return ta("GRPC error has no .code"),la.UNKNOWN;switch(e){case bu.OK:return la.OK;case bu.CANCELLED:return la.CANCELLED;case bu.UNKNOWN:return la.UNKNOWN;case bu.DEADLINE_EXCEEDED:return la.DEADLINE_EXCEEDED;case bu.RESOURCE_EXHAUSTED:return la.RESOURCE_EXHAUSTED;case bu.INTERNAL:return la.INTERNAL;case bu.UNAVAILABLE:return la.UNAVAILABLE;case bu.UNAUTHENTICATED:return la.UNAUTHENTICATED;case bu.INVALID_ARGUMENT:return la.INVALID_ARGUMENT;case bu.NOT_FOUND:return la.NOT_FOUND;case bu.ALREADY_EXISTS:return la.ALREADY_EXISTS;case bu.PERMISSION_DENIED:return la.PERMISSION_DENIED;case bu.FAILED_PRECONDITION:return la.FAILED_PRECONDITION;case bu.ABORTED:return la.ABORTED;case bu.OUT_OF_RANGE:return la.OUT_OF_RANGE;case bu.UNIMPLEMENTED:return la.UNIMPLEMENTED;case bu.DATA_LOSS:return la.DATA_LOSS;default:return sa(39323,{code:e})}}(wu=bu||(bu={}))[wu.OK=0]="OK",wu[wu.CANCELLED=1]="CANCELLED",wu[wu.UNKNOWN=2]="UNKNOWN",wu[wu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wu[wu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wu[wu.NOT_FOUND=5]="NOT_FOUND",wu[wu.ALREADY_EXISTS=6]="ALREADY_EXISTS",wu[wu.PERMISSION_DENIED=7]="PERMISSION_DENIED",wu[wu.UNAUTHENTICATED=16]="UNAUTHENTICATED",wu[wu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wu[wu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wu[wu.ABORTED=10]="ABORTED",wu[wu.OUT_OF_RANGE=11]="OUT_OF_RANGE",wu[wu.UNIMPLEMENTED=12]="UNIMPLEMENTED",wu[wu.INTERNAL=13]="INTERNAL",wu[wu.UNAVAILABLE=14]="UNAVAILABLE",wu[wu.DATA_LOSS=15]="DATA_LOSS";let ku=null;const ju=new Pi([4294967295,4294967295],0);function _u(e){const t=ba().encode(e),n=new Oi;return n.update(t),new Uint8Array(n.digest())}function Iu(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Pi([n,r],0),new Pi([s,i],0)]}class Eu{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Cu("Invalid padding: ".concat(t));if(n<0)throw new Cu("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Cu("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Cu("Invalid padding when bitmap length is 0: ".concat(t));this.fe=8*e.length-t,this.ge=Pi.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply(Pi.fromNumber(n)));return 1===r.compare(ju)&&(r=new Pi([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=_u(e),[n,r]=Iu(t);for(let s=0;s<this.hashCount;s++){const e=this.pe(n,r,s);if(!this.ye(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new Eu(s,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.fe)return;const t=_u(e),[n,r]=Iu(t);for(let s=0;s<this.hashCount;s++){const e=this.pe(n,r,s);this.we(e)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Tu{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Tu(Ga.min(),r,new Vo(Na),_c(),Oc())}}class Au{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Au(n,t,Oc(),Oc(),Oc())}}class Du{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class Ru{constructor(e,t){this.targetId=e,this.De=t}}class Pu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ko.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ou{constructor(){this.ve=0,this.Ce=Fu(),this.Fe=Ko.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Oc(),t=Oc(),n=Oc();return this.Ce.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:sa(38017,{changeType:s})}}),new Au(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=Fu()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,aa(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Lu{constructor(e){this.We=e,this.Ge=new Map,this.ze=_c(),this.je=Mu(),this.Je=Mu(),this.He=new Vo(Na)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:sa(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const s=r.target;if(ac(s))if(0===n){const e=new Da(s.path);this.Xe(t,e,Rl.newNoDocument(e,Ga.min()))}else aa(1===n,20013,{expectedCount:n});else{const r=this.ot(t);if(r!==n){const n=this._t(e),s=n?this.ut(n,e,r):1;if(0!==s){this.rt(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}null==ku||ku.ct(function(e,t,n,r,s){var i,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===s,hashCount:null!==(i=null==h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.De,this.We.lt(),n,s))}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,a;try{i=Yo(n).toUint8Array()}catch(e){if(e instanceof Wo)return na("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new Eu(i,r,s)}catch(e){return na(e instanceof Cu?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.fe?null:a}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const s=this.We.lt(),i="projects/".concat(s.projectId,"/databases/").concat(s.database,"/documents/").concat(n.path.canonicalString());e.mightContain(i)||(this.Xe(t,n,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((n,r)=>{const s=this.st(r);if(s){if(n.current&&ac(s.target)){const t=new Da(s.target.path);this.Tt(t).has(r)||this.It(r,t)||this.Xe(r,t,Rl.newNoDocument(t,e))}n.Ne&&(t.set(r,n.Le()),n.ke())}});let n=Oc();this.Je.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const r=new Tu(e,t,this.He,this.ze,n);return this.ze=_c(),this.je=Mu(),this.Je=Mu(),this.He=new Vo(Na),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ou,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new qo(Na),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new qo(Na),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||ea("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ou),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Mu(){return new Vo(Da.comparator)}function Fu(){return new Vo(Da.comparator)}const Uu={asc:"ASCENDING",desc:"DESCENDING"},Vu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zu={and:"AND",or:"OR"};class Bu{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qu(e,t){return e.useProto3Json||ao(t)?t:{value:t}}function Hu(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Gu(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Wu(e,t){return Hu(e,t.toTimestamp())}function Ku(e){return aa(!!e,49232),Ga.fromTimestamp(function(e){const t=Xo(e);return new Ha(t.seconds,t.nanos)}(e))}function Qu(e,t){return Xu(e,t).canonicalString()}function Xu(e,t){const n=function(e){return new Ca(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ju(e){const t=Ca.fromString(e);return aa(gd(t),10190,{key:t.toString()}),t}function Yu(e,t){return Qu(e.databaseId,t.path)}function $u(e,t){const n=Ju(t);if(n.get(1)!==e.databaseId.projectId)throw new ca(la.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ca(la.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Da(nd(n))}function Zu(e,t){return Qu(e.databaseId,t)}function ed(e){const t=Ju(e);return 4===t.length?Ca.emptyPath():nd(t)}function td(e){return new Ca(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function nd(e){return aa(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function rd(e,t,n){return{name:Yu(e,t),fields:n.value.mapValue.fields}}function sd(e,t){let n;if(t instanceof cu)n={update:rd(e,t.key,t.value)};else if(t instanceof mu)n={delete:Yu(e,t.key)};else if(t instanceof uu)n={update:rd(e,t.key,t.data),updateMask:pd(t.fieldMask)};else{if(!(t instanceof pu))return sa(16599,{Rt:t.type});n={verify:Yu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Gc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Wc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Qc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Jc)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw sa(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Wu(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:sa(27497)}(e,t.precondition)),n}function id(e,t){return{documents:[Zu(e,t.path)]}}function ad(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Zu(e,s);const i=function(e){if(0!==e.length)return md(zl.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:hd(e.field),direction:cd(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=qu(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:s}}function od(e){let t=ed(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){aa(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=ld(e);return t instanceof zl&&ql(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new Ml(fd(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,ao(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Pl(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Pl(n,t)}(n.endAt)),lc(t,s,a,i,o,"F",l,c)}function ld(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=fd(e.unaryFilter.field);return Vl.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=fd(e.unaryFilter.field);return Vl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fd(e.unaryFilter.field);return Vl.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=fd(e.unaryFilter.field);return Vl.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return sa(61313);default:return sa(60726)}}(e):void 0!==e.fieldFilter?function(e){return Vl.create(fd(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return sa(58110);default:return sa(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return zl.create(e.compositeFilter.filters.map(e=>ld(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return sa(1026)}}(e.compositeFilter.op))}(e):sa(30097,{filter:e})}function cd(e){return Uu[e]}function ud(e){return Vu[e]}function dd(e){return zu[e]}function hd(e){return{fieldPath:e.canonicalString()}}function fd(e){return Aa.fromServerFormat(e.fieldPath)}function md(e){return e instanceof Vl?function(e){if("=="===e.op){if(_l(e.value))return{unaryFilter:{field:hd(e.field),op:"IS_NAN"}};if(jl(e.value))return{unaryFilter:{field:hd(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(_l(e.value))return{unaryFilter:{field:hd(e.field),op:"IS_NOT_NAN"}};if(jl(e.value))return{unaryFilter:{field:hd(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hd(e.field),op:ud(e.op),value:e.value}}}(e):e instanceof zl?function(e){const t=e.getFilters().map(e=>md(e));return 1===t.length?t[0]:{compositeFilter:{op:dd(e.op),filters:t}}}(e):sa(54877,{filter:e})}function pd(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function gd(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class vd{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ga.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ga.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ko.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new vd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class yd{constructor(e){this.gt=e}}function xd(e){const t=od({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?gc(t,t.limit,"L"):t}class bd{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Jo(e.integerValue));else if("doubleValue"in e){const n=Jo(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),oo(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=Xo(n)),t.Mt("".concat(n.seconds||"")),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Yo(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?Tl(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):El(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):sa(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const r of Object.keys(n))this.xt(r,t),this.Dt(n[r],t)}Lt(e,t){var n,r;const s=e.fields||{};this.Ct(t,53);const i=hl,a=(null===(r=null===(n=s[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(t,15),t.Ft(Jo(a)),this.xt(i,t),this.Dt(s[i],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const r of n)this.Dt(r,t)}Bt(e,t){this.Ct(t,37),Da.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}bd.Ut=new bd;class wd{constructor(){this.Dn=new Nd}addToCollectionParentIndex(e,t){return this.Dn.add(t),to.resolve()}getCollectionParents(e,t){return to.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return to.resolve()}deleteFieldIndex(e,t){return to.resolve()}deleteAllFieldIndexes(e){return to.resolve()}createTargetIndexes(e,t){return to.resolve()}getDocumentsMatchingTarget(e,t){return to.resolve(null)}getIndexType(e,t){return to.resolve(0)}getFieldIndexes(e,t){return to.resolve([])}getNextCollectionGroupToUpdate(e){return to.resolve(null)}getMinOffset(e,t){return to.resolve(Ja.min())}getMinOffsetFromCollectionGroup(e,t){return to.resolve(Ja.min())}updateCollectionGroup(e,t,n){return to.resolve()}updateIndexEntries(e,t){return to.resolve()}}class Nd{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new qo(Ca.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new qo(Ca.comparator)).toArray()}}new Uint8Array(0);const Sd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kd=41943040;class jd{static withCacheSize(e){return new jd(e,jd.DEFAULT_COLLECTION_PERCENTILE,jd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}jd.DEFAULT_COLLECTION_PERCENTILE=10,jd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jd.DEFAULT=new jd(kd,jd.DEFAULT_COLLECTION_PERCENTILE,jd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jd.DISABLED=new jd(-1,0,0);class _d{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new _d(0)}static ur(){return new _d(-1)}}const Id="LruGarbageCollector",Ed=1048576;function Cd(e,t){let[n,r]=e,[s,i]=t;const a=Na(n,s);return 0===a?Na(r,i):a}class Td{constructor(e){this.Tr=e,this.buffer=new qo(Cd),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Cd(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Ad{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){ea(Id,"Garbage collection scheduled in ".concat(e,"ms")),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ro(e)?ea(Id,"Ignoring IndexedDB error during garbage collection: ",e):await eo(e)}await this.Rr(3e5)})}}class Dd{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return to.resolve(so.ue);const n=new Td(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ea("LruGarbageCollector","Garbage collection skipped; disabled"),to.resolve(Sd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ea("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Sd):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,s,i,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(ea("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(s=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Zi()<=Ue.DEBUG&&ea("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-i)+"ms\n"+"\tRemoved ".concat(s," targets in ")+(o-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),to.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e})))}}function Rd(e,t){return new Dd(e,t)}class Pd{constructor(){this.changes=new kc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rl.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?to.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Od{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ld{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&au(n.mutation,e,Go.empty(),Ha.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Oc()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oc();const r=Tc();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Ec();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Tc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Oc()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=_c();const i=Dc(),a=Dc();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof uu)?s=s.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),au(a.mutation,t,a.mutation.getFieldMask(),Ha.now())):i.set(t.key,Go.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new Od(t,null!==(n=i.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Dc();let r=new Vo((e,t)=>e-t),s=Oc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let a=n.get(e)||Go.empty();a=s.applyToLocalView(i,a),n.set(e,a);const o=(r.get(s.batchId)||Oc()).add(e);r=r.insert(s.batchId,o)})}).next(()=>{const i=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Ac();l.forEach(e=>{if(!s.has(e)){const r=su(t.get(e),n.get(e));null!==r&&c.set(e,r),s=s.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return to.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Da.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):to.resolve(Tc());let a=Wa,o=s;return i.next(t=>to.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),s.get(t)?to.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,o,t,Oc())).next(e=>({batchId:a,changes:Cc(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Da(t)).next(e=>{let t=Ec();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=Ec();return this.indexManager.getCollectionParents(e,s).next(a=>to.forEach(a,a=>{const o=function(e,t){return new oc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Rl.newInvalidDocument(r)))});let n=Ec();return e.forEach((e,r)=>{const i=s.get(e);void 0!==i&&au(i.mutation,r,Go.empty(),Ha.now()),bc(t,r)&&(n=n.insert(e,r))}),n})}}class Md{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return to.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ku(e.createTime)}}(t)),to.resolve()}getNamedQuery(e,t){return to.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(e){return{name:e.name,query:xd(e.bundledQuery),readTime:Ku(e.readTime)}}(t)),to.resolve()}}class Fd{constructor(){this.overlays=new Vo(Da.comparator),this.kr=new Map}getOverlay(e,t){return to.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Tc();return to.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.wt(e,t,r)}),to.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),to.resolve()}getOverlaysForCollection(e,t,n){const r=Tc(),s=t.length+1,i=new Da(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return to.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Vo((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Tc(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Tc(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return to.resolve(a)}wt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new yu(t,n));let s=this.kr.get(t);void 0===s&&(s=Oc(),this.kr.set(t,s)),this.kr.set(t,s.add(n.key))}}class Ud{constructor(){this.sessionToken=Ko.EMPTY_BYTE_STRING}getSessionToken(e){return to.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,to.resolve()}}class Vd{constructor(){this.qr=new qo(zd.Qr),this.$r=new qo(zd.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new zd(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new zd(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new Da(new Ca([])),n=new zd(t,e),r=new zd(t,e+1),s=[];return this.$r.forEachInRange([n,r],e=>{this.Wr(e),s.push(e.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Da(new Ca([])),n=new zd(t,e),r=new zd(t,e+1);let s=Oc();return this.$r.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new zd(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class zd{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Da.comparator(e.key,t.key)||Na(e.Hr,t.Hr)}static Ur(e,t){return Na(e.Hr,t.Hr)||Da.comparator(e.key,t.key)}}class Bd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new qo(zd.Qr)}checkEmpty(e){return to.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new gu(s,t,n,r);this.mutationQueue.push(i);for(const a of r)this.Yr=this.Yr.add(new zd(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return to.resolve(i)}lookupMutationBatch(e,t){return to.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),s=r<0?0:r;return to.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return to.resolve(0===this.mutationQueue.length?io:this.er-1)}getAllMutationBatches(e){return to.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new zd(t,0),r=new zd(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([n,r],e=>{const t=this.Zr(e.Hr);s.push(t)}),to.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new qo(Na);return t.forEach(e=>{const t=new zd(e,0),r=new zd(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,r],e=>{n=n.add(e.Hr)})}),to.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;Da.isDocumentKey(s)||(s=s.child(""));const i=new zd(new Da(s),0);let a=new qo(Na);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Hr)),!0)},i),to.resolve(this.ei(a))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){aa(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return to.forEach(t.mutations,r=>{const s=new zd(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new zd(t,0),r=this.Yr.firstAfterOrEqual(n);return to.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,to.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qd{constructor(e){this.ni=e,this.docs=new Vo(Da.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return to.resolve(n?n.document.mutableCopy():Rl.newInvalidDocument(t))}getEntries(e,t){let n=_c();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Rl.newInvalidDocument(e))}),to.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=_c();const i=t.path,a=new Da(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||Ya(Xa(a),n)<=0||(r.has(a.key)||bc(t,a))&&(s=s.insert(a.key,a.mutableCopy()))}return to.resolve(s)}getAllFromCollectionGroup(e,t,n,r){sa(9500)}ri(e,t){return to.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Hd(this)}getSize(e){return to.resolve(this.size)}}class Hd extends Pd{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),to.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class Gd{constructor(e){this.persistence=e,this.ii=new kc(e=>sc(e),ic),this.lastRemoteSnapshotVersion=Ga.min(),this.highestTargetId=0,this.si=0,this.oi=new Vd,this.targetCount=0,this._i=_d.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),to.resolve()}getLastRemoteSnapshotVersion(e){return to.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return to.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),to.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),to.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new _d(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,to.resolve()}updateTargetData(e,t){return this.hr(t),to.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,to.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.ii.forEach((i,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.ii.delete(i),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),to.waitFor(s).next(()=>r)}getTargetCount(e){return to.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return to.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),to.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),to.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),to.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return to.resolve(n)}containsKey(e,t){return to.resolve(this.oi.containsKey(t))}}class Wd{constructor(e,t){this.ai={},this.overlays={},this.ui=new so(0),this.ci=!1,this.ci=!0,this.li=new Ud,this.referenceDelegate=e(this),this.hi=new Gd(this),this.indexManager=new wd,this.remoteDocumentCache=function(e){return new qd(e)}(e=>this.referenceDelegate.Pi(e)),this.serializer=new yd(t),this.Ti=new Md(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new Bd(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){ea("MemoryPersistence","Starting transaction:",e);const r=new Kd(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ei(e,t){return to.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class Kd extends Za{constructor(e){super(),this.currentSequenceNumber=e}}class Qd{constructor(e){this.persistence=e,this.Ai=new Vd,this.Ri=null}static Vi(e){return new Qd(e)}get mi(){if(this.Ri)return this.Ri;throw sa(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),to.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),to.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),to.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return to.forEach(this.mi,n=>{const r=Da.fromPath(n);return this.fi(e,r).next(e=>{e||t.removeEntry(r,Ga.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return to.or([()=>to.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Xd{constructor(e,t){this.persistence=e,this.gi=new kc(e=>uo(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Rd(this,t)}static Vi(e,t){return new Xd(e,t)}Ii(){}di(e){return to.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return to.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(e=>e?to.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ri(e,r=>this.Sr(e,r,t).next(e=>{e||(n++,s.removeEntry(r,Ga.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),to.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),to.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),to.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),to.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wl(e.data.value)),t}Sr(e,t,n){return to.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return to.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Jd{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=Oc(),r=Oc();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Jd(e,t.fromCache,n,r)}}class Yd{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class $d{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=we()?8:no(xe())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ps(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ys(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new Yd;return this.ws(e,t,n).next(r=>{if(s.result=r,this.Rs)return this.Ss(e,t,n,r.size)})}).next(()=>s.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(Zi()<=Ue.DEBUG&&ea("QueryEngine","SDK will not create cache indexes for query:",xc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),to.resolve()):(Zi()<=Ue.DEBUG&&ea("QueryEngine","Query:",xc(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(Zi()<=Ue.DEBUG&&ea("QueryEngine","The SDK decides to create cache indexes for query:",xc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fc(t))):to.resolve())}ps(e,t){if(uc(t))return to.resolve(null);let n=fc(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=gc(t,null,"F"),n=fc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=Oc(...r);return this.gs.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.bs(t,r);return this.Ds(t,i,s,n.readTime)?this.ps(e,gc(t,null,"F")):this.vs(e,i,t,n)}))})))}ys(e,t,n,r){return uc(t)||r.isEqual(Ga.min())?to.resolve(null):this.gs.getDocuments(e,n).next(s=>{const i=this.bs(t,s);return this.Ds(t,i,n,r)?to.resolve(null):(Zi()<=Ue.DEBUG&&ea("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xc(t)),this.vs(e,i,t,Qa(r,Wa)).next(e=>e))})}bs(e,t){let n=new qo(Nc(e));return t.forEach((t,r)=>{bc(e,r)&&(n=n.add(r))}),n}Ds(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ws(e,t,n){return Zi()<=Ue.DEBUG&&ea("QueryEngine","Using full collection scan to execute query:",xc(t)),this.gs.getDocumentsMatchingQuery(e,t,Ja.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Zd="LocalStore";class eh{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Vo(Na),this.Ms=new kc(e=>sc(e),ic),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ld(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function th(e,t,n,r){return new eh(e,t,n,r)}async function nh(e,t){const n=oa(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],i=[];let a=Oc();for(const e of r){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({Bs:e,removedBatchIds:s,addedBatchIds:i}))})})}function rh(e){const t=oa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function sh(e,t,n){let r=Oc(),s=Oc();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=_c();return n.forEach((n,i)=>{const a=e.get(n);i.isFoundDocument()!==a.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(Ga.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):ea(Zd,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)}),{Ls:r,ks:s}})}function ih(e,t){const n=oa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=io),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ah(e,t){const n=oa(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.hi.getTargetData(e,t).next(s=>s?(r=s,to.resolve(r)):n.hi.allocateTargetId(e).next(s=>(r=new vd(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Fs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}async function oh(e,t,n){const r=oa(e),s=r.Fs.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(e){if(!ro(e))throw e;ea(Zd,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Fs=r.Fs.remove(t),r.Ms.delete(s.target)}function lh(e,t,n){const r=oa(e);let s=Ga.min(),i=Oc();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=oa(e),s=r.Ms.get(n);return void 0!==s?to.resolve(r.Fs.get(s)):r.hi.getTargetData(t,n)}(r,e,fc(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Cs.getDocumentsMatchingQuery(e,t,n?s:Ga.min(),n?i:Oc())).next(e=>(ch(r,wc(t),e),{documents:e,qs:i})))}function ch(e,t,n){let r=e.xs.get(t)||Ga.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.xs.set(t,r)}class uh{constructor(){this.activeTargetIds=Mc()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dh{constructor(){this.Fo=new uh,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new uh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hh{xo(e){}shutdown(){}}const fh="ConnectivityMonitor";class mh{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ea(fh,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ea(fh,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ph=null;function gh(){return null===ph?ph=268435456+Math.round(2147483648*Math.random()):ph++,"0x"+ph.toString(16)}const vh="RestConnection",yh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class xh{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo="projects/".concat(n,"/databases/").concat(r),this.Ko=this.databaseId.database===al?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Wo(e,t,n,r,s){const i=gh(),a=this.Go(e,t.toUriEncodedString());ea(vh,"Sending RPC '".concat(e,"' ").concat(i,":"),a,n);const o={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(o,r,s);const{host:l}=new URL(a),c=me(l);return this.jo(e,a,o,n,c).then(t=>(ea(vh,"Received RPC '".concat(e,"' ").concat(i,": "),t),t),t=>{throw na(vh,"RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",a,"request:",n),t})}Jo(e,t,n,r,s,i){return this.Wo(e,t,n,r,s)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Yi,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=yh[e];return"".concat(this.$o,"/v1/").concat(t,":").concat(n)}terminate(){}}class bh{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const wh="WebChannelConnection";class Nh extends xh{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,s){const i=gh();return new Promise((s,a)=>{const o=new Fi;o.setWithCredentials(!0),o.listenOnce(Vi.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case zi.NO_ERROR:const t=o.getResponseJson();ea(wh,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case zi.TIMEOUT:ea(wh,"RPC '".concat(e,"' ").concat(i," timed out")),a(new ca(la.DEADLINE_EXCEEDED,"Request time out"));break;case zi.HTTP_ERROR:const n=o.getStatus();if(ea(wh,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(la).indexOf(t)>=0?t:la.UNKNOWN}(t.status);a(new ca(e,t.message))}else a(new ca(la.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new ca(la.UNAVAILABLE,"Connection failed."));break;default:sa(9055,{c_:e,streamId:i,l_:o.getLastErrorCode(),h_:o.getLastError()})}}finally{ea(wh,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);ea(wh,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)})}P_(e,t,n){const r=gh(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Gi(),a=Hi(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.zo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=s.join("");ea(wh,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=i.createWebChannel(c,o);this.T_(u);let d=!1,h=!1;const f=new bh({Ho:t=>{h?ea(wh,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(ea(wh,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),ea(wh,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Yo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return m(u,Ui.EventType.OPEN,()=>{h||(ea(wh,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.s_())}),m(u,Ui.EventType.CLOSE,()=>{h||(h=!0,ea(wh,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.__(),this.I_(u))}),m(u,Ui.EventType.ERROR,t=>{h||(h=!0,na(wh,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.__(new ca(la.UNAVAILABLE,"The operation could not be completed")))}),m(u,Ui.EventType.MESSAGE,t=>{var n;if(!h){const s=t.data[0];aa(!!s,16349);const i=s,a=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(a){ea(wh,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=bu[e];if(void 0!==t)return Su(t)}(t),s=a.message;void 0===n&&(n=la.INTERNAL,s="Unknown error status: "+t+" with message "+a.message),h=!0,f.__(new ca(n,s)),u.close()}else ea(wh,"RPC '".concat(e,"' stream ").concat(r," received:"),s),f.a_(s)}}),m(a,qi.STAT_EVENT,t=>{t.stat===Bi.PROXY?ea(wh,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Bi.NOPROXY&&ea(wh,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function Sh(){return"undefined"!=typeof document?document:null}function kh(e){return new Bu(e,!0)}class jh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&ea("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.R_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const _h="PersistentStream";class Ih{constructor(e,t,n,r,s,i,a,o){this.Fi=e,this.w_=n,this.S_=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new jh(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===la.RESOURCE_EXHAUSTED?(ta(t.toString()),ta("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===la.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.b_===t&&this.W_(n,r)},t=>{e(()=>{const e=new ca(la.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return ea(_h,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(ea(_h,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Eh extends Ih{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:sa(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(aa(void 0===t||"string"==typeof t,58123),Ko.fromBase64String(t||"")):(aa(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Ko.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?la.UNKNOWN:Su(e.code);return new ca(t,e.message||"")}(a);n=new Pu(r,s,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=$u(e,r.document.name),i=Ku(r.document.updateTime),a=r.document.createTime?Ku(r.document.createTime):Ga.min(),o=new Al({mapValue:{fields:r.document.fields}}),l=Rl.newFoundDocument(s,i,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Du(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=$u(e,r.document),i=r.readTime?Ku(r.readTime):Ga.min(),a=Rl.newNoDocument(s,i),o=r.removedTargetIds||[];n=new Du([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=$u(e,r.document),i=r.removedTargetIds||[];n=new Du([],i,s,null)}else{if(!("filter"in t))return sa(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new xu(r,s),a=e.targetId;n=new Ru(a,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ga.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ga.min():t.readTime?Ku(t.readTime):Ga.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=td(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ac(r)?{documents:id(e,r)}:{query:ad(e,r).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Gu(e,t.resumeToken);const r=qu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ga.min())>0){n.readTime=Hu(e,t.snapshotVersion.toTimestamp());const r=qu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return sa(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=td(this.serializer),t.removeTarget=e,this.k_(t)}}class Ch extends Ih{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return aa(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,aa(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){aa(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(aa(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Ku(e.updateTime):Ku(t);return n.isEqual(Ga.min())&&(n=Ku(t)),new eu(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Ku(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=td(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>sd(this.serializer,e))};this.k_(t)}}class Th{}class Ah extends Th{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new ca(la.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,a]=s;return this.connection.Wo(e,Xu(t,n),r,i,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===la.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ca(la.UNKNOWN,e.toString())})}Jo(e,t,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[a,o]=i;return this.connection.Jo(e,Xu(t,n),r,a,o,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===la.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ca(la.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Dh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this._a?(ta(t),this._a=!1):ea("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const Rh="RemoteStore";class Ph{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{qh(this)&&(ea(Rh,"Restarting streams for network reachability change."),await async function(e){const t=oa(e);t.Ia.add(4),await Lh(t),t.Aa.set("Unknown"),t.Ia.delete(4),await Oh(t)}(this))})}),this.Aa=new Dh(n,r)}}async function Oh(e){if(qh(e))for(const t of e.da)await t(!0)}async function Lh(e){for(const t of e.da)await t(!1)}function Mh(e,t){const n=oa(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),Bh(n)?zh(n):cf(n).x_()&&Uh(n,t))}function Fh(e,t){const n=oa(e),r=cf(n);n.Ta.delete(t),r.x_()&&Vh(n,t),0===n.Ta.size&&(r.x_()?r.B_():qh(n)&&n.Aa.set("Unknown"))}function Uh(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ga.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}cf(e).H_(t)}function Vh(e,t){e.Ra.$e(t),cf(e).Y_(t)}function zh(e){e.Ra=new Lu({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),cf(e).start(),e.Aa.aa()}function Bh(e){return qh(e)&&!cf(e).M_()&&e.Ta.size>0}function qh(e){return 0===oa(e).Ia.size}function Hh(e){e.Ra=void 0}async function Gh(e){e.Aa.set("Online")}async function Wh(e){e.Ta.forEach((t,n)=>{Uh(e,t)})}async function Kh(e,t){Hh(e),Bh(e)?(e.Aa.la(t),zh(e)):e.Aa.set("Unknown")}async function Qh(e,t,n){if(e.Aa.set("Online"),t instanceof Pu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ta.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ta.delete(r),e.Ra.removeTarget(r))}(e,t)}catch(n){ea(Rh,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Xh(e,n)}else if(t instanceof Du?e.Ra.Ye(t):t instanceof Ru?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Ga.min()))try{const t=await rh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.Ta.get(r);s&&e.Ta.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ta.get(t);if(!r)return;e.Ta.set(t,r.withResumeToken(Ko.EMPTY_BYTE_STRING,r.snapshotVersion)),Vh(e,t);const s=new vd(r.target,t,n,r.sequenceNumber);Uh(e,s)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){ea(Rh,"Failed to raise snapshot:",t),await Xh(e,t)}}async function Xh(e,t,n){if(!ro(t))throw t;e.Ia.add(1),await Lh(e),e.Aa.set("Offline"),n||(n=()=>rh(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{ea(Rh,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Oh(e)})}function Jh(e,t){return t().catch(n=>Xh(e,n,t))}async function Yh(e){const t=oa(e),n=uf(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:io;for(;$h(t);)try{const e=await ih(t.localStore,r);if(null===e){0===t.Pa.length&&n.B_();break}r=e.batchId,Zh(t,e)}catch(e){await Xh(t,e)}ef(t)&&tf(t)}function $h(e){return qh(e)&&e.Pa.length<10}function Zh(e,t){e.Pa.push(t);const n=uf(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function ef(e){return qh(e)&&!uf(e).M_()&&e.Pa.length>0}function tf(e){uf(e).start()}async function nf(e){uf(e).na()}async function rf(e){const t=uf(e);for(const n of e.Pa)t.X_(n.mutations)}async function sf(e,t,n){const r=e.Pa.shift(),s=vu.from(r,t,n);await Jh(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Yh(e)}async function af(e,t){t&&uf(e).Z_&&await async function(e,t){if(function(e){return Nu(e)&&e!==la.ABORTED}(t.code)){const n=e.Pa.shift();uf(e).N_(),await Jh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Yh(e)}}(e,t),ef(e)&&tf(e)}async function of(e,t){const n=oa(e);n.asyncQueue.verifyOperationInProgress(),ea(Rh,"RemoteStore received new credentials");const r=qh(n);n.Ia.add(3),await Lh(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Oh(n)}async function lf(e,t){const n=oa(e);t?(n.Ia.delete(2),await Oh(n)):t||(n.Ia.add(2),await Lh(n),n.Aa.set("Unknown"))}function cf(e){return e.Va||(e.Va=function(e,t,n){const r=oa(e);return r.ia(),new Eh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:Gh.bind(null,e),e_:Wh.bind(null,e),n_:Kh.bind(null,e),J_:Qh.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),Bh(e)?zh(e):e.Aa.set("Unknown")):(await e.Va.stop(),Hh(e))})),e.Va}function uf(e){return e.ma||(e.ma=function(e,t,n){const r=oa(e);return r.ia(),new Ch(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:nf.bind(null,e),n_:af.bind(null,e),ea:rf.bind(null,e),ta:sf.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await Yh(e)):(await e.ma.stop(),e.Pa.length>0&&(ea(Rh,"Stopping write stream with ".concat(e.Pa.length," pending writes")),e.Pa=[]))})),e.ma}class df{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new ua,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,a=new df(e,t,i,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ca(la.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hf(e,t){if(ta("AsyncQueue","".concat(t,": ").concat(e)),ro(e))return new ca(la.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class ff{static emptySet(e){return new ff(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Da.comparator(t.key,n.key):(e,t)=>Da.comparator(e.key,t.key),this.keyedMap=Ec(),this.sortedSet=new Vo(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ff))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ff;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class mf{constructor(){this.fa=new Vo(Da.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):sa(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class pf{constructor(e,t,n,r,s,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new pf(e,t,ff.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class gf{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class vf{constructor(){this.queries=yf(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=oa(e),r=n.queries;n.queries=yf(),r.forEach((e,n)=>{for(const r of n.wa)r.onError(t)})}(this,new ca(la.ABORTED,"Firestore shutting down"))}}function yf(){return new kc(e=>yc(e),vc)}async function xf(e,t){const n=oa(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.Sa()&&t.ba()&&(r=2):(i=new gf,r=t.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(e){const n=hf(e,"Initialization of query '".concat(xc(t.query),"' failed"));return void t.onError(n)}n.queries.set(s,i),i.wa.push(t),t.va(n.onlineState),i.ya&&t.Ca(i.ya)&&Sf(n)}async function bf(e,t){const n=oa(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.wa.indexOf(t);e>=0&&(i.wa.splice(e,1),0===i.wa.length?s=t.ba()?0:1:!i.Sa()&&t.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wf(e,t){const n=oa(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.wa)e.Ca(s)&&(r=!0);t.ya=s}}r&&Sf(n)}function Nf(e,t,n){const r=oa(e),s=r.queries.get(t);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(t)}function Sf(e){e.Da.forEach(e=>{e.next()})}var kf,jf;(jf=kf||(kf={})).Fa="default",jf.Cache="cache";class _f{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new pf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=pf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==kf.Cache}}class If{constructor(e){this.key=e}}class Ef{constructor(e){this.key=e}}class Cf{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Oc(),this.mutatedKeys=Oc(),this.Xa=Nc(e),this.eu=new ff(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new mf,r=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=bc(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.iu(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Xa(u,o)>0||l&&this.Xa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(i=i.add(u),s=h?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{eu:i,ru:n,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const i=e.ru.pa();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return sa(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),r=null!=r&&r;const a=t&&!r?this.ou():[],o=0===this.Za.size&&this.current&&!r?1:0,l=o!==this.Ya;return this.Ya=o,0!==i.length||l?{snapshot:new pf(this.query,e.eu,s,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new mf,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Oc(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new Ef(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new If(n))}),t}uu(e){this.Ha=e.qs,this.Za=Oc();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return pf.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const Tf="SyncEngine";class Af{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Df{constructor(e){this.key=e,this.lu=!1}}class Rf{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.hu={},this.Pu=new kc(e=>yc(e),vc),this.Tu=new Map,this.Iu=new Set,this.du=new Vo(Da.comparator),this.Eu=new Map,this.Au=new Vd,this.Ru={},this.Vu=new Map,this.mu=_d.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function Pf(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=tm(e);let s;const i=r.Pu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await Lf(r,t,n,!0),s}async function Of(e,t){const n=tm(e);await Lf(n,t,!0,!1)}async function Lf(e,t,n,r){const s=await ah(e.localStore,fc(t)),i=s.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await Mf(e,t,i,"current"===a,s.resumeToken)),e.isPrimaryClient&&n&&Mh(e.remoteStore,s),o}async function Mf(e,t,n,r,s){e.gu=(t,n,r)=>async function(e,t,n,r){let s=t.view.nu(n);s.Ds&&(s=await lh(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.nu(n,s)}));const i=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,i,a);return Xf(e,t.targetId,o._u),o.snapshot}(e,t,n,r);const i=await lh(e.localStore,t,!0),a=new Cf(t,i.qs),o=a.nu(i.documents),l=Au.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),c=a.applyChanges(o,e.isPrimaryClient,l);Xf(e,n,c._u);const u=new Af(t,n,a);return e.Pu.set(t,u),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function Ff(e,t,n){const r=oa(e),s=r.Pu.get(t),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(e=>!vc(e,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await oh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Fh(r.remoteStore,s.targetId),Kf(r,s.targetId)}).catch(eo)):(Kf(r,s.targetId),await oh(r.localStore,s.targetId,!0))}async function Uf(e,t){const n=oa(e),r=n.Pu.get(t),s=n.Tu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Fh(n.remoteStore,r.targetId))}async function Vf(e,t){const n=oa(e);try{const e=await function(e,t){const n=oa(e),r=t.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const a=[];t.targetChanges.forEach((i,o)=>{const l=s.get(o);if(!l)return;a.push(n.hi.removeMatchingKeys(e,i.removedDocuments,o).next(()=>n.hi.addMatchingKeys(e,i.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ko.EMPTY_BYTE_STRING,Ga.min()).withLastLimboFreeSnapshotVersion(Ga.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),s=s.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,i)&&a.push(n.hi.updateTargetData(e,c))});let o=_c(),l=Oc();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(sh(e,i,t.documentUpdates).next(e=>{o=e.Ls,l=e.ks})),!r.isEqual(Ga.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return to.waitFor(a).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Fs=s,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Eu.get(t);r&&(aa(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.lu=!0:e.modifiedDocuments.size>0?aa(r.lu,14607):e.removedDocuments.size>0&&(aa(r.lu,42227),r.lu=!1))}),await $f(n,e,t)}catch(e){await eo(e)}}function zf(e,t,n){const r=oa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Pu.forEach((n,r)=>{const s=r.view.va(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=oa(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.wa)s.va(t)&&(r=!0)}),r&&Sf(n)}(r.eventManager,t),e.length&&r.hu.J_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Bf(e,t,n){const r=oa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Eu.get(t),i=s&&s.key;if(i){let e=new Vo(Da.comparator);e=e.insert(i,Rl.newNoDocument(i,Ga.min()));const n=Oc().add(i),s=new Tu(Ga.min(),new Map,new Vo(Na),e,n);await Vf(r,s),r.du=r.du.remove(i),r.Eu.delete(t),Yf(r)}else await oh(r.localStore,t,!1).then(()=>Kf(r,t,n)).catch(eo)}async function qf(e,t){const n=oa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=oa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let a=to.resolve();return i.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);aa(null!==i,48541),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Oc();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Wf(n,r,null),Gf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $f(n,e)}catch(e){await eo(e)}}async function Hf(e,t,n){const r=oa(e);try{const e=await function(e,t){const n=oa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(aa(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Wf(r,t,n),Gf(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await $f(r,e)}catch(n){await eo(n)}}function Gf(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function Wf(e,t,n){const r=oa(e);let s=r.Ru[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Ru[r.currentUser.toKey()]=s}}function Kf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||Qf(e,t)})}function Qf(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Fh(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),Yf(e))}function Xf(e,t,n){for(const r of n)r instanceof If?(e.Au.addReference(r.key,t),Jf(e,r)):r instanceof Ef?(ea(Tf,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||Qf(e,r.key)):sa(19791,{yu:r})}function Jf(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(ea(Tf,"New document in limbo: "+n),e.Iu.add(r),Yf(e))}function Yf(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new Da(Ca.fromString(t)),r=e.mu.next();e.Eu.set(r,new Df(n)),e.du=e.du.insert(n,r),Mh(e.remoteStore,new vd(fc(cc(n.path)),r,"TargetPurposeLimboResolution",so.ue))}}async function $f(e,t,n){const r=oa(e),s=[],i=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((e,o)=>{a.push(r.gu(o,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const s=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,s?"current":"not-current")}if(e){s.push(e);const t=Jd.Es(o.targetId,e);i.push(t)}}))}),await Promise.all(a),r.hu.J_(s),await async function(e,t){const n=oa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>to.forEach(t,t=>to.forEach(t.Is,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>to.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!ro(e))throw e;ea(Zd,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Fs.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(e,s)}}}(r.localStore,i))}async function Zf(e,t){const n=oa(e);if(!n.currentUser.isEqual(t)){ea(Tf,"User change. New user:",t.toKey());const e=await nh(n.localStore,t);n.currentUser=t,function(e,t){e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new ca(la.CANCELLED,t))})}),e.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await $f(n,e.Bs)}}function em(e,t){const n=oa(e),r=n.Eu.get(t);if(r&&r.lu)return Oc().add(r.key);{let e=Oc();const r=n.Tu.get(t);if(!r)return e;for(const t of r){const r=n.Pu.get(t);e=e.unionWith(r.view.tu)}return e}}function tm(e){const t=oa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Vf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=em.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Bf.bind(null,t),t.hu.J_=wf.bind(null,t.eventManager),t.hu.pu=Nf.bind(null,t.eventManager),t}function nm(e){const t=oa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=qf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Hf.bind(null,t),t}class rm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return th(this.persistence,new $d,e.initialUser,this.serializer)}Du(e){return new Wd(Qd.Vi,this.serializer)}bu(e){return new dh}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rm.provider={build:()=>new rm};class sm extends rm{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){aa(this.persistence.referenceDelegate instanceof Xd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ad(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?jd.withCacheSize(this.cacheSizeBytes):jd.DEFAULT;return new Wd(e=>Xd.Vi(e,t),this.serializer)}}class im{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>zf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Zf.bind(null,this.syncEngine),await lf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new vf}createDatastore(e){const t=kh(e.databaseInfo.databaseId),n=function(e){return new Nh(e)}(e.databaseInfo);return function(e,t,n,r){return new Ah(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Ph(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>zf(this.syncEngine,e,0),mh.C()?new mh:new hh)}createSyncEngine(e,t){return function(e,t,n,r,s,i,a){const o=new Rf(e,t,n,r,s,i);return a&&(o.fu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=oa(e);ea(Rh,"RemoteStore shutting down."),t.Ia.add(5),await Lh(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}im.provider={build:()=>new im};class am{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ta("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class om{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ca(la.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=oa(e),r={documents:t.map(e=>Yu(n.serializer,e))},s=await n.Jo("BatchGetDocuments",n.serializer.databaseId,Ca.emptyPath(),r,t.length),i=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){aa(!!t.found,43571),t.found.name,t.found.updateTime;const n=$u(e,t.found.name),r=Ku(t.found.updateTime),s=t.found.createTime?Ku(t.found.createTime):Ga.min(),i=new Al({mapValue:{fields:t.found.fields}});return Rl.newFoundDocument(n,r,s,i)}(e,t):"missing"in t?function(e,t){aa(!!t.missing,3894),aa(!!t.readTime,22933);const n=$u(e,t.missing),r=Ku(t.readTime);return Rl.newNoDocument(n,r)}(e,t):sa(7234,{result:t})}(n.serializer,e);i.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=i.get(e.toString());aa(!!t,55234,{key:e}),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new mu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=Da.fromPath(t);this.mutations.push(new pu(n,this.precondition(n)))}),await async function(e,t){const n=oa(e),r={writes:t.map(e=>sd(n.serializer,e))};await n.Wo("Commit",n.serializer.databaseId,Ca.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw sa(50498,{Wu:e.constructor.name});t=Ga.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ca(la.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ga.min())?tu.exists(!1):tu.updateTime(t):tu.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ga.min()))throw new ca(la.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tu.updateTime(t)}return tu.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class lm{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.Gu=n.maxAttempts,this.F_=new jh(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new om(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Hu(e)}))}).catch(e=>{this.Hu(e)})})}Ju(e){try{const t=this.updateFunction(e);return!ao(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Nu(t)}return!1}}const cm="FirestoreClient";class um{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ji.UNAUTHENTICATED,this.clientId=wa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async e=>{ea(cm,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(ea(cm,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ua;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=hf(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function dm(e,t){e.asyncQueue.verifyOperationInProgress(),ea(cm,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await nh(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>{na("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{ea("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{na("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function hm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await fm(e);ea(cm,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>of(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>of(t.remoteStore,n)),e._onlineComponents=t}async function fm(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ea(cm,"Using user provided OfflineComponentProvider");try{await dm(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===la.FAILED_PRECONDITION||e.code===la.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;na("Error using user provided cache. Falling back to memory cache: "+n),await dm(e,new rm)}}else ea(cm,"Using default OfflineComponentProvider"),await dm(e,new sm(void 0));return e._offlineComponents}async function mm(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ea(cm,"Using user provided OnlineComponentProvider"),await hm(e,e._uninitializedComponentsProvider._online)):(ea(cm,"Using default OnlineComponentProvider"),await hm(e,new im))),e._onlineComponents}function pm(e){return mm(e).then(e=>e.syncEngine)}function gm(e){return mm(e).then(e=>e.datastore)}async function vm(e){const t=await mm(e),n=t.eventManager;return n.onListen=Pf.bind(null,t.syncEngine),n.onUnlisten=Ff.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Of.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Uf.bind(null,t.syncEngine),n}function ym(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ua;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,s){const i=new am({next:o=>{i.Ou(),t.enqueueAndForget(()=>bf(e,a));const l=o.docs.has(n);!l&&o.fromCache?s.reject(new ca(la.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?s.reject(new ca(la.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(o)},error:e=>s.reject(e)}),a=new _f(cc(n.path),i,{includeMetadataChanges:!0,ka:!0});return xf(e,a)}(await vm(e),e.asyncQueue,t,n,r)),r.promise}function xm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ua;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,s){const i=new am({next:n=>{i.Ou(),t.enqueueAndForget(()=>bf(e,a)),n.fromCache&&"server"===r.source?s.reject(new ca(la.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),a=new _f(n,i,{includeMetadataChanges:!0,ka:!0});return xf(e,a)}(await vm(e),e.asyncQueue,t,n,r)),r.promise}function bm(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wm=new Map,Nm="firestore.googleapis.com",Sm=!0;class km{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new ca(la.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Nm,this.ssl=Sm}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Sm;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=kd;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ed)throw new ca(la.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new ca(la.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bm(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ca(la.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new ca(la.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new ca(la.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jm{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new km({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ca(la.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ca(la.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new km(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ha;switch(e.type){case"firstParty":return new ga(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ca(la.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wm.get(e);t&&(ea("ComponentProvider","Removing Datastore"),wm.delete(e),t.terminate())}(this),Promise.resolve()}}function _m(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s;e=Fa(e,jm);const i=me(t),a=e._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(n);i&&(pe("https://".concat(l)),ye("Firestore",!0)),a.host!==Nm&&a.host!==l&&na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},a),{host:l,ssl:i,emulatorOptions:r});if(!_e(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ji.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ae(JSON.stringify({alg:"none",type:"JWT"})),ae(JSON.stringify(i)),""].join(".")}(r.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new ca(la.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ji(i)}e._authCredentials=new fa(new da(t,n))}}class Im{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Im(this.firestore,e,this._query)}}class Em{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cm(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Em(this.firestore,e,this._key)}toJSON(){return{type:Em._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(za(t,Em._jsonSchema))return new Em(e,n||null,new Da(Ca.fromString(t.referencePath)))}}Em._jsonSchemaVersion="firestore/documentReference/1.0",Em._jsonSchema={type:Va("string",Em._jsonSchemaVersion),referencePath:Va("string")};class Cm extends Im{constructor(e,t,n){super(e,t,cc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Em(this.firestore,null,new Da(e))}withConverter(e){return new Cm(this.firestore,e,this._path)}}function Tm(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=Re(e),Ra("collection","path",t),e instanceof jm){const n=Ca.fromString(t,...r);return Oa(n),new Cm(e,null,n)}{if(!(e instanceof Em||e instanceof Cm))throw new ca(la.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ca.fromString(t,...r));return Oa(n),new Cm(e.firestore,null,n)}}function Am(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=Re(e),1===arguments.length&&(t=wa.newId()),Ra("doc","path",t),e instanceof jm){const n=Ca.fromString(t,...r);return Pa(n),new Em(e,null,new Da(n))}{if(!(e instanceof Em||e instanceof Cm))throw new ca(la.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ca.fromString(t,...r));return Pa(n),new Em(e.firestore,e instanceof Cm?e.converter:null,new Da(n))}}const Dm="AsyncQueue";class Rm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new jh(this,"async_queue_retry"),this.oc=()=>{const e=Sh();e&&ea(Dm,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=Sh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Sh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new ua;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!ro(e))throw e;ea(Dm,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,ta("INTERNAL UNHANDLED ERROR: ",Pm(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=df.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(r),r}ac(){this.tc&&sa(47125,{hc:Pm(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Pm(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Om(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Lm extends jm{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Rm,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rm(e),this._firestoreClient=void 0,await e}}}function Mm(e){if(e._terminated)throw new ca(la.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Fm(e),e._firestoreClient}function Fm(e){var t,n,r;const s=e._freezeSettings(),i=function(e,t,n,r){return new il(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bm(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new um(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Um{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Um(Ko.fromBase64String(e))}catch(e){throw new ca(la.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Um(Ko.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Um._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(za(e,Um._jsonSchema))return Um.fromBase64String(e.bytes)}}Um._jsonSchemaVersion="firestore/bytes/1.0",Um._jsonSchema={type:Va("string",Um._jsonSchemaVersion),bytes:Va("string")};class Vm{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new ca(la.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Aa(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zm{constructor(e){this._methodName=e}}class Bm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ca(la.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ca(la.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Na(this._lat,e._lat)||Na(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bm._jsonSchemaVersion}}static fromJSON(e){if(za(e,Bm._jsonSchema))return new Bm(e.latitude,e.longitude)}}Bm._jsonSchemaVersion="firestore/geoPoint/1.0",Bm._jsonSchema={type:Va("string",Bm._jsonSchemaVersion),latitude:Va("number"),longitude:Va("number")};class qm{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qm._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(za(e,qm._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new qm(e.vectorValues);throw new ca(la.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qm._jsonSchemaVersion="firestore/vectorValue/1.0",qm._jsonSchema={type:Va("string",qm._jsonSchemaVersion),vectorValues:Va("object")};const Hm=/^__.*__$/;class Gm{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new uu(e,this.data,this.fieldMask,t,this.fieldTransforms):new cu(e,this.data,t,this.fieldTransforms)}}class Wm{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new uu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Km(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw sa(40011,{Ec:e})}}class Qm{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Qm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return hp(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(Km(this.Ec)&&Hm.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Xm{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||kh(e)}Dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Qm({Ec:e,methodName:t,bc:n,path:Aa.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jm(e){const t=e._freezeSettings(),n=kh(e._databaseId);return new Xm(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ym(e,t,n,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Dc(i.merge||i.mergeFields?2:0,t,n,s);lp("Data must be an object, but it was:",a,r);const o=ap(r,a);let l,c;if(i.merge)l=new Go(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=cp(t,r,n);if(!a.contains(s))throw new ca(la.INVALID_ARGUMENT,"Field '".concat(s,"' is specified in your field mask but missing from your input data."));fp(e,s)||e.push(s)}l=new Go(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Gm(new Al(o),l,c)}class $m extends zm{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.wc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $m}}function Zm(e,t,n){return new Qm({Ec:3,bc:t.settings.bc,methodName:e._methodName,mc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class ep extends zm{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Zm(this,e,!0),n=this.vc.map(e=>ip(e,t)),r=new Wc(n);return new Zc(e.path,r)}isEqual(e){return e instanceof ep&&_e(this.vc,e.vc)}}class tp extends zm{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){const t=new Jc(e.serializer,Vc(e.serializer,this.Cc));return new Zc(e.path,t)}isEqual(e){return e instanceof tp&&this.Cc===e.Cc}}function np(e,t,n,r){const s=e.Dc(1,t,n);lp("Data must be an object, but it was:",s,r);const i=[],a=Al.empty();Fo(r,(e,r)=>{const o=dp(t,e,n);r=Re(r);const l=s.gc(o);if(r instanceof $m)i.push(o);else{const e=ip(r,l);null!=e&&(i.push(o),a.set(o,e))}});const o=new Go(i);return new Wm(a,o,s.fieldTransforms)}function rp(e,t,n,r,s,i){const a=e.Dc(1,t,n),o=[cp(t,r,n)],l=[s];if(i.length%2!=0)throw new ca(la.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let h=0;h<i.length;h+=2)o.push(cp(t,i[h])),l.push(i[h+1]);const c=[],u=Al.empty();for(let h=o.length-1;h>=0;--h)if(!fp(c,o[h])){const e=o[h];let t=l[h];t=Re(t);const n=a.gc(e);if(t instanceof $m)c.push(e);else{const r=ip(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new Go(c);return new Wm(u,d,a.fieldTransforms)}function sp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ip(n,e.Dc(r?4:3,t))}function ip(e,t){if(op(e=Re(e)))return lp("Unsupported field value:",t,e),ap(e,t);if(e instanceof zm)return function(e,t){if(!Km(t.Ec))throw t.wc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.wc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=ip(s,t.yc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Re(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Vc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ha.fromDate(e);return{timestampValue:Hu(t.serializer,n)}}if(e instanceof Ha){const n=new Ha(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Hu(t.serializer,n)}}if(e instanceof Bm)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Um)return{bytesValue:Gu(t.serializer,e._byteString)};if(e instanceof Em){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.wc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Qu(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof qm)return function(e,t){return{mapValue:{fields:{[ll]:{stringValue:dl},[hl]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.wc("VectorValues must only contain numeric values.");return Fc(t.serializer,e)})}}}}}}(e,t);throw t.wc("Unsupported field value: ".concat(Ma(e)))}(e,t)}function ap(e,t){const n={};return Uo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Fo(e,(e,r)=>{const s=ip(r,t.Vc(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function op(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ha||e instanceof Bm||e instanceof Um||e instanceof Em||e instanceof zm||e instanceof qm)}function lp(e,t,n){if(!op(n)||!La(n)){const r=Ma(n);throw"an object"===r?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function cp(e,t,n){if((t=Re(t))instanceof Vm)return t._internalPath;if("string"==typeof t)return dp(e,t);throw hp("Field path arguments must be of type string or ",e,!1,void 0,n)}const up=new RegExp("[~\\*/\\[\\]]");function dp(e,t,n){if(t.search(up)>=0)throw hp("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Vm(...t.split("."))._internalPath}catch(r){throw hp("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function hp(e,t,n,r,s){const i=r&&!r.isEmpty(),a=void 0!==s;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(s)),l+=")"),new ca(la.INVALID_ARGUMENT,o+e+l)}function fp(e,t){return e.some(e=>e.isEqual(t))}class mp{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Em(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new pp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class pp extends mp{data(){return super.data()}}function gp(e,t){return"string"==typeof t?dp(e,t):t instanceof Vm?t._internalPath:t._delegate._internalPath}function vp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ca(la.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yp{}class xp extends yp{}function bp(e,t){let n=[];for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];t instanceof yp&&n.push(t),n=n.concat(s),function(e){const t=e.filter(e=>e instanceof Sp).length,n=e.filter(e=>e instanceof wp).length;if(t>1||t>0&&n>0)throw new ca(la.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class wp extends xp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new wp(e,t,n)}_apply(e){const t=this._parse(e);return Tp(e._query,t),new Im(e.firestore,e.converter,pc(e._query,t))}_parse(e){const t=Jm(e.firestore),n=function(e,t,n,r,s,i,a){let o;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new ca(la.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){Cp(a,i);const t=[];for(const n of a)t.push(Ep(r,e,n));o={arrayValue:{values:t}}}else o=Ep(r,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Cp(a,i),o=sp(n,t,a,"in"===i||"not-in"===i);return Vl.create(s,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Np(e,t,n){const r=t,s=gp("where",e);return wp._create(s,r,n)}class Sp extends yp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Sp(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:zl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)Tp(n,s),n=pc(n,s)}(e._query,t),new Im(e.firestore,e.converter,pc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class kp extends xp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new kp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ca(la.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ca(la.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ml(t,n)}(e._query,this._field,this._direction);return new Im(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new oc(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function jp(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=gp("orderBy",e);return kp._create(n,t)}class _p extends xp{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new _p(e,t,n)}_apply(e){return new Im(e.firestore,e.converter,gc(e._query,this._limit,this._limitType))}}function Ip(e){return Ua("limit",e),_p._create("limit",e,"F")}function Ep(e,t,n){if("string"==typeof(n=Re(n))){if(""===n)throw new ca(la.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dc(t)&&-1!==n.indexOf("/"))throw new ca(la.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(Ca.fromString(n));if(!Da.isDocumentKey(r))throw new ca(la.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Nl(e,new Da(r))}if(n instanceof Em)return Nl(e,n._key);throw new ca(la.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Ma(n),"."))}function Cp(e,t){if(!Array.isArray(e)||0===e.length)throw new ca(la.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Tp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ca(la.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new ca(la.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Ap{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(fl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw sa(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Fo(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const s=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[hl].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>Jo(e.doubleValue));return new qm(s)}convertGeoPoint(e){return new Bm(Jo(e.latitude),Jo(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=rl(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(sl(e));default:return null}}convertTimestamp(e){const t=Xo(e);return new Ha(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ca.fromString(e);aa(gd(n),9688,{name:e});const r=new ol(n.get(1),n.get(3)),s=new Da(n.popFirst(5));return r.isEqual(t)||ta("Document ".concat(s," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),s}}function Dp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Rp extends Ap{constructor(e){super(),this.firestore=e}convertBytes(e){return new Um(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Em(this.firestore,null,t)}}class Pp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Op extends mp{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Lp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(gp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ca(la.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Op._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Op._jsonSchemaVersion="firestore/documentSnapshot/1.0",Op._jsonSchema={type:Va("string",Op._jsonSchemaVersion),bundleSource:Va("string","DocumentSnapshot"),bundleName:Va("string"),bundle:Va("string")};class Lp extends Op{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Mp{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pp(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Lp(this._firestore,this._userDataWriter,n.key,n,new Pp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ca(la.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Lp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Pp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Lp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Pp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:Fp(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ca(la.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Mp._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wa.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Fp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return sa(61501,{type:e})}}function Up(e){e=Fa(e,Em);const t=Fa(e.firestore,Lm);return ym(Mm(t),e._key).then(n=>Kp(t,e,n))}Mp._jsonSchemaVersion="firestore/querySnapshot/1.0",Mp._jsonSchema={type:Va("string",Mp._jsonSchemaVersion),bundleSource:Va("string","QuerySnapshot"),bundleName:Va("string"),bundle:Va("string")};class Vp extends Ap{constructor(e){super(),this.firestore=e}convertBytes(e){return new Um(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Em(this.firestore,null,t)}}function zp(e){e=Fa(e,Im);const t=Fa(e.firestore,Lm),n=Mm(t),r=new Vp(t);return vp(e._query),xm(n,e._query).then(n=>new Mp(t,r,e,n))}function Bp(e,t,n){e=Fa(e,Em);const r=Fa(e.firestore,Lm),s=Dp(e.converter,t,n);return Wp(r,[Ym(Jm(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,tu.none())])}function qp(e,t,n){e=Fa(e,Em);const r=Fa(e.firestore,Lm),s=Jm(r);let i;for(var a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return i="string"==typeof(t=Re(t))||t instanceof Vm?rp(s,"updateDoc",e._key,t,n,o):np(s,"updateDoc",e._key,t),Wp(r,[i.toMutation(e._key,tu.exists(!0))])}function Hp(e){return Wp(Fa(e.firestore,Lm),[new mu(e._key,tu.none())])}function Gp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s,i,a;e=Re(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Om(n[l])||(o=n[l++]);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Om(n[l])){const e=n[l];n[l]=null===(s=e.next)||void 0===s?void 0:s.bind(e),n[l+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),n[l+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let u,d,h;if(e instanceof Em)d=Fa(e.firestore,Lm),h=cc(e._key.path),u={next:t=>{n[l]&&n[l](Kp(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Fa(e,Im);d=Fa(t.firestore,Lm),h=t._query;const r=new Vp(d);u={next:e=>{n[l]&&n[l](new Mp(d,r,t,e))},error:n[l+1],complete:n[l+2]},vp(e._query)}return function(e,t,n,r){const s=new am(r),i=new _f(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>xf(await vm(e),i)),()=>{s.Ou(),e.asyncQueue.enqueueAndForget(async()=>bf(await vm(e),i))}}(Mm(d),h,c,u)}function Wp(e,t){return function(e,t){const n=new ua;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=nm(e);try{const e=await function(e,t){const n=oa(e),r=Ha.now(),s=t.reduce((e,t)=>e.add(t.key),Oc());let i,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=_c(),l=Oc();return n.Os.getEntries(e,s).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(s=>{i=s;const a=[];for(const e of t){const t=ou(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new uu(e.key,t,Dl(t.value.mapValue),tu.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:Cc(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ru[e.currentUser.toKey()];r||(r=new Vo(Na)),r=r.insert(t,n),e.Ru[e.currentUser.toKey()]=r}(r,e.batchId,n),await $f(r,e.changes),await Yh(r.remoteStore)}catch(e){const t=hf(e,"Failed to persist write");n.reject(t)}}(await pm(e),t,n)),n.promise}(Mm(e),t)}function Kp(e,t,n){const r=n.docs.get(t._key),s=new Vp(e);return new Op(e,s,t._key,r,new Pp(n.hasPendingWrites,n.fromCache),t.converter)}const Qp={maxAttempts:5};function Xp(e,t){if((e=Re(e)).firestore!==t)throw new ca(la.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Jp{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jm(e)}get(e){const t=Xp(e,this._firestore),n=new Rp(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return sa(24041);const r=e[0];if(r.isFoundDocument())return new mp(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new mp(this._firestore,n,t._key,null,t.converter);throw sa(18433,{doc:r})})}set(e,t,n){const r=Xp(e,this._firestore),s=Dp(r.converter,t,n),i=Ym(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,i),this}update(e,t,n){const r=Xp(e,this._firestore);let s;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];return s="string"==typeof(t=Re(t))||t instanceof Vm?rp(this._dataReader,"Transaction.update",r._key,t,n,a):np(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,s),this}delete(e){const t=Xp(e,this._firestore);return this._transaction.delete(t._key),this}}class Yp extends Jp{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Xp(e,this._firestore),n=new Vp(this._firestore);return super.get(e).then(e=>new Op(this._firestore,n,t._key,e._document,new Pp(!1,!1),t.converter))}}function $p(e,t,n){e=Fa(e,Lm);const r=Object.assign(Object.assign({},Qp),n);return function(e){if(e.maxAttempts<1)throw new ca(la.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new ua;return e.asyncQueue.enqueueAndForget(async()=>{const s=await gm(e);new lm(e.asyncQueue,s,n,t,r).zu()}),r.promise}(Mm(e),n=>t(new Yp(e,n)),r)}function Zp(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ep("arrayUnion",t)}function eg(e){return new tp("increment",e)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Yi=e}(Qt),qt(new Pe("firestore",(e,n)=>{let{instanceIdentifier:r,options:s}=n;const i=e.getProvider("app").getImmediate(),a=new Lm(new ma(e.getProvider("auth-internal")),new ya(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ca(la.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ol(e.options.projectId,t)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Yt(Qi,Xi,e),Yt(Qi,Xi,"esm2017")}();const tg=h("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),ng="folios",rg="folio_line_items",sg="invoices",ig="invoice_counters",ag="audit_logs",og="folio_payments",lg="FOLIO-BAR-",cg="FOLIO-ROOM-",ug="FLI-",dg="INV-",hg="LOG-",fg="PAY-";function mg(e){return"artifacts/".concat(e,"/public/data")}function pg(e){return"".concat(e).concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,8))}function gg(){return(new Date).getFullYear()}function vg(){return(new Date).toISOString()}function yg(e,t){return"F-".concat(e,"-").concat(String(t).padStart(5,"0"))}function xg(e,t){return"INV-".concat(e,"-").concat(String(t).padStart(5,"0"))}async function bg(e,t){const n=gg(),r=Am(e,mg(t),"folio_counters",String(n));try{const e=await Up(r);if(e.exists()){const t=e.data().lastNumber+1;return await qp(r,{lastNumber:t}),t}return await Bp(r,{year:n,lastNumber:1,prefix:"F-".concat(n,"-")}),1}catch(s){return console.error("[FolioService] Error incrementing folio counter:",s),Date.now()%1e5}}async function wg(e,t,n){let{action:r,entityType:s,entityId:i,userId:a,userName:o,userRole:l="staff",previousState:c=null,newState:u,isOfflineAction:d=!1}=n;try{var h;const n=mg(t),f=pg(hg);await Bp(Am(e,n,ag,f),{logId:f,timestamp:vg(),action:r,entityType:s,entityId:i,userId:a,userName:o,userRole:l,previousState:c,newState:u,ipAddress:null,deviceInfo:(null===(h=navigator)||void 0===h?void 0:h.userAgent)||null,isOfflineAction:d}),console.log("[Audit] ".concat(r," on ").concat(s,":").concat(i," by ").concat(o))}catch(f){console.error("[FolioService] Audit log failed:",f)}}async function Ng(e,t,n){let{v1SalesId:r,items:s,subtotal:i,total:a,paymentMethod:o,roomId:l=null,serviceCenter:c,staffId:u,staffName:d,customerName:h="Walk-in Customer"}=n;const f=mg(t),m=vg(),p=gg();try{const n="".concat(lg).concat(r),o=yg(p,await bg(e,t)),g={folioId:n,folioNumber:o,folioType:"BAR",status:"CLOSED",createdAt:m,closedAt:m,voidedAt:null,ownerId:null,ownerName:h,ownerContact:null,roomId:l,roomNumber:null,checkInDate:null,checkOutDate:null,nightsBooked:null,adults:null,children:null,subtotal:i,discountTotal:0,taxTotal:0,grandTotal:a,amountPaid:a,paymentStatus:"PAID",createdBy:u,createdByName:d,closedBy:u,closedByName:d,v1LinkedRecords:{salesIds:[r],checkoutId:null,roomId:l},invoiceId:null,invoiceNumber:null,serviceCenter:c,notes:null};await Bp(Am(e,f,ng,n),g),console.log("[FolioService] Created BAR folio: ".concat(n));const v=[];for(let t=0;t<s.length;t++){const i=s[t],a="".concat(ug).concat(Date.now(),"-").concat(t),o={itemId:a,folioId:n,createdAt:m,description:i.name,itemType:"kitchen"===i.type?"FOOD":"DRINK",quantity:i.qty,unitPrice:i.price,subtotal:i.qty*i.price,discountAmount:0,discountReason:null,discountRuleId:null,taxAmount:0,taxRate:0,totalAmount:i.qty*i.price,staffId:u,staffName:d,category:i.category||"POS",v1SalesId:r,v1MenuItemId:i.id||null,paymentMethod:null,paymentReference:null,sourceModule:"POS",isOfflineCreated:!1,syncedAt:m,isLocked:!0};await Bp(Am(e,f,rg,a),o),v.push(a)}console.log("[FolioService] Created ".concat(v.length," line items for folio ").concat(n));const y=await async function(e,t,n,r,s,i,a){const o=mg(t),l=vg();try{return await $p(e,async t=>{var c,u;const d=gg(),h=Am(e,o,ig,String(d)),f=await t.get(h);let m;f.exists()?(m=f.data().lastNumber+1,t.update(h,{lastNumber:m})):(m=1,t.set(h,{year:d,lastNumber:1,prefix:"INV-".concat(d,"-")}));const p="".concat(dg).concat(Date.now()),g=xg(d,m),v=s.map(e=>({description:e.name,quantity:e.qty,unitPrice:e.price,subtotal:e.qty*e.price,discountAmount:0,taxAmount:0,totalAmount:e.qty*e.price,category:e.category||"POS"})),y={invoiceId:p,invoiceNumber:g,folioId:n,folioNumber:r.folioNumber,folioType:"BAR",issuedAt:l,dueDate:null,customerName:r.ownerName||"Walk-in Customer",customerContact:null,customerAddress:null,roomNumber:null,checkInDate:null,checkOutDate:null,lineItems:v,subtotal:r.subtotal,discountTotal:0,taxTotal:0,grandTotal:r.grandTotal,amountPaid:r.grandTotal,amountDue:0,paymentStatus:"PAID",paymentMethod:null,issuedBy:i,issuedByName:a,serviceCenter:r.serviceCenter,v1CheckoutId:null,v1SalesIds:[null===(c=r.v1LinkedRecords)||void 0===c||null===(u=c.salesIds)||void 0===u?void 0:u[0]].filter(Boolean),printCount:0,lastPrintedAt:null,emailedTo:null,hash:null};return t.set(Am(e,o,sg,p),y),{invoiceId:p,invoiceNumber:g}})}catch(c){return console.error("[FolioService] Error creating invoice:",c),null}}(e,t,n,g,s,u,d);return y&&await qp(Am(e,f,ng,n),{invoiceId:y.invoiceId,invoiceNumber:y.invoiceNumber}),await wg(e,t,{action:"FOLIO_CREATE",entityType:"FOLIO",entityId:n,userId:u,userName:d,newState:{folioId:n,folioType:"BAR",status:"CLOSED",total:a}}),{folioId:n,folioNumber:o,invoiceId:null===y||void 0===y?void 0:y.invoiceId,invoiceNumber:null===y||void 0===y?void 0:y.invoiceNumber,lineItemIds:v}}catch(g){return console.error("[FolioService] Error creating BAR folio:",g),null}}async function Sg(e,t,n){let{roomId:r,roomNumber:s,roomType:i,roomPrice:a,guestName:o,guestContact:l=null,nightsBooked:c,adults:u,children:d,staffId:h,staffName:f}=n;const m=mg(t),p=vg(),g=gg();try{const n="".concat(cg).concat(Date.now()),v=yg(g,await bg(e,t)),y=c*a,x={folioId:n,folioNumber:v,folioType:"ROOM",status:"OPEN",createdAt:p,closedAt:null,voidedAt:null,ownerId:null,ownerName:o,ownerContact:l,roomId:r,roomNumber:s,checkInDate:p,checkOutDate:null,nightsBooked:c,adults:u,children:d,subtotal:y,discountTotal:0,taxTotal:0,grandTotal:y,amountPaid:0,paymentStatus:"UNPAID",createdBy:h,createdByName:f,closedBy:null,closedByName:null,v1LinkedRecords:{salesIds:[],checkoutId:null,roomId:r},invoiceId:null,invoiceNumber:null,serviceCenter:null,notes:null};await Bp(Am(e,m,ng,n),x),console.log("[FolioService] Created ROOM folio: ".concat(n));const b="".concat(ug).concat(Date.now(),"-room"),w={itemId:b,folioId:n,createdAt:p,description:"Room Charge - ".concat(s," (").concat(i,")"),itemType:"ROOM_CHARGE",quantity:c,unitPrice:a,subtotal:y,discountAmount:0,discountReason:null,discountRuleId:null,taxAmount:0,taxRate:0,totalAmount:y,staffId:h,staffName:f,category:"Accommodation",v1SalesId:null,v1MenuItemId:null,paymentMethod:null,paymentReference:null,sourceModule:"RECEPTION",isOfflineCreated:!1,syncedAt:p,isLocked:!1};return await Bp(Am(e,m,rg,b),w),console.log("[FolioService] Created room charge line item: ".concat(b)),await wg(e,t,{action:"FOLIO_CREATE",entityType:"FOLIO",entityId:n,userId:h,userName:f,newState:{folioId:n,folioType:"ROOM",status:"OPEN",roomNumber:s,guestName:o}}),{folioId:n,folioNumber:v,roomChargeItemId:b}}catch(v){return console.error("[FolioService] Error creating ROOM folio:",v),null}}async function kg(e,t,n){let{folioId:r,description:s,itemType:i,quantity:a,unitPrice:o,category:l,staffId:c,staffName:u,v1SalesId:d=null,v1MenuItemId:h=null,sourceModule:f="POS",discountAmount:m=0,discountReason:p=null}=n;const g=mg(t),v=vg();try{var y,x;const n=Am(e,g,ng,r),b=await Up(n);if(!b.exists())return console.error("[FolioService] Folio not found: ".concat(r)),null;const w=b.data();if("OPEN"!==w.status&&"PART_PAID"!==w.status)return console.error("[FolioService] Cannot add to ".concat(w.status," folio: ").concat(r)),null;const N=pg(ug),S=a*o,k=S-m,j={itemId:N,folioId:r,createdAt:v,description:s,itemType:i,quantity:a,unitPrice:o,subtotal:S,discountAmount:m,discountReason:p,discountRuleId:null,taxAmount:0,taxRate:0,totalAmount:k,staffId:c,staffName:u,category:l,v1SalesId:d,v1MenuItemId:h,paymentMethod:null,paymentReference:null,sourceModule:f,isOfflineCreated:!1,syncedAt:v,isLocked:!1};return await Bp(Am(e,g,rg,N),j),await qp(n,{subtotal:eg(S),discountTotal:eg(m),grandTotal:eg(k),"v1LinkedRecords.salesIds":d?[...(null===(y=w.v1LinkedRecords)||void 0===y?void 0:y.salesIds)||[],d]:(null===(x=w.v1LinkedRecords)||void 0===x?void 0:x.salesIds)||[]}),console.log("[FolioService] Added line item ".concat(N," to folio ").concat(r)),await wg(e,t,{action:"LINE_ITEM_ADD",entityType:"LINE_ITEM",entityId:N,userId:c,userName:u,newState:{itemId:N,folioId:r,description:s,totalAmount:k}}),{itemId:N,totalAmount:k}}catch(b){return console.error("[FolioService] Error adding line item:",b),null}}async function jg(e,t,n){const r=mg(t);try{const t=bp(Tm(e,r,ng),Np("roomId","==",n),Np("status","==","OPEN"),Np("folioType","==","ROOM")),s=await zp(t);if(s.empty)return null;const i=s.docs[0];return c({id:i.id},i.data())}catch(s){return console.error("[FolioService] Error finding active folio:",s),null}}async function _g(e,t,n,r){const s=mg(t);try{const t=Am(e,s,"sales",n);return await qp(t,{folioId:r,isLinkedToFolio:!0,linkedAt:vg()}),console.log("[FolioService] Linked Sales ".concat(n," to Folio ").concat(r)),!0}catch(i){return console.error("[FolioService] Error linking sales to folio:",i),!1}}async function Ig(e,t,n){let{serviceCenter:r,staffId:s,staffName:i,tableOrLabel:a}=n;const o=mg(t),l=vg(),u=gg();try{const n="".concat(lg).concat(Date.now()),d=yg(u,await bg(e,t)),h={folioId:n,folioNumber:d,folioType:"BAR",status:"OPEN",createdAt:l,closedAt:null,voidedAt:null,ownerId:null,ownerName:a||"Order ".concat(d),ownerContact:null,roomId:null,roomNumber:null,subtotal:0,discountTotal:0,taxTotal:0,grandTotal:0,amountPaid:0,paymentStatus:"UNPAID",createdBy:s,createdByName:i,closedBy:null,closedByName:null,v1LinkedRecords:{salesIds:[]},invoiceId:null,serviceCenter:r,notes:null};return await Bp(Am(e,o,ng,n),h),await wg(e,t,{action:"ORDER_OPEN",entityType:"FOLIO",entityId:n,userId:s,userName:i,newState:{folioId:n,status:"OPEN",table:a}}),c(c({},h),{},{id:n})}catch(d){return console.error("[FolioService] Error creating Open Bar Folio:",d),null}}async function Eg(e,t,n){let{folioId:r,amount:s,method:i,reference:a=null,staffId:o,staffName:l}=n;const c=mg(t),u=vg();try{return await $p(e,async t=>{const n=Am(e,c,ng,r),d=await t.get(n);if(!d.exists())throw new Error("Folio not found");const h=d.data();if("OPEN"!==h.status&&"PART_PAID"!==h.status)throw new Error("Cannot pay settled order (Status: ".concat(h.status,")"));const f=pg(fg),m=Am(e,c,og,f),p={paymentId:f,folioId:r,amount:Number(s),method:i,reference:a,createdAt:u,createdBy:o,createdByName:l};t.set(m,p);const g=(h.amountPaid||0)+Number(s),v=h.grandTotal-g;let y=h.status,x="PARTIAL",b=null,w=null,N=null;return v<=0?(y="CLOSED",x=g>h.grandTotal?"OVERPAID":"PAID",b=u,w=o,N=l):g>0&&(y="PART_PAID"),t.update(n,{amountPaid:g,paymentStatus:x,status:y,closedAt:b,closedBy:w,closedByName:N,updatedAt:u}),{paymentId:f,newStatus:y,balance:Math.max(0,v),paymentStatus:x}})}catch(d){return console.error("[FolioService] Payment failed:",d),null}}async function Cg(e,t,n){let{folioId:r,paymentMethod:s,amountPaid:i,staffId:a,staffName:o,v1CheckoutId:l=null}=n;const c=mg(t),u=vg();try{const n=Am(e,c,ng,r),d=await Up(n);if(!d.exists())return console.error("[FolioService] Folio not found: ".concat(r)),null;const h=d.data();if("OPEN"!==h.status)return console.error("[FolioService] Folio already ".concat(h.status,": ").concat(r)),null;const f=bp(Tm(e,c,rg),Np("folioId","==",r)),m=await zp(f),p=m.docs.map(e=>e.data()),g=h.grandTotal;let v="UNPAID";i>=g?v=i>g?"OVERPAID":"PAID":i>0&&(v="PARTIAL");const y=await $p(e,async t=>{var d;const f=gg(),m=Am(e,c,ig,String(f)),y=await t.get(m);let x;y.exists()?(x=y.data().lastNumber+1,t.update(m,{lastNumber:x})):(x=1,t.set(m,{year:f,lastNumber:1,prefix:"INV-".concat(f,"-")}));const b="".concat(dg).concat(Date.now()),w=xg(f,x),N=p.map(e=>({description:e.description,quantity:e.quantity,unitPrice:e.unitPrice,subtotal:e.subtotal,discountAmount:e.discountAmount||0,taxAmount:e.taxAmount||0,totalAmount:e.totalAmount,category:e.category})),S={invoiceId:b,invoiceNumber:w,folioId:r,folioNumber:h.folioNumber,folioType:h.folioType,issuedAt:u,dueDate:null,customerName:h.ownerName,customerContact:h.ownerContact,customerAddress:null,roomNumber:h.roomNumber,checkInDate:h.checkInDate,checkOutDate:u,lineItems:N,subtotal:h.subtotal,discountTotal:h.discountTotal,taxTotal:h.taxTotal,grandTotal:h.grandTotal,amountPaid:i,amountDue:Math.max(0,g-i),paymentStatus:"OVERPAID"===v?"PAID":v,paymentMethod:s,issuedBy:a,issuedByName:o,serviceCenter:h.serviceCenter,v1CheckoutId:l,v1SalesIds:(null===(d=h.v1LinkedRecords)||void 0===d?void 0:d.salesIds)||[],printCount:0,lastPrintedAt:null,emailedTo:null,hash:null};return t.set(Am(e,c,sg,b),S),t.update(n,{status:"CLOSED",closedAt:u,checkOutDate:u,amountPaid:i,paymentStatus:v,closedBy:a,closedByName:o,invoiceId:b,invoiceNumber:w,"v1LinkedRecords.checkoutId":l}),{invoiceId:b,invoiceNumber:w}});console.log("[FolioService] Closed folio ".concat(r,", created invoice ").concat(y.invoiceNumber));for(const t of m.docs)await qp(Am(e,c,rg,t.id),{isLocked:!0});return await wg(e,t,{action:"FOLIO_CLOSE",entityType:"FOLIO",entityId:r,userId:a,userName:o,previousState:{status:"OPEN"},newState:{status:"CLOSED",invoiceNumber:y.invoiceNumber}}),await wg(e,t,{action:"INVOICE_CREATE",entityType:"INVOICE",entityId:y.invoiceId,userId:a,userName:o,newState:{invoiceNumber:y.invoiceNumber,grandTotal:g}}),y}catch(d){return console.error("[FolioService] Error closing folio:",d),null}}async function Tg(e,t,n){let{folioId:r,reason:s,staffId:i,staffName:a}=n;const o=mg(t),l=vg();try{const n=Am(e,o,ng,r),c=await Up(n);if(!c.exists())return console.error("[FolioService] Folio not found: ".concat(r)),!1;const u=c.data();if("OPEN"!==u.status)return console.error("[FolioService] Cannot void ".concat(u.status," folio: ").concat(r)),!1;await qp(n,{status:"VOIDED",voidedAt:l,closedBy:i,closedByName:a,notes:"VOIDED: ".concat(s)});const d=bp(Tm(e,o,rg),Np("folioId","==",r)),h=await zp(d);for(const t of h.docs)await qp(Am(e,o,rg,t.id),{isLocked:!0});return await wg(e,t,{action:"FOLIO_VOID",entityType:"FOLIO",entityId:r,userId:i,userName:a,previousState:{status:"OPEN"},newState:{status:"VOIDED",reason:s}}),console.log("[FolioService] Voided folio ".concat(r,": ").concat(s)),!0}catch(c){return console.error("[FolioService] Error voiding folio:",c),!1}}async function Ag(e,t,n,r,s,i){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;try{if(console.log("[v2] Processing BAR order. Folio Mode:",o?"APPEND":"CREATE"),o){const i=n.items||[];for(const a of i)await kg(e,t,{folioId:o,description:a.name,itemType:"kitchen"===a.type?"FOOD":"DRINK",quantity:a.qty,unitPrice:a.price,category:a.category||"POS",staffId:r,staffName:s,v1SalesId:n.id,v1MenuItemId:a.id,sourceModule:"POS"});return await _g(e,t,n.id,o),{folioId:o,status:"UPDATED"}}const l=await Ng(e,t,{v1SalesId:n.id,items:n.items||[],subtotal:n.subtotal||n.total,total:n.total,paymentMethod:n.paymentMethod||n.method||"CASH",roomId:a,serviceCenter:i,staffId:r,staffName:s,customerName:a?"Room ".concat(a):"Walk-in Customer"});return l&&console.log("[v2] Created BAR folio:",l.folioId,"Invoice:",l.invoiceNumber),l}catch(l){return console.error("[v2] Error creating BAR folio:",l),null}}async function Dg(e,t,n,r,s,i){try{const a=await jg(e,t,n);if(!a)return console.warn("[v2] No active folio found for room:",n),null;console.log("[v2] Adding line item to folio:",a.folioId);const o=(r.items||[]).map(e=>"".concat(e.name).concat(e.qty>1?" x".concat(e.qty):"")).join(", "),l=await kg(e,t,{folioId:a.folioId,description:"POS: ".concat(o||"Order"),itemType:"BAR_ORDER",quantity:1,unitPrice:r.total,category:"POS",staffId:s,staffName:i,v1SalesId:r.id,sourceModule:"POS"});return l&&console.log("[v2] Added line item:",l.itemId,"to folio:",a.folioId),l}catch(a){return console.error("[v2] Error adding room charge:",a),null}}async function Rg(e,t,n,r,s,i){try{console.log("[v2] Creating ROOM folio for check-in:",n.number);const o=await Sg(e,t,{roomId:n.id,roomNumber:n.number,roomType:n.type,roomPrice:n.price,guestName:r.name,guestContact:r.contact||null,nightsBooked:r.nightsBooked||1,adults:r.adults||1,children:r.children||0,staffId:s,staffName:i});if(o){console.log("[v2] Created ROOM folio:",o.folioId);try{localStorage.setItem("v2_active_folio_".concat(n.id),o.folioId)}catch(a){}}return o}catch(o){return console.error("[v2] Error creating ROOM folio:",o),null}}async function Pg(e,t,n,r,s,i,a){try{const o=await jg(e,t,n);if(!o)return console.warn("[v2] No active folio found for room:",n),null;console.log("[v2] Adding laundry charge to folio:",o.folioId);const l=await kg(e,t,{folioId:o.folioId,description:"Laundry: ".concat(r),itemType:"LAUNDRY",quantity:1,unitPrice:s,category:"Laundry",staffId:i,staffName:a,sourceModule:"RECEPTION"});return l&&console.log("[v2] Added laundry charge:",l.itemId),l}catch(o){return console.error("[v2] Error adding laundry charge:",o),null}}async function Og(e,t,n,r,s,i,a){try{const l=await jg(e,t,n);if(!l)return console.warn("[v2] No active folio found for room:",n),null;console.log("[v2] Closing ROOM folio and creating invoice:",l.folioId);const c=await Cg(e,t,{folioId:l.folioId,paymentMethod:r.paymentMethod||"CASH",amountPaid:r.amountPaid||r.total||l.grandTotal,staffId:i,staffName:a,v1CheckoutId:s});if(c){console.log("[v2] Created invoice:",c.invoiceNumber,"for folio:",l.folioId);try{localStorage.removeItem("v2_active_folio_".concat(n))}catch(o){}}return c}catch(l){return console.error("[v2] Error closing folio:",l),null}}async function Lg(e,t,n){try{console.log("[v2] Creating folio for synced offline transaction:",n.id);return await Ng(e,t,{v1SalesId:n.id,items:n.items||[],subtotal:n.subtotal||n.total,total:n.total,paymentMethod:n.paymentMethod||n.method||"CASH",roomId:n.roomId||null,serviceCenter:n.serviceCenter||"general",staffId:n.staffId||"unknown",staffName:n.staffName||"Unknown Staff",customerName:n.roomId?"Room ".concat(n.roomId):"Walk-in Customer"})}catch(r){return console.error("[v2] Error syncing offline transaction:",r),null}}function Mg(){return"true"!==localStorage.getItem("v2_folio_disabled")}function Fg(e,t,n,s,i,a){const[o,l]=(0,r.useState)([]),{lineItems:u,loading:d}=function(e,t,n){const[s,i]=(0,r.useState)(null),[a,o]=(0,r.useState)([]),[l,u]=(0,r.useState)(!0),[d,h]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!n)return i(null),o([]),void u(!1);u(!0);const r=Gp(Am(e,"artifacts",t,"public","data","folios",n),e=>{e.exists()?i(c(c({},e.data()),{},{id:e.id})):i(null)},e=>{console.error("Error fetching folio doc:",e),h(e)}),s=Gp(bp(Tm(e,"artifacts",t,"public","data","folio_line_items"),Np("folioId","==",n),jp("createdAt","asc")),e=>{const t=e.docs.map(e=>c(c({},e.data()),{},{id:e.id}));o(t),u(!1)},e=>{console.error("Error fetching line items:",e),u(!1)});return()=>{r(),s()}},[e,t,n]),{folio:s,lineItems:a,loading:l,error:d}}(e,t,n);(0,r.useEffect)(()=>{if(!d&&u){const e={};u.forEach(t=>{const n=t.v1MenuItemId||t.id;e[n]||(e[n]={id:n,name:t.description,price:t.unitPrice,qty:0,category:t.category,type:"FOOD"===t.itemType?"kitchen":"bar"}),e[n].qty+=t.quantity}),l(Object.values(e))}},[u,d]);return{cart:o,addToCart:async r=>{const o={id:"TX-PARTIAL-".concat(Date.now()),items:[c(c({},r),{},{qty:1})],total:r.price,status:"pending"};await Ag(e,t,o,s,i,null===a||void 0===a?void 0:a.id,null,n)},clearCart:()=>{},isFolioMode:!0,setCart:()=>{}}}var Ug=n(579);const Vg=e=>{let{db:t,appId:n,department:s,staffName:i,onSelectTicket:a,onBack:o}=e;const{folios:l,loading:u}=function(e,t,n){const[s,i]=(0,r.useState)([]),[a,o]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!n)return i([]),void o(!1);const r=Gp(bp(Tm(e,"artifacts",t,"public","data","folios"),Np("serviceCenter","==",n),Np("status","in",["OPEN","PART_PAID"])),e=>{const t=e.docs.map(e=>c(c({},e.data()),{},{id:e.id}));t.sort((e,t)=>t.createdAt.localeCompare(e.createdAt)),i(t),o(!1)},e=>{console.error("Error fetching open folios:",e),o(!1)});return()=>r()},[e,t,n]),{folios:s,loading:a}}(t,n,null===s||void 0===s?void 0:s.id),[d,h]=(0,r.useState)(!1),[f,m]=(0,r.useState)("");return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white p-4 border-b flex justify-between items-center shadow-sm",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ug.jsx)("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-600",children:"Back"}),(0,Ug.jsxs)("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[(0,Ug.jsx)(x,{size:24,className:"text-blue-600"}),null===s||void 0===s?void 0:s.name," - Open Tickets"]})]}),(0,Ug.jsx)("div",{className:"text-sm text-slate-500",children:i})]}),(0,Ug.jsx)("div",{className:"flex-1 p-6 overflow-y-auto",children:(0,Ug.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,Ug.jsx)("div",{className:"mb-8",children:(0,Ug.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),f.trim()){h(!0);try{const e=await Ig(t,n,{serviceCenter:s.id,staffId:"staff_id_ph",staffName:i,tableOrLabel:f});e&&a(e)}catch(r){console.error("Failed to create ticket",r),alert("Error creating ticket")}finally{h(!1)}}},className:"flex gap-4 max-w-2xl",children:[(0,Ug.jsx)("input",{type:"text",placeholder:"New Ticket Name (e.g. Table 5, James)",className:"flex-1 p-4 rounded-xl border border-slate-300 shadow-sm focus:ring-2 focus:ring-blue-500 outline-none text-lg",value:f,onChange:e=>m(e.target.value),autoFocus:!0}),(0,Ug.jsxs)("button",{type:"submit",disabled:d||!f,className:"bg-blue-600 text-white px-8 rounded-xl font-bold hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 shadow-md transition-all active:scale-95",children:[(0,Ug.jsx)(K,{size:24}),d?"Creating...":"New Ticket"]})]})}),u?(0,Ug.jsx)("div",{className:"text-center py-10 text-slate-500",children:"Loading open tickets..."}):(0,Ug.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[0===l.length&&(0,Ug.jsxs)("div",{className:"col-span-full text-center py-10 bg-white rounded-xl border border-dashed border-slate-300",children:[(0,Ug.jsx)("div",{className:"text-slate-400 mb-2",children:"No open tickets"}),(0,Ug.jsx)("div",{className:"text-sm text-slate-500",children:"Create a new ticket above to start taking orders."})]}),l.map(e=>(0,Ug.jsxs)("button",{onClick:()=>a(e),className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-blue-400 transition-all text-left flex flex-col justify-between h-40 group relative overflow-hidden",children:[(0,Ug.jsx)("div",{className:"absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition-opacity",children:(0,Ug.jsx)(W,{size:64})}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,Ug.jsx)("span",{className:"font-bold text-lg text-slate-800 break-words w-full pr-6 leading-tight",children:e.ownerName}),"PART_PAID"===e.status&&(0,Ug.jsx)("span",{className:"bg-amber-100 text-amber-700 text-xs px-2 py-1 rounded-full font-bold absolute top-3 right-3",children:"PART PAID"})]}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500 flex items-center gap-1 mt-1",children:[(0,Ug.jsx)(G,{size:12}),new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),(0,Ug.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-100 flex justify-between items-end",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"text-xs text-slate-400 uppercase font-semibold",children:"Total"}),(0,Ug.jsx)("div",{className:"font-bold text-xl text-slate-700",children:(e.grandTotal||0).toLocaleString()})]}),(0,Ug.jsx)("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors",children:(0,Ug.jsx)(tg,{size:20})})]})]},e.id))]})]})})]})},zg=[{id:"brk_1",name:"Spanish Omelette",price:15e3,category:"Breakfast",type:"kitchen"},{id:"brk_2",name:"Fried Eggs (Pair)",price:8e3,category:"Breakfast",type:"kitchen"},{id:"brk_3",name:"Poached Eggs",price:8e3,category:"Breakfast",type:"kitchen"},{id:"brk_4",name:"Scrambled Eggs",price:8e3,category:"Breakfast",type:"kitchen"},{id:"brk_5",name:"Full English Breakfast",price:35e3,category:"Breakfast",type:"kitchen"},{id:"brk_6",name:"African Tea (Pot)",price:1e4,category:"Breakfast",type:"kitchen"},{id:"soup_1",name:"Clear Vegetable Soup",price:1e4,category:"Soups",type:"kitchen"},{id:"soup_2",name:"Cream of Mushroom",price:15e3,category:"Soups",type:"kitchen"},{id:"soup_3",name:"Chicken Soup",price:18e3,category:"Soups",type:"kitchen"},{id:"start_1",name:"Chefs Caesar Salad",price:25e3,category:"Starters",type:"kitchen"},{id:"start_2",name:"Chicken Salad",price:25e3,category:"Starters",type:"kitchen"},{id:"start_3",name:"Garden Salad",price:15e3,category:"Starters",type:"kitchen"},{id:"snk_1",name:"Beef Samosas (Pair)",price:5e3,category:"Snacks",type:"kitchen"},{id:"snk_2",name:"Chicken Wings (6pcs)",price:2e4,category:"Snacks",type:"kitchen"},{id:"snk_3",name:"Plain Chips (Fries)",price:8e3,category:"Snacks",type:"kitchen"},{id:"snk_4",name:"Masala Chips",price:12e3,category:"Snacks",type:"kitchen"},{id:"snk_5",name:"Club Sandwich",price:25e3,category:"Snacks",type:"kitchen"},{id:"snk_6",name:"Beef Burger",price:25e3,category:"Snacks",type:"kitchen"},{id:"main_1",name:"Pepper Steak",price:35e3,category:"Main Course",type:"kitchen"},{id:"main_2",name:"Grilled Tilapia Fillet",price:35e3,category:"Main Course",type:"kitchen"},{id:"main_3",name:"Grilled Chicken Breast",price:35e3,category:"Main Course",type:"kitchen"},{id:"main_4",name:"Pork Chops",price:35e3,category:"Main Course",type:"kitchen"},{id:"main_5",name:"Mixed Grill Platter",price:55e3,category:"Main Course",type:"kitchen"},{id:"main_6",name:"Fish & Chips",price:3e4,category:"Main Course",type:"kitchen"},{id:"it_1",name:"Spaghetti Bolognaise",price:28e3,category:"Pizza & Pasta",type:"kitchen"},{id:"it_2",name:"Pizza Margherita",price:25e3,category:"Pizza & Pasta",type:"kitchen"},{id:"it_3",name:"Pizza Chicken",price:35e3,category:"Pizza & Pasta",type:"kitchen"},{id:"afr_1",name:"Matooke & G-Nut Sauce",price:15e3,category:"African",type:"kitchen"},{id:"afr_2",name:"Local Chicken Stew",price:35e3,category:"African",type:"kitchen"},{id:"afr_3",name:"Goat Pilau",price:25e3,category:"African",type:"kitchen"},{id:"des_1",name:"Fruit Salad",price:1e4,category:"Desserts",type:"kitchen"},{id:"des_2",name:"Ice Cream (2 Scoops)",price:8e3,category:"Desserts",type:"kitchen"},{id:"juice_1",name:"Fresh Passion Juice",price:8e3,category:"Fresh Juices",type:"bar",stock_open:0},{id:"juice_2",name:"Fresh Watermelon",price:8e3,category:"Fresh Juices",type:"bar",stock_open:0},{id:"beer1",name:"Nile Special",price:5e3,category:"Beers & Sodas",type:"bar",stock_open:48},{id:"beer2",name:"Club Pilsner",price:5e3,category:"Beers & Sodas",type:"bar",stock_open:48},{id:"soda1",name:"Soda (300ml)",price:3e3,category:"Beers & Sodas",type:"bar",stock_open:72},{id:"wtr1",name:"Mineral Water (500ml)",price:2e3,category:"Beers & Sodas",type:"bar",stock_open:100},{id:"alc1",name:"Uganda Waragi (750ml)",price:3e4,category:"Spirits",type:"bar",stock_open:10},{id:"alc2",name:"Jameson (750ml)",price:18e4,category:"Spirits",type:"bar",stock_open:8},{id:"hc1",name:"Deep Tissue Massage",price:8e4,category:"Health Club",type:"service"},{id:"hc2",name:"Sauna/Steam",price:2e4,category:"Health Club",type:"service"},{id:"pl1",name:"Swimming (Adult)",price:2e4,category:"Pool",type:"service"},{id:"ld1",name:"Wash & Iron (Shirt)",price:5e3,category:"FO Laundry",type:"fo_service",department:"fo"},{id:"ld2",name:"Wash & Iron (Trousers)",price:6e3,category:"FO Laundry",type:"fo_service",department:"fo"},{id:"ld3",name:"Wash & Iron (Dress)",price:8e3,category:"FO Laundry",type:"fo_service",department:"fo"},{id:"ld4",name:"Wash & Iron (Suit)",price:15e3,category:"FO Laundry",type:"fo_service",department:"fo"},{id:"ld5",name:"Dry Clean (Suit)",price:25e3,category:"FO Laundry",type:"fo_service",department:"fo"},{id:"ld6",name:"Ironing Only (per piece)",price:2e3,category:"FO Laundry",type:"fo_service",department:"fo"}],Bg=e=>{let{db:t,appId:n}=e;const[s,i]=(0,r.useState)(!1),[a,o]=(0,r.useState)({total:0,current:0}),[l,u]=(0,r.useState)("idle");return(0,Ug.jsxs)("button",{onClick:async()=>{if(!window.confirm("This will sync ".concat(zg.length," menu items to the database. Existing items with same IDs will be updated. Continue?")))return;i(!0),u("syncing"),o({total:zg.length,current:0});let e=[];try{for(const s of zg)try{await Bp(Am(t,"artifacts",n,"public","data","menuItems",s.id),s),o(e=>c(c({},e),{},{current:e.current+1}))}catch(r){console.error("Failed to sync item ".concat(s.id,":"),r),e.push("".concat(s.name,": ").concat(r.message))}e.length>0?(alert("Sync complete with ".concat(e.length," errors:\n").concat(e.join("\n"))),u("error")):u("success")}catch(r){console.error("Critical sync error:",r),alert("Sync failed: "+r.message),u("error")}finally{i(!1),setTimeout(()=>u("idle"),5e3)}},disabled:s,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-blue-500 group transition-all relative overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ug.jsx)(te,{className:"text-slate-600 group-hover:text-blue-500 ".concat(s?"animate-spin text-blue-600":""),size:24}),"success"===l&&(0,Ug.jsx)(Y,{size:20,className:"text-emerald-500"}),"error"===l&&(0,Ug.jsx)(V,{size:20,className:"text-amber-500"})]}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-blue-600",children:s?"Syncing ".concat(a.current,"/").concat(a.total,"..."):"Sync Menu Data"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:s?"Updating Firestore...":"Push code menu to DB"}),s&&(0,Ug.jsx)("div",{className:"absolute bottom-0 left-0 h-1 bg-blue-100 w-full",children:(0,Ug.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-200",style:{width:"".concat(a.current/a.total*100,"%")}})})]})};async function qg(e,t){console.log("\n============================================"),console.log("\ud83e\uddea SGHMS V2 FOLIO SYSTEM TESTS"),console.log("============================================\n");const n={passed:0,failed:0,tests:[]},r="test_staff_001",s="Test Staff",i="artifacts/".concat(t,"/public/data"),a=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.tests.push({name:e,passed:t,details:r}),t?(n.passed++,console.log("\u2705 ".concat(e))):(n.failed++,console.log("\u274c ".concat(e,": ").concat(r)))};try{console.log("\n\ud83d\udce6 Test 1: Create BAR Folio");const y={id:"TX-TEST-".concat(Date.now()),items:[{id:"beer1",name:"Nile Special",qty:2,price:5e3,type:"bar",category:"Beers"},{id:"soda1",name:"Soda (300ml)",qty:1,price:3e3,type:"bar",category:"Drinks"}],subtotal:13e3,total:13e3,paymentMethod:"CASH"},x=await Ng(e,t,{v1SalesId:y.id,items:y.items,subtotal:y.subtotal,total:y.total,paymentMethod:y.paymentMethod,roomId:null,serviceCenter:"bar_main",staffId:r,staffName:s,customerName:"Test Walk-in"});if(x){var o,l;a("BAR folio created",!0),a("BAR folio has invoiceNumber",!!x.invoiceNumber),a("BAR folio has lineItemIds",2===(null===(o=x.lineItemIds)||void 0===o?void 0:o.length));const t=await Up(Am(e,i,"folios",x.folioId));if(a("BAR folio exists in Firestore",t.exists()),a("BAR folio status is CLOSED","CLOSED"===(null===(l=t.data())||void 0===l?void 0:l.status)),x.invoiceId){var u;const t=await Up(Am(e,i,"invoices",x.invoiceId));a("Invoice exists in Firestore",t.exists()),a("Invoice has correct grandTotal",(null===(u=t.data())||void 0===u?void 0:u.grandTotal)===y.total)}}else a("BAR folio created",!1,"createBarFolio returned null");console.log("\n\ud83d\udecf\ufe0f Test 2: Create ROOM Folio");const{room:b,guest:w}={room:{id:"rm_test_".concat(Date.now()),number:"TEST-101",type:"Deluxe Double",price:14e4},guest:{name:"Test Guest",contact:"+256700123456",nightsBooked:2,adults:2,children:0}},N=await Sg(e,t,{roomId:b.id,roomNumber:b.number,roomType:b.type,roomPrice:b.price,guestName:w.name,guestContact:w.contact,nightsBooked:w.nightsBooked,adults:w.adults,children:w.children,staffId:r,staffName:s});if(N){var d,h;a("ROOM folio created",!0),a("ROOM folio has roomChargeItemId",!!N.roomChargeItemId);const t=await Up(Am(e,i,"folios",N.folioId));a("ROOM folio exists in Firestore",t.exists()),a("ROOM folio status is OPEN","OPEN"===(null===(d=t.data())||void 0===d?void 0:d.status)),a("ROOM folio grandTotal correct",(null===(h=t.data())||void 0===h?void 0:h.grandTotal)===b.price*w.nightsBooked)}else a("ROOM folio created",!1,"createRoomFolio returned null");if(console.log("\n\ud83d\udd0d Test 3: Find Active Folio for Room"),N){const n=await jg(e,t,b.id);a("Found active folio for room",null!==n),a("Active folio ID matches",(null===n||void 0===n?void 0:n.folioId)===N.folioId)}if(console.log("\n\u2795 Test 4: Add Line Item to Folio"),N){const n=await kg(e,t,{folioId:N.folioId,description:"POS: Test Bar Order",itemType:"BAR_ORDER",quantity:1,unitPrice:25e3,category:"POS",staffId:r,staffName:s,v1SalesId:"TX-TEST-123",sourceModule:"POS"});if(n){var f;a("Line item added",!0),a("Line item has itemId",!!n.itemId);const t=await Up(Am(e,i,"folios",N.folioId)),r=b.price*w.nightsBooked+25e3;a("Folio grandTotal updated",(null===(f=t.data())||void 0===f?void 0:f.grandTotal)===r)}else a("Line item added",!1,"addLineItemToFolio returned null")}if(console.log("\n\ud83d\udccb Test 5: Close Folio and Create Invoice"),N){const n=await Cg(e,t,{folioId:N.folioId,paymentMethod:"CASH",amountPaid:b.price*w.nightsBooked+25e3,staffId:r,staffName:s,v1CheckoutId:"CO-TEST-123"});if(n){var m,p;a("Folio closed",!0),a("Invoice created",!!n.invoiceNumber);const t=await Up(Am(e,i,"folios",N.folioId));a("Folio status is CLOSED","CLOSED"===(null===(m=t.data())||void 0===m?void 0:m.status)),a("Folio has invoiceNumber",(null===(p=t.data())||void 0===p?void 0:p.invoiceNumber)===n.invoiceNumber)}else a("Folio closed",!1,"closeFolioAndCreateInvoice returned null")}console.log("\n\ud83d\udd22 Test 6: Invoice Counter Sequence");const S=(new Date).getFullYear(),k=await Up(Am(e,i,"invoice_counters",String(S)));var g;if(a("Invoice counter exists",k.exists()),k.exists())a("Counter lastNumber >= 2",(null===(g=k.data())||void 0===g?void 0:g.lastNumber)>=2);console.log("\n\ud83d\udcdc Test 7: Audit Logs Created");const j=bp(Tm(e,i,"audit_logs"),jp("timestamp","desc")),_=await zp(j);a("Audit logs exist",!_.empty),a("At least 4 audit entries",_.size>=4),console.log("\n\ud83d\udeab Test 8: Void Folio");const I=c(c({},b),{},{id:"rm_void_test_".concat(Date.now())}),E=await Sg(e,t,c(c({},I),{},{roomId:I.id,roomNumber:"VOID-TEST",roomType:"Test",roomPrice:1e5,guestName:"Void Test Guest",guestContact:null,nightsBooked:1,adults:1,children:0,staffId:r,staffName:s}));if(E){var v;a("Folio voided",await Tg(e,t,{folioId:E.folioId,reason:"Test void",staffId:r,staffName:s}));a("Voided folio status is VOIDED","VOIDED"===(null===(v=(await Up(Am(e,i,"folios",E.folioId))).data())||void 0===v?void 0:v.status))}return console.log("\n============================================"),console.log("\ud83d\udcca TEST SUMMARY"),console.log("============================================"),console.log("\u2705 Passed: ".concat(n.passed)),console.log("\u274c Failed: ".concat(n.failed)),console.log("\ud83d\udce6 Total:  ".concat(n.passed+n.failed)),console.log("============================================\n"),0===n.failed?console.log("\ud83c\udf89 All tests passed! V2 folio system is working correctly."):console.log("\u26a0\ufe0f Some tests failed. Review the output above."),n}catch(y){return console.error("\u274c Test execution error:",y),c(c({},n),{},{error:y.message})}}async function Hg(e,t){console.log("\n\ud83e\uddf9 Cleaning up test data...");const n="artifacts/".concat(t,"/public/data");try{const t=bp(Tm(e,n,"folios"),Np("ownerName","==","Test Walk-in")),r=await zp(t);for(const e of r.docs)await Hp(e.ref),console.log("  Deleted folio: ".concat(e.id));const s=bp(Tm(e,n,"folios"),Np("ownerName","in",["Test Guest","Void Test Guest"])),i=await zp(s);for(const e of i.docs)await Hp(e.ref),console.log("  Deleted folio: ".concat(e.id));console.log("\u2705 Cleanup complete")}catch(r){console.error("\u274c Cleanup error:",r)}}function Gg(e,t){"undefined"!==typeof window&&(window.testV2Folio=()=>qg(e,t),window.cleanupV2Tests=()=>Hg(e,t),console.log("\n\ud83d\udccb V2 Folio Test Runner Loaded"),console.log("   Run tests:    window.testV2Folio()"),console.log("   Cleanup:      window.cleanupV2Tests()"))}const Wg=e=>{let{db:t,appId:n,roomId:s}=e;const{activeFolio:i,loading:a}=function(e,t,n){const[s,i]=(0,r.useState)(null),[a,o]=(0,r.useState)(!0),[l,u]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!n)return i(null),void o(!1);o(!0);const r=Gp(bp(Tm(e,"artifacts",t,"public","data","folios"),Np("roomId","==",n),Np("status","==","OPEN"),jp("createdAt","desc"),Ip(1)),e=>{if(e.empty)i(null);else{const t=e.docs[0].data();i(c(c({},t),{},{id:e.docs[0].id}))}o(!1)},e=>{console.error("Error fetching active folio:",e),u(e),o(!1)});return()=>r()},[e,t,n]),{activeFolio:s,loading:a,error:l}}(t,n,s);return a?(0,Ug.jsx)("span",{className:"text-xs text-slate-400 animate-pulse",children:"Checking folio..."}):i?(0,Ug.jsxs)("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1.5 rounded-full border border-blue-200 text-sm font-medium",children:[(0,Ug.jsx)(F,{size:14}),(0,Ug.jsxs)("span",{children:["V2 Folio: ",i.folioId.split("-").slice(2).join("-")]}),(0,Ug.jsx)("span",{className:"text-xs bg-blue-200 px-1.5 rounded text-blue-800",children:"OPEN"}),(0,Ug.jsxs)("span",{className:"text-xs text-slate-500 font-mono ml-1",children:["(",null===(o=i.grandTotal)||void 0===o?void 0:o.toLocaleString()," UGX)"]})]}):(0,Ug.jsxs)("div",{className:"flex items-center gap-1 text-slate-400 text-xs",title:"No V2 Folio active",children:[(0,Ug.jsx)(X,{size:12}),(0,Ug.jsx)("span",{children:"Legacy Mode"})]});var o},Kg=h("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Qg=h("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Xg=e=>null!==e&&void 0!==e&&e.includes("CREATE")?"bg-emerald-500":null!==e&&void 0!==e&&e.includes("VOID")?"bg-red-500":null!==e&&void 0!==e&&e.includes("ADD")?"bg-blue-500":null!==e&&void 0!==e&&e.includes("CLOSE")?"bg-amber-500":"bg-slate-500",Jg=e=>{let{db:t,appId:n}=e;const[s,i]=(0,r.useState)(!1),{invoices:a,auditLogs:o,loading:l}=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const[s,i]=(0,r.useState)([]),[a,o]=(0,r.useState)([]),[l,u]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{const r=bp(Tm(e,"artifacts",t,"public","data","invoices"),jp("createdAt","desc"),Ip(n)),s=bp(Tm(e,"artifacts",t,"public","data","audit_logs"),jp("timestamp","desc"),Ip(n)),a=Gp(r,e=>{i(e.docs.map(e=>c(c({},e.data()),{},{id:e.id})))}),l=Gp(s,e=>{o(e.docs.map(e=>c(c({},e.data()),{},{id:e.id}))),u(!1)});return()=>{a(),l()}},[e,t,n]),{invoices:s,auditLogs:a,loading:l}}(t,n,10);return s?(0,Ug.jsxs)("div",{className:"fixed bottom-4 right-4 w-96 bg-slate-900 text-slate-300 rounded-xl shadow-2xl border border-slate-700 z-50 flex flex-col max-h-[80vh]",children:[(0,Ug.jsxs)("div",{className:"p-3 border-b border-slate-700 flex justify-between items-center bg-slate-800 rounded-t-xl cursor-pointer",onClick:()=>i(!1),children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)(Kg,{size:18,className:"text-blue-400"}),(0,Ug.jsx)("h3",{className:"font-bold text-white",children:"V2 System Activity"})]}),(0,Ug.jsx)(Qg,{size:18})]}),(0,Ug.jsx)("div",{className:"overflow-y-auto p-0 flex-1 custom-scrollbar text-xs",children:l?(0,Ug.jsx)("div",{className:"p-4 text-center animate-pulse",children:"Loading stream..."}):(0,Ug.jsxs)("div",{className:"flex flex-col",children:[(0,Ug.jsxs)("div",{className:"p-2 bg-slate-800/50 font-bold text-blue-300 sticky top-0 backdrop-blur-sm border-b border-slate-700 flex items-center gap-2",children:[(0,Ug.jsx)(F,{size:14})," Recent Invoices"]}),0===a.length?(0,Ug.jsx)("div",{className:"p-4 text-slate-500 italic text-center",children:"No invoices yet"}):a.map(e=>(0,Ug.jsxs)("div",{className:"p-3 border-b border-slate-800 hover:bg-slate-800/50 transition-colors",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,Ug.jsx)("span",{className:"font-bold text-white tracking-wide",children:e.invoiceNumber}),(0,Ug.jsx)("span",{className:"text-emerald-400 font-mono",children:(e.grandTotal||0).toLocaleString()})]}),(0,Ug.jsxs)("div",{className:"flex justify-between items-end",children:[(0,Ug.jsxs)("div",{className:"text-slate-500 text-[10px] space-y-0.5",children:[(0,Ug.jsx)("div",{children:new Date(e.createdAt).toLocaleString()}),(0,Ug.jsx)("div",{children:e.customerName||"Walk-in"})]}),(0,Ug.jsx)("span",{className:"bg-slate-800 px-1.5 py-0.5 rounded text-[10px] uppercase",children:e.paymentMethod})]})]},e.id)),(0,Ug.jsxs)("div",{className:"p-2 bg-slate-800/50 font-bold text-amber-300 sticky top-0 backdrop-blur-sm border-y border-slate-700 flex items-center gap-2 mt-2",children:[(0,Ug.jsx)(v,{size:14})," System Audit Stream"]}),0===o.length?(0,Ug.jsx)("div",{className:"p-4 text-slate-500 italic text-center",children:"No logs yet"}):o.map((e,t)=>{var n;return(0,Ug.jsxs)("div",{className:"p-3 border-b border-slate-800 hover:bg-slate-800/50 transition-colors",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,Ug.jsx)("span",{className:"w-1.5 h-1.5 rounded-full ".concat(Xg(e.action))}),(0,Ug.jsx)("span",{className:"font-bold text-slate-200",children:null===(n=e.action)||void 0===n?void 0:n.replace("FOLIO_","")})]}),(0,Ug.jsx)("div",{className:"text-slate-400 mb-1 line-clamp-2",children:e.details}),(0,Ug.jsxs)("div",{className:"flex justify-between text-[10px] text-slate-600",children:[(0,Ug.jsx)("span",{children:e.performedBy}),(0,Ug.jsx)("span",{children:new Date(e.timestamp).toLocaleTimeString()})]})]},e.id||t)}),(0,Ug.jsx)("div",{className:"p-4 text-center text-slate-600 border-t border-slate-800 bg-slate-900",children:"End of stream (Last 10 events)"})]})})]}):(0,Ug.jsxs)("button",{onClick:()=>i(!0),className:"fixed bottom-4 right-4 bg-slate-800 text-slate-300 p-3 rounded-full shadow-lg hover:bg-slate-700 transition-all z-40 flex items-center gap-2 border border-slate-600",children:[(0,Ug.jsx)(Kg,{size:20,className:"text-blue-400"}),(0,Ug.jsx)("span",{className:"font-bold text-sm",children:"V2 Debug"})]})},Yg=h("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),$g=h("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),Zg=h("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ev=e=>{let{db:t,appId:n,onSelectFolio:s}=e;const[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)("OPEN"),[u,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{const e=Gp(bp(Tm(t,"folios"),Np("status","==",o),jp("createdAt","desc")),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));a(t),d(!1)},e=>{console.error("Error fetching folios:",e),d(!1)});return()=>e()},[t,o]);const h=e=>{switch(e){case"OPEN":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"CLOSED":return"bg-slate-100 text-slate-800 border-slate-200";case"VOIDED":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800"}};return(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col",children:[(0,Ug.jsxs)("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50 rounded-t-xl",children:[(0,Ug.jsxs)("h2",{className:"font-bold text-slate-700 flex items-center gap-2",children:[(0,Ug.jsx)(F,{size:20,className:"text-blue-600"}),"Folio Management"]}),(0,Ug.jsx)("div",{className:"flex bg-white rounded-lg border border-slate-200 p-1",children:["OPEN","CLOSED","VOIDED"].map(e=>(0,Ug.jsx)("button",{onClick:()=>l(e),className:"px-3 py-1 text-xs font-bold rounded-md transition-colors ".concat(o===e?"bg-blue-600 text-white shadow-sm":"text-slate-500 hover:bg-slate-50"),children:e},e))})]}),(0,Ug.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:u?(0,Ug.jsx)("div",{className:"text-center p-8 text-slate-400",children:"Loading folios..."}):0===i.length?(0,Ug.jsxs)("div",{className:"text-center p-8 text-slate-400 flex flex-col items-center",children:[(0,Ug.jsx)("custom-icon",{name:"ghost",className:"mb-2 opacity-50"}),(0,Ug.jsxs)("p",{children:["No ",o.toLowerCase()," folios found"]})]}):i.map(e=>{return(0,Ug.jsxs)("div",{onClick:()=>s&&s(e),className:"p-3 bg-white border border-slate-100 rounded-lg hover:border-blue-300 hover:shadow-md transition-all cursor-pointer group",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-bold text-slate-800 group-hover:text-blue-600 transition-colors",children:e.id}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,Ug.jsx)(O,{size:10}),new Date(e.createdAt).toLocaleString()]})]}),(0,Ug.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold border ".concat(h(e.status)),children:e.status})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-slate-600 mb-2",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,Ug.jsx)(Zg,{size:14,className:"text-slate-400"}),(0,Ug.jsx)("span",{className:"truncate",children:e.guestName||e.staffName||"Unknown"})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,Ug.jsx)(S,{size:14,className:"text-slate-400"}),(0,Ug.jsx)("span",{className:"truncate",children:e.type})]})]}),(0,Ug.jsxs)("div",{className:"pt-2 border-t border-slate-50 flex justify-between items-end",children:[(0,Ug.jsx)("div",{className:"text-xs text-slate-400",children:"Total Amount"}),(0,Ug.jsx)("div",{className:"font-mono font-bold text-lg text-slate-800",children:(t=e.total||0,new Intl.NumberFormat("en-UG",{style:"decimal"}).format(t)+" UGX")})]})]},e.id);var t})})]})},tv=h("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),nv=e=>{let{db:t,appId:n,onPrintInvoice:s}=e;const[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[u,d]=(0,r.useState)("");(0,r.useEffect)(()=>{const e=Gp(bp(Tm(t,"invoices"),jp("invoiceNo","desc"),Ip(50)),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));a(t),l(!1)});return()=>e()},[t]);const h=i.filter(e=>e.invoiceNo.toLowerCase().includes(u.toLowerCase())||e.guestName&&e.guestName.toLowerCase().includes(u.toLowerCase())||e.staffName&&e.staffName.toLowerCase().includes(u.toLowerCase()));return(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col",children:[(0,Ug.jsxs)("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50 rounded-t-xl",children:[(0,Ug.jsxs)("h2",{className:"font-bold text-slate-700 flex items-center gap-2",children:[(0,Ug.jsx)(Yg,{size:20,className:"text-emerald-600"}),"Invoices"]}),(0,Ug.jsxs)("div",{className:"relative",children:[(0,Ug.jsx)(tv,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),(0,Ug.jsx)("input",{type:"text",placeholder:"Search invoice...",className:"pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500",value:u,onChange:e=>d(e.target.value)})]})]}),(0,Ug.jsx)("div",{className:"flex-1 overflow-auto",children:(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-50 text-slate-500 sticky top-0",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3 font-semibold border-b",children:"Number"}),(0,Ug.jsx)("th",{className:"p-3 font-semibold border-b",children:"Date"}),(0,Ug.jsx)("th",{className:"p-3 font-semibold border-b",children:"Billed To"}),(0,Ug.jsx)("th",{className:"p-3 font-semibold border-b text-right",children:"Amount"}),(0,Ug.jsx)("th",{className:"p-3 font-semibold border-b text-center",children:"Action"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y divide-slate-100",children:o?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"5",className:"p-8 text-center text-slate-400",children:"Loading history..."})}):0===h.length?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"5",className:"p-8 text-center text-slate-400",children:"No invoices found"})}):h.map(e=>(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50 group transition-colors",children:[(0,Ug.jsx)("td",{className:"p-3 font-mono font-medium text-slate-700",children:e.invoiceNo}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.finalizedAt?new Date(e.finalizedAt).toLocaleDateString():"-"}),(0,Ug.jsxs)("td",{className:"p-3 text-slate-600",children:[(0,Ug.jsx)("div",{className:"font-medium text-slate-900",children:e.guestName||"Walk-in Customer"}),(0,Ug.jsx)("div",{className:"text-xs",children:e.staffName||"Unknown Staff"})]}),(0,Ug.jsx)("td",{className:"p-3 text-emerald-600 font-bold font-mono text-right",children:new Intl.NumberFormat("en-UG").format(e.total)}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:(0,Ug.jsx)("button",{onClick:()=>s(e),className:"p-1.5 text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Print Invoice",children:(0,Ug.jsx)(q,{size:16})})})]},e.id))})]})})]})},rv=e=>{let{db:t,appId:n,userRole:s}=e;const[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{if("admin"!==s)return;const e=Gp(bp(Tm(t,"audit_logs"),jp("timestamp","desc"),Ip(100)),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));a(t),l(!1)});return()=>e()},[t,s]),"admin"!==s)return(0,Ug.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-red-500 bg-red-50 rounded-xl m-4 border border-red-200",children:[(0,Ug.jsx)($g,{size:48,className:"mb-4"}),(0,Ug.jsx)("h2",{className:"text-xl font-bold",children:"Access Denied"}),(0,Ug.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Only Administrators can view the financial audit trail."})]});return(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col",children:[(0,Ug.jsxs)("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-slate-800 text-white rounded-t-xl",children:[(0,Ug.jsxs)("h2",{className:"font-bold flex items-center gap-2",children:[(0,Ug.jsx)($g,{size:20,className:"text-amber-400"}),"Financial Audit Trail"]}),(0,Ug.jsx)("div",{className:"text-xs opacity-70 font-mono",children:"IMMUTABLE LEDGER"})]}),(0,Ug.jsx)("div",{className:"flex-1 overflow-auto bg-slate-50 p-4",children:o?(0,Ug.jsx)("div",{className:"text-center p-8 text-slate-400",children:"Loading secure logs..."}):(0,Ug.jsxs)("div",{className:"space-y-4",children:[i.map(e=>{var t,n;return(0,Ug.jsxs)("div",{className:"flex gap-4",children:[(0,Ug.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Ug.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-300 mt-2"}),(0,Ug.jsx)("div",{className:"w-0.5 flex-1 bg-slate-200 my-1"})]}),(0,Ug.jsxs)("div",{className:"flex-1 bg-white p-3 rounded-lg border border-slate-200 shadow-sm text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ug.jsx)("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold border ".concat((n=e.action,n.includes("CREATE")?"text-emerald-600 bg-emerald-50 border-emerald-200":n.includes("VOID")?"text-red-600 bg-red-50 border-red-200":n.includes("CLOSE")?"text-blue-600 bg-blue-50 border-blue-200":"text-slate-600 bg-slate-50 border-slate-200")),children:e.action}),(0,Ug.jsx)("span",{className:"text-xs text-slate-400 font-mono",children:new Date(e.timestamp).toLocaleString()})]}),(0,Ug.jsx)("p",{className:"text-slate-700 font-medium mb-1",children:e.details||"No details provided"}),(0,Ug.jsxs)("div",{className:"flex gap-4 text-xs text-slate-500 mt-2 pt-2 border-t border-slate-50",children:[(0,Ug.jsxs)("span",{children:["User: ",(0,Ug.jsx)("strong",{children:e.performedBy||"System"})]}),e.targetId&&(0,Ug.jsxs)("span",{children:["Target: ",(0,Ug.jsx)("span",{className:"font-mono",children:e.targetId})]}),(null===(t=e.metadata)||void 0===t?void 0:t.ipv4)&&(0,Ug.jsxs)("span",{children:["IP: ",e.metadata.ipv4]})]})]})]},e.id)}),(0,Ug.jsx)("div",{className:"text-center py-4 text-xs text-slate-400 uppercase tracking-widest",children:"End of Live Log"})]})})]})},sv=e=>{var t;let{db:n,appId:s,folio:i,onClose:a}=e;const[o,l]=(0,r.useState)([]),[u,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!i)return;(async()=>{d(!0);try{const e=bp(Tm(n,"folio_line_items"),Np("folioId","==",i.id),jp("createdAt","asc")),t=(await zp(e)).docs.map(e=>c({id:e.id},e.data()));l(t)}catch(e){console.error("Fetch items error:",e)}finally{d(!1)}})()},[n,i]),i?(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,Ug.jsxs)("div",{className:"p-6 bg-slate-800 text-white flex justify-between items-start",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2 text-blue-300 font-mono text-xs mb-1",children:[(0,Ug.jsx)("span",{children:i.id}),(0,Ug.jsx)("span",{className:"px-1.5 py-0.5 bg-white/10 rounded",children:i.status})]}),(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:["ROOM"===i.type?(0,Ug.jsx)(f,{className:"text-blue-400"}):(0,Ug.jsx)(m,{className:"text-amber-400"}),"ROOM"===i.type?"Room ".concat((null===(t=i.v1LinkedRecords)||void 0===t?void 0:t.roomNumber)||"Unknown"):"Bar Tab"]}),(0,Ug.jsxs)("p",{className:"text-slate-400 text-sm mt-1 flex items-center gap-2",children:[(0,Ug.jsx)(Zg,{size:14})," ",i.guestName||"Walk-in"]})]}),(0,Ug.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6 text-sm",children:[(0,Ug.jsxs)("div",{className:"bg-white p-3 rounded border border-slate-200",children:[(0,Ug.jsx)("div",{className:"text-slate-500 text-xs mb-1",children:"Created By"}),(0,Ug.jsx)("div",{className:"font-medium",children:i.staffName})]}),(0,Ug.jsxs)("div",{className:"bg-white p-3 rounded border border-slate-200",children:[(0,Ug.jsx)("div",{className:"text-slate-500 text-xs mb-1",children:"Date"}),(0,Ug.jsx)("div",{className:"font-medium",children:new Date(i.createdAt).toLocaleString()})]})]}),(0,Ug.jsx)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden mb-6",children:(0,Ug.jsxs)("table",{className:"w-full text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-500 font-medium",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Description"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Qty"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Amount"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y divide-slate-100",children:u?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"3",className:"p-8 text-center text-slate-400",children:"Loading charges..."})}):0===o.length?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"3",className:"p-8 text-center text-slate-400",children:"No charges found"})}):o.map(e=>{var t;return(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsxs)("td",{className:"p-3",children:[(0,Ug.jsx)("div",{className:"font-medium text-slate-800",children:e.description}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-400 font-mono",children:[e.department," \u2022 ",new Date(e.createdAt).toLocaleTimeString()]})]}),(0,Ug.jsx)("td",{className:"p-3 text-center text-slate-500",children:"ROOM_CHARGE"===e.type?"".concat((null===(t=e.details)||void 0===t?void 0:t.nights)||1," nights"):"1"}),(0,Ug.jsx)("td",{className:"p-3 text-right font-mono font-medium",children:new Intl.NumberFormat("en-UG").format(e.amount)})]},e.id)})}),(0,Ug.jsx)("tfoot",{className:"bg-slate-50 font-bold border-t border-slate-200",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{className:"p-3 text-right uppercase text-xs text-slate-500",colSpan:"2",children:"Total Due"}),(0,Ug.jsxs)("td",{className:"p-3 text-right text-lg text-slate-800",children:[new Intl.NumberFormat("en-UG").format(i.total||0)," ",(0,Ug.jsx)("span",{className:"text-xs text-slate-400 font-normal",children:"UGX"})]})]})})]})}),"OPEN"===i.status&&(0,Ug.jsx)("div",{className:"p-3 bg-blue-50 text-blue-700 text-sm rounded-lg border border-blue-100 flex items-center justify-center",children:"This folio is currently active. Charges can be added via POS/Front Office."})]})]})}):null},iv=e=>{let{active:t,onClick:n,icon:r,label:s,desc:i}=e;return(0,Ug.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all text-left ".concat(t?"bg-blue-50 text-blue-700 border border-blue-100 shadow-sm":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"),children:[(0,Ug.jsx)("div",{className:"p-2 rounded-lg ".concat(t?"bg-blue-200 text-blue-700":"bg-slate-100 text-slate-500"),children:(0,Ug.jsx)(r,{size:20})}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-semibold text-sm",children:s}),(0,Ug.jsx)("div",{className:"text-xs opacity-70 font-normal",children:i})]})]})},av=e=>{let{db:t,appId:n,userRole:s,staffName:i,onNavigateHome:a}=e;const[o,l]=(0,r.useState)("folios"),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-slate-900 text-white px-6 py-4 flex justify-between items-center shadow-md z-10",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ug.jsx)("button",{onClick:a,className:"p-2 hover:bg-slate-700 rounded-full transition-colors",title:"Back to Dashboard",children:(0,Ug.jsx)(y,{size:20})}),(0,Ug.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,Ug.jsx)(S,{className:"text-blue-400"}),"Finance & Audit"]}),(0,Ug.jsx)("span",{className:"px-2 py-0.5 bg-blue-600/30 border border-blue-500/50 rounded text-xs font-mono text-blue-200",children:"V2 ENGINE"})]}),(0,Ug.jsx)("div",{className:"flex items-center gap-6",children:(0,Ug.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,Ug.jsx)("div",{className:"text-sm font-semibold",children:i}),(0,Ug.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:s})]})})]}),(0,Ug.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col py-4",children:[(0,Ug.jsxs)("nav",{className:"space-y-1 px-2",children:[(0,Ug.jsx)(iv,{active:"folios"===o,onClick:()=>l("folios"),icon:F,label:"Active Folios",desc:"Open rooms & tabs"}),(0,Ug.jsx)(iv,{active:"invoices"===o,onClick:()=>l("invoices"),icon:Yg,label:"Invoices",desc:"History & Printing"}),"admin"===s&&(0,Ug.jsx)(iv,{active:"audit"===o,onClick:()=>l("audit"),icon:$g,label:"Audit Logs",desc:"Security Trail"})]}),(0,Ug.jsxs)("div",{className:"mt-auto px-6 py-4 text-xs text-slate-400",children:[(0,Ug.jsx)("p",{className:"font-bold text-slate-500",children:"System Status"}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,Ug.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,Ug.jsx)("span",{children:"Dual-Write Active"})]})]})]}),(0,Ug.jsxs)("div",{className:"flex-1 overflow-hidden p-6 relative",children:["folios"===o&&(0,Ug.jsx)(ev,{db:t,appId:n,onSelectFolio:u}),"invoices"===o&&(0,Ug.jsx)(nv,{db:t,appId:n,onPrintInvoice:e=>{alert("This would open the print dialog for invoice #".concat(e.invoiceNo))}}),"audit"===o&&(0,Ug.jsx)(rv,{db:t,appId:n,userRole:s})]})]}),c&&(0,Ug.jsx)(sv,{db:t,appId:n,folio:c,onClose:()=>u(null)})]})},ov=[{id:"staff_a",name:"Service Staff A",center:"bar_main"},{id:"staff_b",name:"Service Staff B",center:"bar_main"},{id:"staff_c",name:"Service Staff C",center:"bar_main"},{id:"riverside_a",name:"Riverside Staff A",center:"bar_river"},{id:"riverside_b",name:"Riverside Staff B",center:"bar_river"},{id:"pool_staff",name:"Pool Attendant",center:"pool"},{id:"health_staff",name:"Health Club Attendant",center:"health_club"},{id:"kitchen_staff",name:"Kitchen Staff",center:"kitchen"}],lv=e=>{let{onStaffSelected:t,currentDepartment:n}=e;const[s,i]=(0,r.useState)(null),[a,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=localStorage.getItem("pos_selected_staff");if(e)try{const n=JSON.parse(e);i(n),null===t||void 0===t||t(n)}catch(n){console.error("Failed to parse saved staff:",n)}else o(!0)},[]);const l=e=>{i(e),localStorage.setItem("pos_selected_staff",JSON.stringify(e)),null===t||void 0===t||t(e),o(!1)},c=n?ov.filter(e=>e.center===n.id):ov;return a||!s?(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[(0,Ug.jsx)("div",{className:"p-6 bg-blue-600 text-white rounded-t-2xl",children:(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ug.jsx)(T,{size:28}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Select Service Staff"}),(0,Ug.jsx)("p",{className:"text-sm opacity-90",children:"Who is taking orders?"})]})]})}),(0,Ug.jsxs)("div",{className:"p-6",children:[(0,Ug.jsx)("p",{className:"text-slate-600 mb-4 text-sm",children:"Select your name to attribute sales and track performance:"}),(0,Ug.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:c.map(e=>(0,Ug.jsxs)("button",{onClick:()=>l(e),className:"w-full p-4 text-left bg-slate-50 hover:bg-blue-50 border border-slate-200 hover:border-blue-300 rounded-lg transition-all",children:[(0,Ug.jsx)("div",{className:"font-bold text-slate-800",children:e.name}),(0,Ug.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:e.center.replace("_"," ").toUpperCase()})]},e.id))}),0===c.length&&(0,Ug.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,Ug.jsx)("p",{children:"No staff available for this department"}),(0,Ug.jsx)("button",{onClick:()=>l(ov[0]),className:"mt-4 text-blue-600 underline",children:"Use default staff"})]})]})]})}):(0,Ug.jsxs)("button",{onClick:()=>{o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",title:"Click to change service staff",children:[(0,Ug.jsx)(T,{size:18}),(0,Ug.jsxs)("div",{className:"text-left",children:[(0,Ug.jsx)("div",{className:"text-xs opacity-80",children:"Service Staff:"}),(0,Ug.jsx)("div",{className:"font-bold text-sm",children:s.name})]}),(0,Ug.jsx)(Qg,{size:16,className:"opacity-60"})]})},cv=Xt(window.__firebase_config?JSON.parse(window.__firebase_config):{}),uv=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt();const t=Ht(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ht(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(_e(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;pn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Ii,persistence:[Ms,vs,Ns]}),r=he("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(s=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ai)return;const r=null===t||void 0===t?void 0:t.token;Di!==r&&(Di=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){Re(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){Re(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var s;const i=ue("auth");return i&&Mr(n,"http://".concat(i)),n}(cv),dv=function(e,t){const n="object"==typeof e?e:Jt(),r="string"==typeof e?e:t||al,s=Ht(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=(e=>{const t=ue(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&_m(s,...e)}return s}(cv),hv=new es,fv="undefined"!==typeof window.__app_id?window.__app_id:"default-app-id";Gg(dv,fv),function(e,t){"undefined"!==typeof window&&(window.runPosAcceptanceTests=()=>async function(e,t){const n={timestamp:(new Date).toISOString(),tests:{},records:{}},r=function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log("[".concat(e,"] ").concat(t)),n.tests[e]||(n.tests[e]=[]),n.tests[e].push({msg:t,success:r})},s="test_admin",i="Test Admin";try{r("INIT","Starting POS Acceptance Tests...");const a=[];r("TEST_1","Creating 3 Concurrent Open Orders...");for(let n=1;n<=3;n++){const o=await Ig(e,t,{serviceCenter:"bar_main",staffId:s,staffName:i,tableOrLabel:"Test Table ".concat(n)});o?(a.push(o.folioId),r("TEST_1","Created Order ".concat(n,": ").concat(o.folioId," (").concat(o.ownerName,")"))):r("TEST_1","Failed to create Order ".concat(n),!1)}r("TEST_1","Adding items to orders..."),await kg(e,t,{folioId:a[0],description:"Order 1 Item (Beer)",itemType:"DRINK",quantity:2,unitPrice:5e3,category:"Bar",staffId:s,staffName:i}),await kg(e,t,{folioId:a[1],description:"Order 2 Item (Pizza)",itemType:"FOOD",quantity:1,unitPrice:3e4,category:"Kitchen",staffId:s,staffName:i}),await kg(e,t,{folioId:a[2],description:"Order 3 Item (Water)",itemType:"DRINK",quantity:1,unitPrice:2e3,category:"Bar",staffId:s,staffName:i});const o=[];for(const n of a){const r=await Up(Am(e,"artifacts",t,"public","data","folios",n));o.push(r.data())}n.records.concurrent_orders=o;const l=1e4===o[0].grandTotal&&3e4===o[1].grandTotal&&2e3===o[2].grandTotal;r("TEST_1","Totals Verification: ".concat(l?"PASS":"FAIL"),l),r("TEST_2","Testing Partial Payment on Order 2..."),await Eg(e,t,{folioId:a[1],amount:1e4,method:"CASH",staffId:s,staffName:i});const c=(await Up(Am(e,"artifacts",t,"public","data","folios",a[1]))).data();n.records.partial_payment_order=c;const u="PART_PAID"===c.status,d=c.grandTotal-c.amountPaid===2e4;r("TEST_2","Status is PART_PAID: ".concat(u),u),r("TEST_2","Balance is 20,000: ".concat(d),d),r("TEST_4","Verifying Audit Trail...");const h=[],f=bp(Tm(e,"artifacts",t,"public","data","audit_logs"),Np("entityId","in",a),jp("timestamp","desc"));return(await zp(f)).forEach(e=>h.push(e.data())),n.records.audit_logs=h,r("TEST_4","Found ".concat(h.length," audit logs for test orders"),h.length>0),r("DONE","Tests Complete. returning report."),n}catch(a){return r("ERROR",a.message,!1),n}}(e,t),console.log("\u2705 POS Acceptance Test Runner Initialized. Run window.runPosAcceptanceTests()"))}(dv,fv);const mv=[{email:"admin@sourcegarden.ug",name:"Administrator",role:"admin",department:null},{email:"supervisor@sourcegarden.ug",name:"Supervisor",role:"supervisor",department:null},{email:"mustafa@sourcegarden.ug",name:"Mustafa",role:"staff",department:"fo"},{email:"mainbar@sourcegarden.ug",name:"Main Bar Person",role:"barperson",department:"bar_main",serviceCenter:"bar_main"},{email:"mainbar.s1@sourcegarden.ug",name:"Main Bar Service 1",role:"service_staff",department:"bar_main",serviceCenter:"bar_main"},{email:"mainbar.s2@sourcegarden.ug",name:"Main Bar Service 2",role:"service_staff",department:"bar_main",serviceCenter:"bar_main"},{email:"pauline@sourcegarden.ug",name:"Pauline",role:"barperson",department:"bar_river",serviceCenter:"bar_river"},{email:"riverside.s1@sourcegarden.ug",name:"Riverside Service 1",role:"service_staff",department:"bar_river",serviceCenter:"bar_river"},{email:"riverside.s2@sourcegarden.ug",name:"Riverside Service 2",role:"service_staff",department:"bar_river",serviceCenter:"bar_river"},{email:"kitchen@sourcegarden.ug",name:"Kitchen Person",role:"barperson",department:"kitchen",serviceCenter:"kitchen"},{email:"kitchen.s1@sourcegarden.ug",name:"Kitchen Service 1",role:"service_staff",department:"kitchen",serviceCenter:"kitchen"},{email:"kitchen.s2@sourcegarden.ug",name:"Kitchen Service 2",role:"service_staff",department:"kitchen",serviceCenter:"kitchen"},{email:"healthclub@sourcegarden.ug",name:"Health Club Person",role:"barperson",department:"health",serviceCenter:"health"},{email:"poolbar@sourcegarden.ug",name:"Pool Bar Person",role:"barperson",department:"pool_bar",serviceCenter:"pool_bar"},{email:"faridahkyohirwe@gmail.com",name:"Faridah Kyohirwe",role:"admin",department:null},{email:"wachaexperience@gmail.com",name:"Wacha Experience",role:"admin",department:null},{email:"kennethahimbisibwe46@gmail.com",name:"Kenneth Ahimbisibwe",role:"admin",department:null},{email:"ocenphillip03@gmail.com",name:"Ocen Phillip",role:"admin",department:null}],pv=[{id:"bar_main",name:"Main Bar",stockTypes:["drinks"]},{id:"bar_river",name:"Riverside Bar",stockTypes:["drinks"]},{id:"kitchen",name:"New Kitchen",stockTypes:["food","drinks"]},{id:"health",name:"Health Club",stockTypes:["drinks"]},{id:"pool_bar",name:"Swimming Pool Bar",stockTypes:["drinks"]}],gv=[{id:"raw_whole_fish",name:"Whole Fish (Raw)",unit:"pcs",category:"Proteins"},{id:"raw_fish_fillet",name:"Fish Fillet",unit:"kg",category:"Proteins"},{id:"raw_chicken_whole",name:"Whole Chicken",unit:"pcs",category:"Proteins"},{id:"raw_beef",name:"Beef (Meat)",unit:"kg",category:"Proteins"},{id:"raw_goat",name:"Goat Meat",unit:"kg",category:"Proteins"},{id:"raw_liver",name:"Liver",unit:"kg",category:"Proteins"},{id:"raw_eggs",name:"Eggs",unit:"tray",category:"Proteins"},{id:"raw_sausages",name:"Sausages",unit:"pkt",category:"Proteins"},{id:"raw_potatoes",name:"Irish Potatoes",unit:"sack",category:"Produce"},{id:"raw_matooke",name:"Matooke",unit:"bunch",category:"Produce"},{id:"raw_rice",name:"Rice",unit:"kg",category:"Produce"},{id:"raw_posho",name:"Posho/Maize Flour",unit:"kg",category:"Produce"},{id:"raw_tomatoes",name:"Tomatoes",unit:"box",category:"Produce"},{id:"raw_onions",name:"Onions",unit:"net",category:"Produce"},{id:"raw_garlic",name:"Garlic",unit:"kg",category:"Produce"},{id:"raw_ginger",name:"Ginger",unit:"kg",category:"Produce"},{id:"raw_cabbage",name:"Cabbages",unit:"pc",category:"Produce"},{id:"raw_green_pepper",name:"Green Peppers",unit:"kg",category:"Produce"},{id:"raw_carrots",name:"Carrots",unit:"kg",category:"Produce"},{id:"raw_fruits",name:"Mixed Fruits",unit:"kg",category:"Produce"},{id:"raw_oil",name:"Cooking Oil",unit:"liters",category:"Pantry"},{id:"raw_salt",name:"Salt",unit:"kg",category:"Pantry"},{id:"raw_sugar",name:"Sugar",unit:"kg",category:"Pantry"},{id:"raw_spaghetti",name:"Spaghetti",unit:"pkt",category:"Pantry"},{id:"raw_wheat_flour",name:"Wheat Flour",unit:"kg",category:"Pantry"},{id:"raw_milk",name:"Milk",unit:"liters",category:"Pantry"},{id:"raw_spices",name:"Spices (Assorted)",unit:"tin",category:"Pantry"},{id:"raw_bread",name:"Bread",unit:"loaf",category:"Pantry"}],vv=[{id:"cot_fam",number:"Family",type:"Family Cottage",price:45e4,status:"clean"},{id:"cot_ele1",number:"Elephant 1",type:"Cottage",price:17e4,status:"clean"},{id:"cot_ele2",number:"Elephant 2",type:"Cottage",price:17e4,status:"clean"},{id:"cot_gir1",number:"Giraffe 1",type:"Cottage",price:17e4,status:"clean"},{id:"cot_gir2",number:"Giraffe 2",type:"Cottage",price:17e4,status:"clean"},{id:"cot_hor1",number:"Horse 1",type:"Cottage",price:17e4,status:"clean"},{id:"cot_hor2",number:"Horse 2",type:"Cottage",price:17e4,status:"clean"},{id:"cot_leo1",number:"Leopard 1",type:"Cottage",price:17e4,status:"clean"},{id:"cot_leo2",number:"Leopard 2",type:"Cottage",price:17e4,status:"clean"},{id:"cot_zeb1",number:"Zebra 1",type:"Cottage",price:17e4,status:"clean"},{id:"cot_zeb2",number:"Zebra 2",type:"Cottage",price:17e4,status:"clean"},{id:"old_04",number:"D/RM4",type:"Deluxe Double",price:12e4,status:"clean"},{id:"old_05",number:"D/RM5",type:"Deluxe Double",price:12e4,status:"clean"},{id:"twin_1",number:"TWIN 1",type:"Twin",price:15e4,status:"clean"},{id:"twin_2",number:"TWIN 2",type:"Twin",price:15e4,status:"clean"},{id:"twin_3",number:"TWIN 3",type:"Twin",price:15e4,status:"clean"},{id:"twin_4",number:"TWIN 4",type:"Twin",price:15e4,status:"clean"},{id:"twin_5",number:"TWIN 5",type:"Twin",price:15e4,status:"clean"},{id:"twin_6",number:"TWIN 6",type:"Twin",price:15e4,status:"clean"},{id:"twin_7",number:"TWIN 7",type:"Twin",price:15e4,status:"clean"},{id:"twin_8",number:"TWIN 8",type:"Twin",price:15e4,status:"clean"},{id:"rm_01",number:"RM 1",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_02",number:"RM 2",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_03",number:"RM 3",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_04",number:"RM 4",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_05",number:"RM 5",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_06",number:"RM 6",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_07",number:"RM 7",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_08",number:"RM 8",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_09",number:"RM 9",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_10",number:"RM 10",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_11",number:"RM 11",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_12",number:"RM 12",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_13",number:"RM 13",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_14",number:"RM 14",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_15",number:"RM 15",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_16",number:"RM 16",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_17",number:"RM 17",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_18",number:"RM 18",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_19",number:"RM 19",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_20",number:"RM 20",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_21",number:"RM 21",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_22",number:"RM 22",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_23",number:"RM 23",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_24",number:"RM 24",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_25",number:"RM 25",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_26",number:"RM 26",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_27",number:"RM 27",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_28",number:"RM 28",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_29",number:"RM 29",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_30",number:"RM 30",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_31",number:"RM 31",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_32",number:"RM 32",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_33",number:"RM 33",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_34",number:"RM 34",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_35",number:"RM 35",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_36",number:"RM 36",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_37",number:"RM 37",type:"Deluxe Double",price:15e4,status:"clean"},{id:"rm_38",number:"RM 38",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_39",number:"RM 39",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_40",number:"RM 40",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_41",number:"RM 41",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_42",number:"RM 42",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_43",number:"RM 43",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_44",number:"RM 44",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_45",number:"RM 45",type:"Deluxe Double",price:12e4,status:"clean"},{id:"rm_46",number:"RM 46",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_47",number:"RM 47",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_48",number:"RM 48",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_49",number:"RM 49",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_50",number:"RM 50",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_51",number:"RM 51",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_52",number:"RM 52",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_53",number:"RM 53",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_54",number:"RM 54",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_55",number:"RM 55",type:"Deluxe Double",price:14e4,status:"clean"},{id:"rm_56",number:"RM 56",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_57",number:"RM 57",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_58",number:"RM 58",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_59",number:"RM 59",type:"Deluxe Single",price:12e4,status:"clean"},{id:"rm_60",number:"RM 60",type:"Deluxe Single",price:12e4,status:"clean"}],yv=[{id:"fo",name:"Front Office",icon:f,color:"bg-blue-600",isServiceCenter:!1},{id:"bar_main",name:"Main Bar",icon:m,color:"bg-amber-600",isServiceCenter:!0},{id:"bar_river",name:"Riverside Bar",icon:p,color:"bg-cyan-600",isServiceCenter:!0},{id:"kitchen",name:"New Kitchen",icon:g,color:"bg-red-600",isServiceCenter:!0},{id:"health",name:"Health Club",icon:v,color:"bg-emerald-600",isServiceCenter:!0},{id:"pool_bar",name:"Swimming Pool Bar",icon:p,color:"bg-sky-500",isServiceCenter:!0}],xv=e=>{let{children:t,onClick:n,className:r="",variant:s="primary",disabled:i=!1,icon:a}=e;return(0,Ug.jsxs)("button",{onClick:n,className:"".concat("px-4 py-2 rounded-lg font-medium transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"," ").concat({primary:"bg-slate-800 text-white hover:bg-slate-700 shadow-lg",secondary:"bg-white text-slate-800 border border-slate-200 hover:bg-slate-50",danger:"bg-red-500 text-white hover:bg-red-600",success:"bg-emerald-600 text-white hover:bg-emerald-700"}[s]," ").concat(r),disabled:i,children:[a&&(0,Ug.jsx)(a,{size:18}),t]})};function bv(){var e;const[t,n]=(0,r.useState)(null),[s,i]=(0,r.useState)(null),[a,o]=(0,r.useState)("login"),[l,u]=(0,r.useState)(null),[d,h]=(0,r.useState)([]),[f,m]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[v,j]=(0,r.useState)(null),[_,I]=(0,r.useState)(!1),{workPeriod:E,openWorkPeriod:C,closeWorkPeriod:T,isOpen:A}=function(){const[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(!0);return(0,r.useEffect)(()=>Gp(Am(dv,"artifacts",fv,"public","data","workPeriods","current"),e=>{e.exists()?t(c({id:"current"},e.data())):t(null),s(!1)},e=>{console.error("Work period listener error:",e),s(!1)}),[]),{workPeriod:e,loading:n,openWorkPeriod:async e=>{const t=(new Date).toISOString(),n="WP-".concat(Date.now());await Bp(Am(dv,"artifacts",fv,"public","data","workPeriods","current"),{id:n,status:"open",openedAt:t,openedBy:e,closedAt:null,closedBy:null,salesCount:0,totalRevenue:0})},closeWorkPeriod:async(t,n)=>{if(!e)return;const r=(new Date).toISOString();await Bp(Am(dv,"artifacts",fv,"public","data","workPeriods",e.id),c(c({},e),{},{status:"closed",closedAt:r,closedBy:t},n)),await Bp(Am(dv,"artifacts",fv,"public","data","workPeriods","current"),{status:"closed",lastPeriodId:e.id,closedAt:r})},isOpen:"open"===(null===e||void 0===e?void 0:e.status)}}(),{currentShift:D,startShift:R,endShift:P,updateShiftMetrics:O}=function(e,t,n){const[s,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(e)return Gp(Am(dv,"artifacts",fv,"public","data","staffShifts",e),t=>{t.exists()?i(c({id:e},t.data())):i(null)})},[e]);const a=(0,r.useCallback)(async()=>{if(!e||!t)return;const r={shiftId:"SHIFT-".concat(Date.now()),staffId:e,staffName:t,serviceCenter:n||"general",loginTime:(new Date).toISOString(),logoutTime:null,status:"active",ordersCount:0,totalSales:0,itemsSold:[]};return await Bp(Am(dv,"artifacts",fv,"public","data","staffShifts",e),r),r},[e,t,n]),o=(0,r.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e||!s)return;const n=(new Date).toISOString(),r=s.loginTime?Math.round((new Date(n)-new Date(s.loginTime))/6e4):0;await Bp(Am(dv,"artifacts",fv,"public","data","shiftHistory",s.shiftId),c(c({},s),{},{logoutTime:n,status:"completed",shiftDuration:r},t)),await Hp(Am(dv,"artifacts",fv,"public","data","staffShifts",e))},[e,s]),l=(0,r.useCallback)(async(t,n)=>{e&&s&&await qp(Am(dv,"artifacts",fv,"public","data","staffShifts",e),{ordersCount:eg(1),totalSales:eg(t),itemsSold:Zp(...n.map(e=>({name:e.name,qty:e.qty,price:e.price})))})},[e,s]);return{currentShift:s,startShift:a,endShift:o,updateShiftMetrics:l}}(null===s||void 0===s?void 0:s.id,null===s||void 0===s?void 0:s.name,(null===s||void 0===s?void 0:s.serviceCenter)||(null===s||void 0===s?void 0:s.department)),{performanceData:L,updatePerformance:M}=function(e,t){const[n,s]=(0,r.useState)(null),[i,a]=(0,r.useState)([]);return(0,r.useEffect)(()=>{if(!e)return;const t=(new Date).toISOString().slice(0,7),n=Gp(Am(dv,"artifacts",fv,"public","data","staffPerformance","".concat(e,"_").concat(t)),e=>{e.exists()?s(e.data()):s({totalSales:0,ordersCount:0,itemsSold:0,shiftsWorked:0})}),r=Gp(Tm(dv,"artifacts",fv,"public","data","salesTargets"),e=>a(e.docs.map(e=>c({id:e.id},e.data()))));return()=>{n(),r()}},[e]),{performanceData:n,salesTargets:i,getStaffTarget:()=>{const t=(new Date).toISOString().slice(0,7);return i.find(n=>n.staffId===e&&n.month===t)},updatePerformance:async(n,r)=>{if(!e)return;const s=(new Date).toISOString().slice(0,7),i=Am(dv,"artifacts",fv,"public","data","staffPerformance","".concat(e,"_").concat(s));try{await qp(i,{totalSales:eg(n),ordersCount:eg(1),itemsSold:eg(r),lastUpdated:(new Date).toISOString()})}catch(a){await Bp(i,{staffId:e,serviceCenter:t,month:s,totalSales:n,ordersCount:1,itemsSold:r,shiftsWorked:1,createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()})}}}}(null===s||void 0===s?void 0:s.id,(null===s||void 0===s?void 0:s.serviceCenter)||(null===s||void 0===s?void 0:s.department));(0,r.useEffect)(()=>{const e=function(e,t,n,r){return Re(e).onAuthStateChanged(t,n,r)}(uv,async e=>{if(n(e),e)try{const n=await Up(Am(dv,"artifacts",fv,"public","data","users",e.uid));if(n.exists()){const r=n.data(),s=c(c({},r),{},{id:e.uid,email:e.email,photo:e.photoURL,name:r.name||e.displayName||e.email});if(i(s),["staff","barperson","service_staff"].includes(r.role))try{if(!(await Up(Am(dv,"artifacts",fv,"public","data","staffShifts",e.uid))).exists()){const t={shiftId:"SHIFT-".concat(Date.now()),staffId:e.uid,staffName:s.name,serviceCenter:r.serviceCenter||r.department||"general",loginTime:(new Date).toISOString(),logoutTime:null,status:"active",ordersCount:0,totalSales:0,itemsSold:[]};await Bp(Am(dv,"artifacts",fv,"public","data","staffShifts",e.uid),t)}}catch(t){console.error("Error starting shift:",t)}"admin"===r.role||"supervisor"===r.role?o("dashboard"):r.department&&(j(yv.find(e=>e.id===r.department)),o("fo"===r.department?"frontoffice":"pos"))}else{const t={name:e.displayName||e.email,email:e.email,role:"admin",department:null,createdAt:(new Date).toISOString()};await Bp(Am(dv,"artifacts",fv,"public","data","users",e.uid),t),i(c(c({},t),{},{id:e.uid,photo:e.photoURL})),o("dashboard")}}catch(r){console.error("Error fetching user role:",r),i({name:e.displayName||e.email,role:"admin",id:e.uid,email:e.email,photo:e.photoURL}),o("dashboard")}else i(null),o("login");I(!0)});return e},[]),(0,r.useEffect)(()=>{if(s&&0===f.length&&(m(vv),g(zg)),!t||!s)return;const e=Gp(Tm(dv,"artifacts",fv,"public","data","rooms"),e=>{e.empty?(vv.forEach(e=>Bp(Am(dv,"artifacts",fv,"public","data","rooms",e.id),e)),m(vv)):m(e.docs.map(e=>c({id:e.id},e.data())).sort((e,t)=>(parseInt(e.number.replace(/\D/g,""))||0)-(parseInt(t.number.replace(/\D/g,""))||0)))},()=>m(vv)),n=Gp(Tm(dv,"artifacts",fv,"public","data","menuItems"),e=>{e.empty?(zg.forEach(e=>Bp(Am(dv,"artifacts",fv,"public","data","menuItems",e.id),e)),g(zg)):g(e.docs.map(e=>c({id:e.id},e.data())))},()=>g(zg));return()=>{e(),n()}},[t,s,f.length]);const F=e=>{h(e=>[...e,a]),o(e)};return _?(0,Ug.jsxs)("div",{className:"h-screen w-screen bg-slate-100 font-sans text-slate-800 overflow-hidden flex flex-col",children:["login"!==a&&(0,Ug.jsxs)("header",{className:"h-14 bg-slate-900 text-white flex items-center justify-between px-6 shadow-md z-10 shrink-0",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[d.length>0&&(0,Ug.jsx)("button",{onClick:()=>{if(0===d.length)return void("admin"===(null===s||void 0===s?void 0:s.role)&&o("dashboard"));const e=d[d.length-1];"login"===e&&t?h([]):(h(e=>e.slice(0,-1)),o(e))},className:"p-1.5 bg-slate-700 hover:bg-slate-600 rounded-full mr-2",children:(0,Ug.jsx)(y,{size:18})}),(0,Ug.jsx)("div",{className:"bg-blue-500 p-1.5 rounded-lg",children:(0,Ug.jsx)(x,{size:20})}),(0,Ug.jsx)("h1",{className:"font-bold text-lg tracking-wide",children:"SOURCE GARDEN HMS"}),v&&(0,Ug.jsx)("span",{className:"bg-slate-700 px-3 py-1 rounded-full text-xs text-blue-200 uppercase",children:v.name}),E&&(0,Ug.jsx)("span",{className:"px-3 py-1 rounded-full text-xs uppercase font-bold flex items-center gap-1 ".concat(A?"bg-emerald-600":"bg-red-600"),children:A?(0,Ug.jsxs)(Ug.Fragment,{children:[(0,Ug.jsx)(b,{size:12})," Shift Open"]}):(0,Ug.jsxs)(Ug.Fragment,{children:[(0,Ug.jsx)(w,{size:12})," Shift Closed"]})}),"stock"===a&&(0,Ug.jsx)("span",{className:"bg-amber-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Stock Sheet"}),"voids"===a&&(0,Ug.jsx)("span",{className:"bg-red-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Void Logs"}),"report"===a&&(0,Ug.jsx)("span",{className:"bg-emerald-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Daily Report"}),"expenses"===a&&(0,Ug.jsx)("span",{className:"bg-rose-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Expenses"}),"calendar"===a&&(0,Ug.jsx)("span",{className:"bg-indigo-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Bookings Calendar"}),"events"===a&&(0,Ug.jsx)("span",{className:"bg-purple-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Events"}),"stockmanagement"===a&&(0,Ug.jsx)("span",{className:"bg-teal-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Stock Management"}),"requisitions"===a&&(0,Ug.jsx)("span",{className:"bg-orange-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Requisitions"}),"performance"===a&&(0,Ug.jsx)("span",{className:"bg-violet-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Performance"}),"supervisor"===a&&(0,Ug.jsx)("span",{className:"bg-fuchsia-600 px-3 py-1 rounded-full text-xs uppercase font-bold",children:"Supervisor"}),D&&(0,Ug.jsxs)("span",{className:"bg-blue-500 px-3 py-1 rounded-full text-xs uppercase font-bold flex items-center gap-1",children:[(0,Ug.jsx)(N,{size:12})," On Shift"]}),"v2_finance"===a&&(0,Ug.jsxs)("span",{className:"bg-blue-700 px-3 py-1 rounded-full text-xs uppercase font-bold flex items-center gap-1",children:[(0,Ug.jsx)(S,{size:12})," Finance V2"]})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ug.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,Ug.jsx)("p",{className:"text-sm font-semibold",children:null===s||void 0===s?void 0:s.name}),(0,Ug.jsx)("p",{className:"text-xs text-slate-400",children:(null===s||void 0===s?void 0:s.email)||(null===s||void 0===s||null===(e=s.role)||void 0===e?void 0:e.toUpperCase())})]}),(null===s||void 0===s?void 0:s.photo)&&(0,Ug.jsx)("img",{src:s.photo,alt:"",className:"w-8 h-8 rounded-full border-2 border-slate-600"}),(0,Ug.jsx)("button",{onClick:()=>{"admin"===(null===s||void 0===s?void 0:s.role)&&(h([]),o("dashboard"))},className:"p-2 hover:bg-slate-700 rounded-full",children:(0,Ug.jsx)(x,{size:20})}),(0,Ug.jsx)("button",{onClick:async()=>{if(D&&null!==s&&void 0!==s&&s.id)try{await P({endReason:"logout"})}catch(e){console.error("Error ending shift:",e)}await uv.signOut(),i(null),h([]),o("login"),j(null)},className:"p-2 bg-red-600 hover:bg-red-700 rounded-full",children:(0,Ug.jsx)(k,{size:18})})]})]}),(0,Ug.jsxs)("main",{className:"flex-1 overflow-hidden relative",children:["login"===a&&(0,Ug.jsx)(wv,{onEmailLogin:async(e,t)=>{try{await function(e,t,n){return Gt(e.app)?Promise.reject(yn(e)):ds(Re(e),Jr.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&hs(e),t})}(uv,e,t)}catch(n){if("auth/user-not-found"!==n.code&&"auth/invalid-credential"!==n.code)throw n;if(!mv.find(t=>t.email.toLowerCase()===e.toLowerCase())||"sourcegarden2024"!==t)throw new Error("Invalid credentials. Use your email and password: sourcegarden2024");try{await async function(e,t,n){if(Gt(e.app))return Promise.reject(yn(e));const r=jr(e),s=Or(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rs,"EMAIL_PASSWORD_PROVIDER"),i=await s.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&hs(e),t}),a=await ss._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(a.user),a}(uv,e,t)}catch(r){if("auth/email-already-in-use"===r.code)throw new Error("Wrong password. Use: sourcegarden2024");throw r}}},onGoogleLogin:async()=>{await async function(e,t,n){if(Gt(e.app))return Promise.reject(gn(e,"operation-not-supported-in-this-environment"));const r=jr(e);xn(e,t,Yr);const s=qs(r,n);return new Js(r,"signInViaPopup",t,s).executeNotNull()}(uv,hv)}}),"dashboard"===a&&(0,Ug.jsx)(Nv,{onSelectDept:e=>{j(e),F("fo"===e.id?"frontoffice":"pos")},onOpenFinance:()=>F("v2_finance"),onOpenStock:()=>F("stock"),onOpenVoids:()=>F("voids"),onOpenReport:()=>F("report"),onOpenExpenses:()=>F("expenses"),onOpenShiftControl:()=>F("shiftcontrol"),onOpenCalendar:()=>F("calendar"),onOpenEvents:()=>F("events"),onOpenStockManagement:()=>F("stockmanagement"),onOpenRequisitions:()=>F("requisitions"),onOpenPerformance:()=>F("performance"),onOpenSupervisor:()=>F("supervisor"),workPeriod:E,workPeriodOpen:A,userRole:null===s||void 0===s?void 0:s.role}),"frontoffice"===a&&(0,Ug.jsx)(Sv,{rooms:f,workPeriodOpen:A}),"v2_finance"===a&&(0,Ug.jsx)(av,{db:dv,appId:fv,userRole:null===s||void 0===s?void 0:s.role,staffName:null===s||void 0===s?void 0:s.name,onNavigateHome:()=>o("dashboard")}),"pos"===a&&!l&&(0,Ug.jsx)(Vg,{db:dv,appId:fv,department:v,staffName:null===s||void 0===s?void 0:s.name,onSelectTicket:e=>u(e),onBack:()=>{j(null),o("dashboard")}}),"pos"===a&&l&&(0,Ug.jsx)(jv,{menu:p,department:v,rooms:f,staffName:null===s||void 0===s?void 0:s.name,workPeriodOpen:A,workPeriod:E,activeFolio:l,onNavigateToDashboard:()=>{o("dashboard"),j(null),u(null)}}),"stock"===a&&(0,Ug.jsx)(Ov,{menu:p}),"voids"===a&&(0,Ug.jsx)(Lv,{}),"report"===a&&(0,Ug.jsx)(Mv,{rooms:f}),"expenses"===a&&(0,Ug.jsx)(zv,{staffName:null===s||void 0===s?void 0:s.name}),"calendar"===a&&(0,Ug.jsx)(Bv,{rooms:f}),"events"===a&&(0,Ug.jsx)(Kv,{staffName:null===s||void 0===s?void 0:s.name}),"stockmanagement"===a&&(0,Ug.jsx)(Jv,{menu:p,staffName:null===s||void 0===s?void 0:s.name,userRole:null===s||void 0===s?void 0:s.role}),"requisitions"===a&&(0,Ug.jsx)(Yv,{staffName:null===s||void 0===s?void 0:s.name,userRole:null===s||void 0===s?void 0:s.role,serviceCenter:(null===s||void 0===s?void 0:s.serviceCenter)||(null===s||void 0===s?void 0:s.department)}),"performance"===a&&(0,Ug.jsx)($v,{staffName:null===s||void 0===s?void 0:s.name,userRole:null===s||void 0===s?void 0:s.role}),"supervisor"===a&&(0,Ug.jsx)(Zv,{staffName:null===s||void 0===s?void 0:s.name})]})]}):(0,Ug.jsx)("div",{className:"h-screen flex items-center justify-center bg-slate-900 text-white",children:"Starting Source Garden System..."})}const wv=e=>{let{onEmailLogin:t,onGoogleLogin:n}=e;const[s,i]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)("");return(0,Ug.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-slate-900",children:(0,Ug.jsxs)("div",{className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-2xl",children:[(0,Ug.jsxs)("div",{className:"text-center mb-8",children:[(0,Ug.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,Ug.jsx)(x,{size:32,className:"text-white"})}),(0,Ug.jsx)("h2",{className:"text-3xl font-bold text-slate-800",children:"Source Garden"}),(0,Ug.jsx)("p",{className:"text-slate-500 mt-2",children:"Hotel Management System"})]}),h&&(0,Ug.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h}),l?(0,Ug.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0),f("");try{await t(s,a)}catch(n){f(n.message||"Invalid credentials")}d(!1)},className:"space-y-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Staff Email"}),(0,Ug.jsx)("input",{type:"email",className:"w-full p-3 border rounded-lg",placeholder:"name@sourcegarden.ug",value:s,onChange:e=>i(e.target.value),required:!0})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),(0,Ug.jsx)("input",{type:"password",className:"w-full p-3 border rounded-lg",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:a,onChange:e=>o(e.target.value),required:!0})]}),(0,Ug.jsx)("button",{type:"submit",disabled:u,className:"w-full h-14 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 disabled:opacity-50",children:u?"Signing in...":"Sign In"}),(0,Ug.jsx)("button",{type:"button",onClick:()=>{c(!1),f("")},className:"w-full text-sm text-slate-400 hover:text-slate-600",children:"\u2190 Back to Google Sign-in"})]}):(0,Ug.jsxs)("div",{className:"space-y-4",children:[(0,Ug.jsxs)("button",{onClick:async()=>{d(!0),f("");try{await n()}catch(e){f(e.message||"Sign-in failed")}d(!1)},disabled:u,className:"w-full h-14 bg-white border-2 border-slate-200 rounded-xl font-semibold text-slate-700 hover:bg-slate-50 flex items-center justify-center gap-3 disabled:opacity-50",children:[(0,Ug.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,Ug.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,Ug.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,Ug.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,Ug.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),u?"Signing in...":"Sign in with Google (Admin)"]}),(0,Ug.jsxs)("div",{className:"relative",children:[(0,Ug.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Ug.jsx)("div",{className:"w-full border-t border-slate-200"})}),(0,Ug.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Ug.jsx)("span",{className:"px-4 bg-white text-slate-400",children:"or"})})]}),(0,Ug.jsxs)("button",{onClick:()=>c(!0),className:"w-full h-14 bg-slate-100 rounded-xl font-semibold text-slate-600 hover:bg-slate-200 flex items-center justify-center gap-2",children:[(0,Ug.jsx)(j,{size:18})," Staff Login"]})]})]})})},Nv=e=>{let{onSelectDept:t,onOpenStock:n,onOpenVoids:r,onOpenReport:s,onOpenExpenses:i,onOpenShiftControl:a,onOpenCalendar:o,onOpenEvents:l,onOpenStockManagement:c,onOpenRequisitions:u,onOpenPerformance:d,onOpenSupervisor:h,onOpenFinance:f,workPeriod:m,workPeriodOpen:p,userRole:g}=e;return(0,Ug.jsx)("div",{className:"h-full overflow-y-auto p-6 bg-slate-100",children:(0,Ug.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ug.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-6",children:"Service Centers"}),(0,Ug.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:yv.map(e=>(0,Ug.jsxs)("button",{onClick:()=>t(e),className:"".concat(e.color," h-32 rounded-xl p-4 text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all flex flex-col items-center justify-center gap-2"),children:[(0,Ug.jsx)(e.icon,{size:36,className:"opacity-90"}),(0,Ug.jsx)("span",{className:"text-sm font-bold text-center",children:e.name})]},e.id))}),(0,Ug.jsxs)("h2",{className:"text-2xl font-bold text-slate-800 mt-10 mb-6 flex items-center gap-2",children:[(0,Ug.jsx)(_,{className:"text-teal-600"})," Operations Management"]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,Ug.jsxs)("button",{onClick:c,className:"bg-gradient-to-br from-teal-500 to-teal-700 p-6 rounded-xl shadow-lg hover:shadow-xl text-white text-left group",children:[(0,Ug.jsx)(I,{className:"mb-3",size:28}),(0,Ug.jsx)("h3",{className:"font-bold",children:"Stock Management"}),(0,Ug.jsx)("p",{className:"text-xs text-teal-100 mt-1",children:"3-tier inventory system"})]}),(0,Ug.jsxs)("button",{onClick:u,className:"bg-gradient-to-br from-orange-500 to-orange-700 p-6 rounded-xl shadow-lg hover:shadow-xl text-white text-left group",children:[(0,Ug.jsx)(E,{className:"mb-3",size:28}),(0,Ug.jsx)("h3",{className:"font-bold",children:"Requisitions"}),(0,Ug.jsx)("p",{className:"text-xs text-orange-100 mt-1",children:"Request & approve stock"})]}),(0,Ug.jsxs)("button",{onClick:d,className:"bg-gradient-to-br from-violet-500 to-violet-700 p-6 rounded-xl shadow-lg hover:shadow-xl text-white text-left group",children:[(0,Ug.jsx)(C,{className:"mb-3",size:28}),(0,Ug.jsx)("h3",{className:"font-bold",children:"Performance"}),(0,Ug.jsx)("p",{className:"text-xs text-violet-100 mt-1",children:"Staff sales & targets"})]}),("admin"===g||"supervisor"===g)&&(0,Ug.jsxs)("button",{onClick:h,className:"bg-gradient-to-br from-fuchsia-500 to-fuchsia-700 p-6 rounded-xl shadow-lg hover:shadow-xl text-white text-left group",children:[(0,Ug.jsx)(T,{className:"mb-3",size:28}),(0,Ug.jsx)("h3",{className:"font-bold",children:"Supervisor"}),(0,Ug.jsx)("p",{className:"text-xs text-fuchsia-100 mt-1",children:"Real-time oversight"})]})]}),(0,Ug.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mt-10 mb-6",children:"Administrative Tools"}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:["admin"===g&&(0,Ug.jsx)(Jg,{db:dv,appId:fv}),"admin"===g&&(0,Ug.jsx)(Bg,{db:dv,appId:fv}),(0,Ug.jsxs)("button",{onClick:s,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-emerald-500 group",children:[(0,Ug.jsx)(A,{className:"text-slate-600 mb-2 group-hover:text-emerald-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-emerald-600",children:"Daily Report"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Revenue & collections"})]}),(0,Ug.jsxs)("button",{onClick:n,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-amber-500 group",children:[(0,Ug.jsx)(D,{className:"text-slate-600 mb-2 group-hover:text-amber-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-amber-600",children:"Bar Stock Sheet"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Drinks inventory (legacy)"})]}),(0,Ug.jsxs)("button",{onClick:i,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-rose-500 group",children:[(0,Ug.jsx)(R,{className:"text-slate-600 mb-2 group-hover:text-rose-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-rose-600",children:"Expenses"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Petty cash & payouts"})]}),(0,Ug.jsxs)("button",{onClick:r,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-red-500 group",children:[(0,Ug.jsx)(P,{className:"text-slate-600 mb-2 group-hover:text-red-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-red-600",children:"Void Reports"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Cancelled items audit"})]}),(0,Ug.jsxs)("button",{onClick:o,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-indigo-500 group",children:[(0,Ug.jsx)(O,{className:"text-slate-600 mb-2 group-hover:text-indigo-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-indigo-600",children:"Bookings Calendar"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Room reservations"})]}),(0,Ug.jsxs)("button",{onClick:l,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-purple-500 group",children:[(0,Ug.jsx)(L,{className:"text-slate-600 mb-2 group-hover:text-purple-500",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm group-hover:text-purple-600",children:"Events"}),(0,Ug.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Conferences & functions"})]}),"admin"===g&&(0,Ug.jsxs)("button",{onClick:f,className:"bg-white p-5 rounded-xl shadow-sm hover:shadow-md border border-slate-200 text-left hover:border-blue-700 bg-blue-50/50 group",children:[(0,Ug.jsx)(S,{className:"text-blue-600 mb-2 group-hover:text-blue-700",size:24}),(0,Ug.jsx)("h3",{className:"font-semibold text-sm text-blue-800 group-hover:text-blue-900",children:"Finance & Audit"}),(0,Ug.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"V2 Folios & Invoices"})]})]})]})})},Sv=e=>{var t;let{rooms:n,workPeriodOpen:s}=e;const[i,a]=(0,r.useState)(null),[o,l]=(0,r.useState)(!1),[u,d]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[v,y]=(0,r.useState)((new Date).toISOString().split("T")[0]),[x,b]=(0,r.useState)(()=>{const e=new Date;return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]}),[w,N]=(0,r.useState)(1),[S,k]=(0,r.useState)(0),[j,_]=(0,r.useState)(""),[I,E]=(0,r.useState)(!1),[C,T]=(0,r.useState)(null),A=Math.max(1,Math.ceil((new Date(x)-new Date(v))/864e5)),D=()=>{d(""),m(""),g(""),y((new Date).toISOString().split("T")[0]);const e=new Date;e.setDate(e.getDate()+1),b(e.toISOString().split("T")[0]),N(1),k(0),_("")},R=e=>({occupied:"bg-red-500",dirty:"bg-amber-500"}[e]||"bg-emerald-500"),P={total:n.length,occupied:n.filter(e=>"occupied"===e.status).length,available:n.filter(e=>"clean"===e.status).length,dirty:n.filter(e=>"dirty"===e.status).length};return(0,Ug.jsx)("div",{className:"h-full overflow-y-auto p-6 bg-slate-100",children:(0,Ug.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,Ug.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border",children:[(0,Ug.jsx)("div",{className:"text-2xl font-bold",children:P.total}),(0,Ug.jsx)("div",{className:"text-sm text-slate-500",children:"Total Rooms"})]}),(0,Ug.jsxs)("div",{className:"bg-emerald-50 p-4 rounded-xl shadow-sm border border-emerald-200",children:[(0,Ug.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:P.available}),(0,Ug.jsx)("div",{className:"text-sm text-emerald-700",children:"Available"})]}),(0,Ug.jsxs)("div",{className:"bg-red-50 p-4 rounded-xl shadow-sm border border-red-200",children:[(0,Ug.jsx)("div",{className:"text-2xl font-bold text-red-600",children:P.occupied}),(0,Ug.jsx)("div",{className:"text-sm text-red-700",children:"Occupied"})]}),(0,Ug.jsxs)("div",{className:"bg-amber-50 p-4 rounded-xl shadow-sm border border-amber-200",children:[(0,Ug.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:P.dirty}),(0,Ug.jsx)("div",{className:"text-sm text-amber-700",children:"Needs Cleaning"})]})]}),(0,Ug.jsxs)("div",{className:"flex gap-4 mb-4 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-4 h-4 rounded bg-emerald-500"})," Available"]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-4 h-4 rounded bg-red-500"})," Occupied"]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-4 h-4 rounded bg-amber-500"})," Dirty"]})]}),(0,Ug.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-3",children:0===n.length?(0,Ug.jsxs)("div",{className:"col-span-full text-center py-12 text-slate-400",children:[(0,Ug.jsx)(f,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,Ug.jsx)("p",{children:"Loading rooms..."})]}):n.map(e=>{var t,n;return(0,Ug.jsxs)("button",{onClick:()=>{a(e),"clean"===e.status&&l(!0)},className:"".concat(R(e.status)," p-3 rounded-xl text-center shadow-md text-white transition-all hover:scale-105"),children:[(0,Ug.jsx)("div",{className:"font-bold text-sm",children:e.number}),(0,Ug.jsx)("div",{className:"text-xs opacity-80",children:"occupied"===e.status?(null===(t=e.guest)||void 0===t||null===(n=t.name)||void 0===n?void 0:n.split(" ")[0])||"Guest":"dirty"===e.status?"Dirty":"Available"})]},e.id)})}),i&&!o&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>a(null),children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,Ug.jsxs)("div",{className:"p-6 text-white ".concat(R(i.status)," shrink-0"),children:[(0,Ug.jsx)("h3",{className:"text-2xl font-bold",children:i.number}),(0,Ug.jsxs)("p",{className:"opacity-80",children:[i.type," \u2022 ",i.price.toLocaleString()," UGX/night"]})]}),(0,Ug.jsxs)("div",{className:"p-6 overflow-y-auto flex-1",children:["occupied"===i.status&&i.guest&&(0,Ug.jsxs)(Ug.Fragment,{children:[(0,Ug.jsxs)("div",{className:"space-y-2 mb-4 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Guest:"}),(0,Ug.jsx)("span",{className:"font-semibold",children:i.guest.name})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Phone:"}),(0,Ug.jsx)("span",{children:i.guest.phone||"N/A"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Check-In:"}),(0,Ug.jsx)("span",{className:"text-emerald-600 font-medium",children:i.guest.checkIn})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Check-Out:"}),(0,Ug.jsx)("span",{className:"text-red-600 font-medium",children:i.guest.checkOut})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Nights:"}),(0,Ug.jsx)("span",{children:i.guest.nights})]})]}),(0,Ug.jsx)("div",{className:"mb-4",children:(0,Ug.jsx)(Wg,{db:dv,appId:fv,roomId:i.id})}),(0,Ug.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,Ug.jsxs)("h4",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[(0,Ug.jsx)(M,{size:16})," Room Charges"]}),(0,Ug.jsxs)("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:[(0,Ug.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ug.jsxs)("span",{children:["Room (",i.guest.nights," nights \xd7 ",i.price.toLocaleString(),")"]}),(0,Ug.jsx)("span",{className:"font-mono",children:(i.price*i.guest.nights).toLocaleString()})]}),i.guest.charges&&i.guest.charges.length>0?i.guest.charges.map((e,t)=>(0,Ug.jsxs)("div",{className:"flex justify-between text-sm border-t pt-1",children:[(0,Ug.jsx)("span",{className:"text-slate-600",children:e.description}),(0,Ug.jsx)("span",{className:"font-mono text-amber-600",children:e.amount.toLocaleString()})]},t)):(0,Ug.jsx)("div",{className:"text-xs text-slate-400 italic",children:"No additional charges"})]}),(0,Ug.jsx)("div",{className:"border-t-2 border-slate-300 pt-3 mt-3",children:(0,Ug.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,Ug.jsx)("span",{children:"TOTAL BALANCE"}),(0,Ug.jsxs)("span",{className:"text-emerald-600",children:[(i.price*i.guest.nights+((null===(t=i.guest.charges)||void 0===t?void 0:t.reduce((e,t)=>e+t.amount,0))||0)).toLocaleString()," UGX"]})]})})]})]}),(0,Ug.jsxs)("div",{className:"flex gap-3 mt-6",children:["clean"===i.status&&(0,Ug.jsx)(xv,{variant:"success",className:"flex-1",onClick:()=>l(!0),children:"Check In"}),"occupied"===i.status&&(0,Ug.jsxs)(Ug.Fragment,{children:[(0,Ug.jsxs)(xv,{variant:"secondary",className:"flex-1",onClick:()=>{T(i),E(!0)},children:[(0,Ug.jsx)(F,{size:16,className:"mr-1"})," Laundry"]}),(0,Ug.jsx)(xv,{variant:"danger",className:"flex-1",onClick:()=>(async e=>{var t;if(!window.confirm("Check out ".concat(null===(t=e.guest)||void 0===t?void 0:t.name," from ").concat(e.number,"?")))return;const n={roomId:e.id,roomNumber:e.number,guest:e.guest,checkoutTime:(new Date).toISOString(),status:"pending_checkout"},r="checkout_archive_".concat(e.id,"_").concat(Date.now());localStorage.setItem(r,JSON.stringify(n));try{const t="CO-".concat(Date.now(),"-").concat(e.id);if(await Bp(Am(dv,"artifacts",fv,"public","data","checkouts",t),c(c({},n),{},{status:"completed"})),await qp(Am(dv,"artifacts",fv,"public","data","rooms",e.id),{status:"dirty",guest:null}),Mg()){var s,i,o,l,u;const n=e.price*(null===(s=e.guest)||void 0===s?void 0:s.nights)+((null===(i=e.guest)||void 0===i||null===(o=i.charges)||void 0===o?void 0:o.reduce((e,t)=>e+t.amount,0))||0);await Og(dv,fv,e.id,{paymentMethod:"CASH",amountPaid:n,total:n},t,(null===(l=uv.currentUser)||void 0===l?void 0:l.uid)||"unknown",(null===(u=e.guest)||void 0===u?void 0:u.name)||"Staff")}localStorage.removeItem(r),alert("\u2713 Checked out from ".concat(e.number)),a(null)}catch(d){alert("Check-out failed (guest data preserved locally): "+d.message)}})(i),children:"Check Out"})]}),"dirty"===i.status&&(0,Ug.jsx)(xv,{variant:"success",className:"flex-1",onClick:()=>(async e=>{try{await qp(Am(dv,"artifacts",fv,"public","data","rooms",e.id),{status:"clean"}),alert("\u2713 ".concat(e.number," marked clean")),a(null)}catch(t){alert("Failed: "+t.message)}})(i),children:"Mark Clean"}),(0,Ug.jsx)(xv,{variant:"secondary",onClick:()=>a(null),children:"Close"})]})]})]})}),I&&C&&(0,Ug.jsx)(kv,{room:C,onClose:()=>{E(!1),T(null)}}),o&&i&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden my-4",children:[(0,Ug.jsxs)("div",{className:"p-6 bg-emerald-600 text-white",children:[(0,Ug.jsxs)("h3",{className:"text-xl font-bold",children:["Check In - ",i.number]}),(0,Ug.jsxs)("p",{className:"opacity-80",children:[i.type," \u2022 ",i.price.toLocaleString()," UGX/night"]})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{className:"col-span-2",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Guest Name *"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",placeholder:"Full name",value:u,onChange:e=>d(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone"}),(0,Ug.jsx)("input",{type:"tel",className:"w-full p-3 border rounded-lg",placeholder:"+256...",value:h,onChange:e=>m(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ID/Passport"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",value:p,onChange:e=>g(e.target.value)})]})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Check-In Date *"}),(0,Ug.jsx)("input",{type:"date",className:"w-full p-3 border rounded-lg",value:v,onChange:e=>y(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Check-Out Date *"}),(0,Ug.jsx)("input",{type:"date",className:"w-full p-3 border rounded-lg",value:x,min:v,onChange:e=>b(e.target.value)})]})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Adults"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",min:"1",value:w,onChange:e=>N(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Children"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",min:"0",value:S,onChange:e=>k(e.target.value)})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,Ug.jsx)("textarea",{className:"w-full p-3 border rounded-lg",rows:"2",value:j,onChange:e=>_(e.target.value)})]}),(0,Ug.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,Ug.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ug.jsx)("span",{children:"Duration:"}),(0,Ug.jsxs)("span",{children:[A," night",A>1?"s":""]})]}),(0,Ug.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between font-bold text-lg",children:[(0,Ug.jsx)("span",{children:"Total:"}),(0,Ug.jsxs)("span",{className:"text-emerald-600",children:[(i.price*A).toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"flex gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:()=>{l(!1),a(null),D()},children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"success",className:"flex-1",onClick:async()=>{if(!u||!i)return void alert("Please enter guest name");const e={roomId:i.id,roomNumber:i.number,status:"occupied",guest:{name:u,phone:h,idNumber:p,checkIn:v,checkOut:x,nights:A,adults:parseInt(w),children:parseInt(S),notes:j,charges:[],createdAt:(new Date).toISOString()}},t="pending_checkin_".concat(i.id);localStorage.setItem(t,JSON.stringify(e));try{var n;if(await qp(Am(dv,"artifacts",fv,"public","data","rooms",i.id),{status:e.status,guest:e.guest}),Mg())await Rg(dv,fv,i,{name:u,contact:h,nightsBooked:A,adults:parseInt(w),children:parseInt(S)},(null===(n=uv.currentUser)||void 0===n?void 0:n.uid)||"unknown",u);localStorage.removeItem(t),alert("\u2713 ".concat(u," checked into ").concat(i.number)),l(!1),a(null),D()}catch(r){alert("Check-in failed (saved locally): "+r.message)}},disabled:!u,children:"Confirm Check-In"})]})]})]})})]})})},kv=e=>{var t;let{room:n,onClose:s}=e;const[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(!1),u=zg.filter(e=>"FO Laundry"===e.category),d=e=>{a(i.filter(t=>t.id!==e))},h=(e,t)=>{t<1?d(e):a(i.map(n=>n.id===e?c(c({},n),{},{qty:t}):n))},f=i.reduce((e,t)=>e+t.price*t.qty,0);return(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"p-6 bg-blue-600 text-white",children:[(0,Ug.jsxs)("h3",{className:"text-xl font-bold",children:["Laundry Services - ",n.number]}),(0,Ug.jsxs)("p",{className:"opacity-80",children:["Guest: ",null===(t=n.guest)||void 0===t?void 0:t.name]})]}),(0,Ug.jsxs)("div",{className:"p-6",children:[(0,Ug.jsxs)("div",{className:"mb-4",children:[(0,Ug.jsx)("h4",{className:"font-bold text-slate-700 mb-2",children:"Available Services"}),(0,Ug.jsx)("div",{className:"grid grid-cols-2 gap-2",children:u.map(e=>(0,Ug.jsxs)("button",{onClick:()=>(e=>{const t=i.find(t=>t.id===e.id);a(t?i.map(t=>t.id===e.id?c(c({},t),{},{qty:t.qty+1}):t):[...i,c(c({},e),{},{qty:1})])})(e),className:"p-3 text-left bg-slate-50 hover:bg-blue-50 rounded-lg border hover:border-blue-300 transition-colors",children:[(0,Ug.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500",children:[e.price.toLocaleString()," UGX"]})]},e.id))})]}),i.length>0&&(0,Ug.jsxs)("div",{className:"mb-4",children:[(0,Ug.jsx)("h4",{className:"font-bold text-slate-700 mb-2",children:"Selected Items"}),(0,Ug.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:i.map(e=>(0,Ug.jsxs)("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-lg",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500",children:[e.price.toLocaleString()," \xd7 ",e.qty]})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("button",{onClick:()=>h(e.id,e.qty-1),className:"w-8 h-8 bg-white rounded border text-lg font-bold",children:"-"}),(0,Ug.jsx)("span",{className:"w-8 text-center font-bold",children:e.qty}),(0,Ug.jsx)("button",{onClick:()=>h(e.id,e.qty+1),className:"w-8 h-8 bg-white rounded border text-lg font-bold",children:"+"}),(0,Ug.jsx)("button",{onClick:()=>d(e.id),className:"text-red-500 ml-2",children:(0,Ug.jsx)(U,{size:18})})]})]},e.id))}),(0,Ug.jsxs)("div",{className:"border-t pt-3 mt-3 flex justify-between font-bold text-lg",children:[(0,Ug.jsx)("span",{children:"Total:"}),(0,Ug.jsxs)("span",{className:"text-blue-600",children:[f.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"flex gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:s,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"primary",className:"flex-1",onClick:async()=>{if(0!==i.length){l(!0);try{var e;const r="Laundry: ".concat(i.map(e=>"".concat(e.qty,"x ").concat(e.name)).join(", "));await qp(Am(dv,"artifacts",fv,"public","data","rooms",n.id),{"guest.charges":Zp({description:r,amount:f,date:(new Date).toISOString(),type:"laundry",items:i.map(e=>({name:e.name,qty:e.qty,price:e.price})),processedBy:"Front Office"})});const a="LAUNDRY-".concat(Date.now());var t;if(await Bp(Am(dv,"artifacts",fv,"public","data","laundryOrders",a),{id:a,roomId:n.id,roomNumber:n.number,guestName:null===(e=n.guest)||void 0===e?void 0:e.name,items:i,total:f,status:"pending",createdAt:(new Date).toISOString(),department:"fo"}),Mg())await Pg(dv,fv,n.id,r,f,(null===(t=uv.currentUser)||void 0===t?void 0:t.uid)||"unknown","Front Office");alert("\u2713 Laundry order added to Room ".concat(n.number,"\nTotal: ").concat(f.toLocaleString()," UGX")),s()}catch(r){alert("Error: "+r.message)}finally{l(!1)}}},disabled:0===i.length||o,children:o?"Processing...":"Add to Room Bill"})]})]})]})})},jv=e=>{var t;let{menu:n,department:s,rooms:i,staffName:a,workPeriodOpen:o,workPeriod:l,activeFolio:u,onNavigateToDashboard:d}=e;const h=!!u,f=function(e){const t="sourcegarden_pos_cart_".concat(e||"default"),[n,s]=(0,r.useState)(()=>{try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return[]}});return(0,r.useEffect)(()=>{try{const e=localStorage.getItem(t);s(e?JSON.parse(e):[])}catch(e){s([])}},[t]),(0,r.useEffect)(()=>{localStorage.setItem(t,JSON.stringify(n))},[n,t]),{cart:n,setCart:s,clearCart:()=>{localStorage.removeItem(t),s([])}}}(null===s||void 0===s?void 0:s.id),p=Fg(dv,fv,(null===u||void 0===u?void 0:u.id)||(null===u||void 0===u?void 0:u.folioId),null===(t=uv.currentUser)||void 0===t?void 0:t.uid,a,s),g=h?p.cart:f.cart,{setCart:v}=f,y=h?p.clearCart:f.clearCart,{queue:x,enqueue:b,dequeue:w}=function(){const[e,t]=(0,r.useState)(()=>{try{const e=localStorage.getItem("sourcegarden_tx_queue");return e?JSON.parse(e):[]}catch(e){return[]}}),[n,s]=(0,r.useState)(!1);(0,r.useEffect)(()=>{localStorage.setItem("sourcegarden_tx_queue",JSON.stringify(e))},[e]);const i=(0,r.useCallback)(e=>t(t=>[...t,e]),[]),a=(0,r.useCallback)(e=>t(t=>t.filter(t=>t.id!==e)),[]);return(0,r.useEffect)(()=>{const r=async()=>{if(!n&&0!==e.length){s(!0);for(const n of e)try{await Bp(Am(dv,"artifacts",fv,"public","data","sales",n.id),c(c({},n),{},{status:"confirmed",synced:!0,syncedAt:(new Date).toISOString()})),Mg()&&await Lg(dv,fv,n),t(e=>e.filter(e=>e.id!==n.id)),console.log("Synced offline TX: ".concat(n.id))}catch(r){console.error("Failed to sync TX ".concat(n.id,":"),r);break}s(!1)}};return r(),window.addEventListener("online",r),()=>window.removeEventListener("online",r)},[e,n]),{queue:e,enqueue:i,dequeue:a,syncing:n}}(),{voidQueue:N,enqueueVoid:S,dequeueVoid:k}=function(){const[e,t]=(0,r.useState)(()=>{try{const e=localStorage.getItem("sourcegarden_pending_voids");return e?JSON.parse(e):[]}catch(e){return[]}}),[n,s]=(0,r.useState)(!1);(0,r.useEffect)(()=>{localStorage.setItem("sourcegarden_pending_voids",JSON.stringify(e))},[e]);const i=(0,r.useCallback)(e=>t(t=>[...t,e]),[]),a=(0,r.useCallback)(e=>t(t=>t.filter(t=>t.id!==e)),[]);return(0,r.useEffect)(()=>{const r=async()=>{if(!n&&0!==e.length){s(!0);for(const n of e)try{await Bp(Am(dv,"artifacts",fv,"public","data","voids",n.id),c(c({},n),{},{synced:!0,syncedAt:(new Date).toISOString()})),t(e=>e.filter(e=>e.id!==n.id)),console.log("Synced offline VOID: ".concat(n.id))}catch(r){console.error("Failed to sync VOID ".concat(n.id,":"),r);break}s(!1)}};return r(),window.addEventListener("online",r),()=>window.removeEventListener("online",r)},[e,n]),{voidQueue:e,enqueueVoid:i,dequeueVoid:a,syncingVoids:n}}(),[j,_]=(0,r.useState)("Breakfast"),[I,E]=(0,r.useState)(!1),[C,T]=(0,r.useState)(null),[A,D]=(0,r.useState)(!1),R=n.filter(e=>e.category===j),P=g.reduce((e,t)=>e+t.price*t.qty,0),O=Math.round(P/1.18),L=P-O,M=P;return(0,Ug.jsxs)("div",{className:"flex h-full bg-slate-100 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"w-96 bg-white border-r flex flex-col shadow-lg z-10",children:[(0,Ug.jsxs)("div",{className:"p-4 bg-slate-50 border-b",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("h2",{className:"font-bold text-slate-700",children:h?(null===u||void 0===u?void 0:u.ownerName)||(null===u||void 0===u?void 0:u.folioNumber)||"Open Ticket":"Current Order"}),h&&"PART_PAID"===(null===u||void 0===u?void 0:u.status)&&(0,Ug.jsx)("span",{className:"bg-amber-100 text-amber-800 text-xs px-2 py-0.5 rounded-full font-bold",children:"PART PAID"})]}),h&&(0,Ug.jsx)("div",{className:"text-xs text-slate-400 font-mono",children:null===u||void 0===u?void 0:u.folioNumber})]}),(0,Ug.jsx)("p",{className:"text-sm text-blue-600 mb-2",children:null===s||void 0===s?void 0:s.name}),(0,Ug.jsx)(lv,{onStaffSelected:T,currentDepartment:s}),(x.length>0||N.length>0)&&(0,Ug.jsxs)("div",{className:"text-xs text-amber-600 font-bold mt-1",children:[(0,Ug.jsx)(V,{size:12,className:"inline mr-1"}),x.length>0&&"".concat(x.length," sales"),x.length>0&&N.length>0&&", ",N.length>0&&"".concat(N.length," voids")," pending sync"]})]}),(0,Ug.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:0===g.length?(0,Ug.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-300",children:[(0,Ug.jsx)(m,{size:48,className:"mb-2"}),(0,Ug.jsx)("p",{children:"No items"})]}):g.map(e=>(0,Ug.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-50 rounded-lg border",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-medium",children:e.name}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500",children:[e.price.toLocaleString()," x ",e.qty]})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"font-bold",children:(e.price*e.qty).toLocaleString()}),(0,Ug.jsx)("button",{onClick:()=>(async e=>{if(h)return void alert("Voiding items from Open Tickets is not yet supported. Please ask manager.");if(!window.confirm("Void ".concat(e.qty,"x ").concat(e.name,"? This will be logged for audit.")))return;const t="VOID-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5)),n={id:t,item:e.name,itemId:e.id,qty:e.qty,price:e.price,total:e.price*e.qty,staff:a||"Staff",department:null===s||void 0===s?void 0:s.name,workPeriodId:(null===l||void 0===l?void 0:l.id)||"NO_PERIOD",date:(new Date).toISOString(),reason:"User voided from cart"};S(n),v(g.filter(t=>t.id!==e.id));try{await Bp(Am(dv,"artifacts",fv,"public","data","voids",t),c(c({},n),{},{synced:!0})),k(t)}catch(r){console.error("Void queued offline, will auto-sync:",r)}})(e),className:"text-red-400 hover:text-red-600 bg-red-50 p-1.5 rounded",title:"Void (logged)",children:(0,Ug.jsx)(z,{size:16})})]})]},e.id))}),(0,Ug.jsxs)("div",{className:"p-4 bg-white border-t",children:[(0,Ug.jsxs)("div",{className:"space-y-1 mb-4 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Subtotal"}),(0,Ug.jsxs)("span",{className:"font-medium",children:[P.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"VAT (18%)"}),(0,Ug.jsxs)("span",{className:"font-medium",children:[L.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between items-end pt-2 border-t",children:[(0,Ug.jsx)("span",{className:"text-slate-700 font-bold",children:"Total"}),(0,Ug.jsxs)("span",{className:"text-2xl font-bold",children:[M.toLocaleString()," ",(0,Ug.jsx)("span",{className:"text-sm font-normal text-slate-400",children:"UGX"})]})]})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Ug.jsx)(xv,{variant:"danger",onClick:()=>{window.confirm("Cancel order?")&&y()},disabled:0===g.length,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"success",onClick:()=>E(!0),disabled:0===g.length,children:"Settle"})]})]})]}),(0,Ug.jsx)("div",{className:"w-48 bg-slate-800 flex flex-col overflow-y-auto shrink-0",children:["Breakfast","Soups","Starters","Main Course","Pizza & Pasta","African","Snacks","Desserts","Beers & Sodas","Spirits","Fresh Juices","Health Club","Pool"].map(e=>(0,Ug.jsx)("button",{onClick:()=>_(e),className:"p-4 text-left border-b border-slate-700 ".concat(j===e?"bg-blue-600 text-white font-bold":"text-slate-300 hover:bg-slate-700"),children:e},e))}),(0,Ug.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:(0,Ug.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:R.map(e=>(0,Ug.jsxs)("button",{onClick:()=>(async e=>{if(h){if(A)return;D(!0);try{await p.addToCart(e)}catch(t){alert("Failed to add item: "+t.message)}finally{D(!1)}}else{const t=g.find(t=>t.id===e.id);v(t?g.map(t=>t.id===e.id?c(c({},t),{},{qty:t.qty+1}):t):[...g,c(c({},e),{},{qty:1})])}})(e),disabled:A,className:"bg-white p-4 rounded-xl shadow-sm hover:shadow-lg active:scale-95 border flex flex-col justify-between h-32 text-left group disabled:opacity-50 disabled:scale-100 disabled:cursor-wait",children:[(0,Ug.jsx)("span",{className:"font-bold text-slate-700 group-hover:text-blue-600",children:e.name}),(0,Ug.jsx)("span",{className:"font-mono text-slate-500 text-sm bg-slate-50 px-2 py-1 rounded w-fit",children:A?"Adding...":e.price.toLocaleString()})]},e.id))})}),I&&(0,Ug.jsx)(Dv,{cart:g,subtotal:P,vatAmount:L,total:M,onClose:()=>E(!1),onPaid:async e=>{let{method:t,roomId:n,printInvoice:r}=e;if(h)try{var i;return void await Eg(dv,fv,{folioId:u.id||u.folioId,amount:M,method:t,staffId:null===(i=uv.currentUser)||void 0===i?void 0:i.uid,staffName:a})}catch(v){throw console.error("Payment failed",v),alert("Payment Failed"),v}const o="TX-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5)),d={id:o,items:[...g],itemsCount:g.reduce((e,t)=>e+t.qty,0),subtotal:P,vatAmount:L,total:M,method:t,staff:a||"Staff",staffId:null,service_staff_id:(null===C||void 0===C?void 0:C.id)||"unknown",service_staff_name:(null===C||void 0===C?void 0:C.name)||"Unknown Staff",serviceCenter:(null===C||void 0===C?void 0:C.center)||(null===s||void 0===s?void 0:s.id),roomId:n,date:(new Date).toISOString(),department:null===s||void 0===s?void 0:s.name,workPeriodId:(null===l||void 0===l?void 0:l.id)||"NO_PERIOD",status:"pending",auditTrail:[{action:"created",by:(null===C||void 0===C?void 0:C.name)||a,at:(new Date).toISOString(),details:"Order placed by ".concat((null===C||void 0===C?void 0:C.name)||"Staff"," with ").concat(g.length," items")}]};b(d);try{var f,m;if(await Bp(Am(dv,"artifacts",fv,"public","data","sales",o),c(c({},d),{},{status:"confirmed",synced:!0})),Mg())if("room"===t&&n)await Dg(dv,fv,n,d,(null===(f=uv.currentUser)||void 0===f?void 0:f.uid)||"unknown",a||"Staff");else await Ag(dv,fv,d,(null===(m=uv.currentUser)||void 0===m?void 0:m.uid)||"unknown",a||"Staff",(null===s||void 0===s?void 0:s.id)||"general",null);y();try{var p;for(const t of d.items)"bar"===t.type&&await qp(Am(dv,"artifacts",fv,"public","data","menuItems",t.id),{stock_sold:eg(t.qty)});"room"===t&&n&&await qp(Am(dv,"artifacts",fv,"public","data","rooms",n),{"guest.charges":Zp({description:"POS: ".concat(d.items.map(e=>e.name).join(", ")),amount:M,date:d.date,staff:a})});const e=null===(p=uv.currentUser)||void 0===p?void 0:p.uid;if(e){try{(await Up(Am(dv,"artifacts",fv,"public","data","staffShifts",e))).exists()&&await qp(Am(dv,"artifacts",fv,"public","data","staffShifts",e),{ordersCount:eg(1),totalSales:eg(M),itemsSold:Zp(...g.map(e=>({name:e.name,qty:e.qty,price:e.price,time:(new Date).toISOString()})))})}catch(x){console.error("Shift metrics update error:",x)}const t=(new Date).toISOString().slice(0,7),n=Am(dv,"artifacts",fv,"public","data","staffPerformance","".concat(e,"_").concat(t));try{await qp(n,{totalSales:eg(M),ordersCount:eg(1),itemsSold:eg(d.itemsCount),lastUpdated:(new Date).toISOString()})}catch(N){await Bp(n,{staffId:e,staffName:a,serviceCenter:null===s||void 0===s?void 0:s.id,month:t,totalSales:M,ordersCount:1,itemsSold:d.itemsCount,shiftsWorked:1,createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()})}}}catch(S){console.error("Secondary write failed:",S)}w(o)}catch(v){console.error("Sale queued offline:",v),alert("Sale saved locally. Will sync when online.")}},rooms:i,department:s,staffName:a,onPrintComplete:()=>{y(),E(!1),d&&d()}})]})},_v="Source Garden Hotel",Iv="Jinja, Uganda",Ev="+256 XXX XXX XXX",Cv="info@sourcegarden.ug",Tv="TIN: XXXXXXXXXX",Av="Your Home Away From Home",Dv=e=>{let{cart:t,subtotal:n,vatAmount:s,total:i,onClose:a,onPaid:o,rooms:l,department:c,staffName:u,onPrintComplete:d}=e;const[h,f]=(0,r.useState)("cash"),[m,p]=(0,r.useState)(null),[g,v]=(0,r.useState)(!1),[y,x]=(0,r.useState)(null),b=(null===l||void 0===l?void 0:l.filter(e=>"occupied"===e.status))||[],w=()=>{const e=()=>{window.removeEventListener("afterprint",e),d?d():N()};window.addEventListener("afterprint",e),window.print()},N=()=>{v(!1),x(null),a()};return g&&y?(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden",children:[(0,Ug.jsx)("div",{className:"print:block hidden",children:(0,Ug.jsx)(Pv,{invoice:y})}),(0,Ug.jsxs)("div",{className:"print:hidden",children:[(0,Ug.jsxs)("div",{className:"p-6 bg-emerald-600 text-white text-center",children:[(0,Ug.jsx)(B,{size:48,className:"mx-auto mb-2"}),(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Payment Complete!"})]}),(0,Ug.jsx)("div",{className:"p-6 max-h-[60vh] overflow-auto",children:(0,Ug.jsx)(Rv,{invoice:y})}),(0,Ug.jsxs)("div",{className:"p-4 bg-slate-50 border-t flex gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:N,children:"Close"}),(0,Ug.jsxs)(xv,{variant:"primary",className:"flex-1 flex items-center justify-center gap-2",onClick:w,children:[(0,Ug.jsx)(q,{size:18})," Print Invoice"]})]})]})]})}):(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"p-6 bg-slate-900 text-white",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Settle Payment"}),(0,Ug.jsxs)("div",{className:"mt-3 space-y-1 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between text-slate-300",children:[(0,Ug.jsx)("span",{children:"Subtotal"}),(0,Ug.jsxs)("span",{children:[n.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-slate-300",children:[(0,Ug.jsx)("span",{children:"VAT (18%)"}),(0,Ug.jsxs)("span",{children:[s.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-white font-bold text-xl pt-2 border-t border-slate-700",children:[(0,Ug.jsx)("span",{children:"Total"}),(0,Ug.jsxs)("span",{children:[i.toLocaleString()," UGX"]})]})]})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["cash","momo","card","room"].map(e=>(0,Ug.jsx)("button",{onClick:()=>f(e),className:"p-4 rounded-xl border-2 font-bold uppercase ".concat(h===e?"border-blue-600 bg-blue-50 text-blue-600":"border-slate-200 text-slate-600"),children:"momo"===e?"Mobile Money":e},e))}),"room"===h&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Room"}),0===b.length?(0,Ug.jsxs)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg text-amber-700 text-sm",children:[(0,Ug.jsx)(V,{size:16,className:"inline mr-2"}),"No rooms currently occupied. Check in a guest first via Front Office."]}):(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg",value:m||"",onChange:e=>p(e.target.value),children:[(0,Ug.jsxs)("option",{value:"",children:["-- Select Room (",b.length," occupied) --"]}),b.map(e=>{var t;return(0,Ug.jsxs)("option",{value:e.id,children:[e.number," - ",(null===(t=e.guest)||void 0===t?void 0:t.name)||"Guest"]},e.id)})]})]}),(0,Ug.jsxs)("div",{className:"flex gap-4 mt-6",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:a,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"success",className:"flex-1",onClick:()=>{var e,r,a;if("room"===h&&!m)return void alert("Select a room");const l="INV-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5).toUpperCase()),d="room"===h?null===(e=b.find(e=>e.id===m))||void 0===e||null===(r=e.guest)||void 0===r?void 0:r.name:null,f={invoiceNo:l,date:new Date,items:t,subtotal:n,vatAmount:s,total:i,paymentMethod:"momo"===h?"Mobile Money":h.charAt(0).toUpperCase()+h.slice(1),department:(null===c||void 0===c?void 0:c.name)||"POS",staffName:u||"Staff",guestName:d,roomNumber:"room"===h?null===(a=b.find(e=>e.id===m))||void 0===a?void 0:a.number:null};x(f),o({method:h,roomId:m}),v(!0)},disabled:"room"===h&&(0===b.length||!m),children:"Complete & Print"})]})]})]})})},Rv=e=>{let{invoice:t}=e;return(0,Ug.jsxs)("div",{className:"text-sm",children:[(0,Ug.jsxs)("div",{className:"text-center mb-4 pb-4 border-b",children:[(0,Ug.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:_v}),(0,Ug.jsx)("p",{className:"text-slate-500",children:Iv}),(0,Ug.jsx)("p",{className:"text-slate-500",children:Ev})]}),(0,Ug.jsxs)("div",{className:"flex justify-between mb-4 text-slate-600",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Invoice:"})," ",t.invoiceNo]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Date:"})," ",t.date.toLocaleDateString()]})]}),t.guestName&&(0,Ug.jsxs)("div",{className:"mb-4 p-2 bg-slate-50 rounded",children:[(0,Ug.jsx)("strong",{children:"Guest:"})," ",t.guestName," ",t.roomNumber&&"(Room ".concat(t.roomNumber,")")]}),(0,Ug.jsxs)("table",{className:"w-full mb-4",children:[(0,Ug.jsx)("thead",{className:"border-b",children:(0,Ug.jsxs)("tr",{className:"text-left text-slate-500",children:[(0,Ug.jsx)("th",{className:"pb-2",children:"Item"}),(0,Ug.jsx)("th",{className:"pb-2 text-center",children:"Qty"}),(0,Ug.jsx)("th",{className:"pb-2 text-right",children:"Price"}),(0,Ug.jsx)("th",{className:"pb-2 text-right",children:"Amount"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:t.items.map((e,t)=>(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{className:"py-2",children:e.name}),(0,Ug.jsx)("td",{className:"py-2 text-center",children:e.qty}),(0,Ug.jsx)("td",{className:"py-2 text-right",children:e.price.toLocaleString()}),(0,Ug.jsx)("td",{className:"py-2 text-right",children:(e.price*e.qty).toLocaleString()})]},t))})]}),(0,Ug.jsxs)("div",{className:"border-t pt-3 space-y-1",children:[(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{children:"Subtotal"}),(0,Ug.jsxs)("span",{children:[t.subtotal.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-slate-600",children:[(0,Ug.jsx)("span",{children:"VAT (18%)"}),(0,Ug.jsxs)("span",{children:[t.vatAmount.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t",children:[(0,Ug.jsx)("span",{children:"TOTAL"}),(0,Ug.jsxs)("span",{children:[t.total.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"mt-4 pt-4 border-t text-center text-slate-500 text-xs",children:[(0,Ug.jsxs)("p",{children:["Payment: ",t.paymentMethod]}),(0,Ug.jsxs)("p",{children:["Served by: ",t.staffName," | ",t.department]}),(0,Ug.jsx)("p",{className:"mt-2",children:Tv}),(0,Ug.jsx)("p",{className:"mt-2 italic",children:Av})]})]})},Pv=e=>{let{invoice:t}=e;return(0,Ug.jsxs)("div",{style:{fontFamily:"Arial, sans-serif",padding:"20px",maxWidth:"300px",margin:"0 auto"},children:[(0,Ug.jsxs)("div",{style:{textAlign:"center",marginBottom:"20px",borderBottom:"2px solid #000",paddingBottom:"15px"},children:[(0,Ug.jsx)("h1",{style:{fontSize:"18px",margin:"0 0 5px 0",fontWeight:"bold"},children:_v}),(0,Ug.jsx)("p",{style:{margin:"2px 0",fontSize:"12px"},children:Iv}),(0,Ug.jsx)("p",{style:{margin:"2px 0",fontSize:"12px"},children:Ev}),(0,Ug.jsx)("p",{style:{margin:"2px 0",fontSize:"12px"},children:Cv})]}),(0,Ug.jsxs)("div",{style:{marginBottom:"15px",fontSize:"12px"},children:[(0,Ug.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,Ug.jsxs)("span",{children:[(0,Ug.jsx)("strong",{children:"Invoice #:"})," ",t.invoiceNo]})}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Date:"})," ",t.date.toLocaleString()]}),t.guestName&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Guest:"})," ",t.guestName]}),t.roomNumber&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Room:"})," ",t.roomNumber]})]}),(0,Ug.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px",fontSize:"12px"},children:[(0,Ug.jsx)("thead",{children:(0,Ug.jsxs)("tr",{style:{borderBottom:"1px solid #000"},children:[(0,Ug.jsx)("th",{style:{textAlign:"left",padding:"5px 0"},children:"Item"}),(0,Ug.jsx)("th",{style:{textAlign:"center",padding:"5px 0"},children:"Qty"}),(0,Ug.jsx)("th",{style:{textAlign:"right",padding:"5px 0"},children:"Amt"})]})}),(0,Ug.jsx)("tbody",{children:t.items.map((e,t)=>(0,Ug.jsxs)("tr",{style:{borderBottom:"1px dotted #ccc"},children:[(0,Ug.jsx)("td",{style:{padding:"5px 0"},children:e.name}),(0,Ug.jsx)("td",{style:{textAlign:"center",padding:"5px 0"},children:e.qty}),(0,Ug.jsx)("td",{style:{textAlign:"right",padding:"5px 0"},children:(e.price*e.qty).toLocaleString()})]},t))})]}),(0,Ug.jsxs)("div",{style:{borderTop:"1px solid #000",paddingTop:"10px",fontSize:"12px"},children:[(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px"},children:[(0,Ug.jsx)("span",{children:"Net Amount:"}),(0,Ug.jsxs)("span",{children:[t.subtotal.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px"},children:[(0,Ug.jsx)("span",{children:"VAT (18%):"}),(0,Ug.jsxs)("span",{children:[t.vatAmount.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold",fontSize:"14px",borderTop:"1px solid #000",paddingTop:"5px",marginTop:"5px"},children:[(0,Ug.jsx)("span",{children:"TOTAL:"}),(0,Ug.jsxs)("span",{children:[t.total.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:"1px dashed #000",textAlign:"center",fontSize:"10px"},children:[(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:["Payment Method: ",t.paymentMethod]}),(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:["Served by: ",t.staffName]}),(0,Ug.jsx)("p",{style:{margin:"3px 0"},children:t.department}),(0,Ug.jsx)("p",{style:{margin:"10px 0 3px 0"},children:Tv}),(0,Ug.jsxs)("p",{style:{margin:"10px 0",fontStyle:"italic"},children:['"',Av,'"']}),(0,Ug.jsx)("p",{style:{margin:"10px 0"},children:"Thank you for dining with us!"})]})]})},Ov=e=>{let{menu:t}=e;const n=t.filter(e=>"bar"===e.type),[s,i]=(0,r.useState)({}),a=r.useRef({}),o=(e,t,n)=>{const r="".concat(e,"_").concat(t),s=parseInt(n)||0;i(e=>c(c({},e),{},{[r]:s})),a.current[r]&&clearTimeout(a.current[r]),a.current[r]=setTimeout(async()=>{try{await qp(Am(dv,"artifacts",fv,"public","data","menuItems",e),{[t]:s}),i(e=>{const t=c({},e);return delete t[r],t})}catch(n){console.error("Stock update failed:",n),alert("Failed to save ".concat(t," for item. Will retry."))}},500)},l=(e,t)=>{const n="".concat(e.id,"_").concat(t);return void 0!==s[n]?s[n]:e[t]||0},u=n.reduce((e,t)=>e+(t.stock_sold||0)*t.price,0);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-6 shadow-sm flex justify-between items-center",children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(D,{className:"text-amber-600"})," Bar Stock Sheet"]}),(0,Ug.jsxs)("div",{className:"text-right",children:[(0,Ug.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold",children:"Total Sales Value"}),(0,Ug.jsxs)("p",{className:"text-2xl font-bold text-emerald-600",children:[u.toLocaleString()," UGX"]})]})]}),(0,Ug.jsx)("div",{className:"flex-1 overflow-auto p-8",children:(0,Ug.jsx)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:(0,Ug.jsxs)("table",{className:"w-full text-left",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 uppercase text-xs font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-4 border-b",children:"Item"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Price"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Opening"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Added"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Total"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Sold"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-center",children:"Closing"}),(0,Ug.jsx)("th",{className:"p-4 border-b text-right",children:"Amount"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:n.map(e=>{const t=l(e,"stock_open"),n=l(e,"stock_added"),r=e.stock_sold||0,s=t+n-r,i=r*e.price;return(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsx)("td",{className:"p-4 font-medium border-r",children:e.name}),(0,Ug.jsx)("td",{className:"p-4 text-center text-slate-500 text-sm",children:e.price.toLocaleString()}),(0,Ug.jsx)("td",{className:"p-4 text-center",children:(0,Ug.jsx)("input",{type:"number",className:"w-20 text-center border rounded",value:t,onChange:t=>o(e.id,"stock_open",t.target.value)})}),(0,Ug.jsx)("td",{className:"p-4 text-center",children:(0,Ug.jsx)("input",{type:"number",className:"w-20 text-center border rounded font-bold text-green-700",value:n,onChange:t=>o(e.id,"stock_added",t.target.value)})}),(0,Ug.jsx)("td",{className:"p-4 text-center font-bold",children:t+n}),(0,Ug.jsxs)("td",{className:"p-4 text-center text-red-600 font-bold",children:["-",r]}),(0,Ug.jsx)("td",{className:"p-4 text-center font-bold ".concat(s<5?"text-red-600 bg-red-50":""),children:s}),(0,Ug.jsx)("td",{className:"p-4 text-right font-mono font-bold text-emerald-600",children:i.toLocaleString()})]},e.id)})}),(0,Ug.jsx)("tfoot",{className:"bg-slate-800 text-white",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{colSpan:"7",className:"p-4 text-right font-bold uppercase",children:"Grand Total"}),(0,Ug.jsxs)("td",{className:"p-4 text-right font-mono font-bold text-xl",children:[u.toLocaleString()," UGX"]})]})})]})})})]})},Lv=()=>{const[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","voids"),jp("date","desc")),e=>t(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsx)("div",{className:"bg-white border-b px-8 py-6 shadow-sm",children:(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(P,{className:"text-red-600"})," Void Reports"]})}),(0,Ug.jsx)("div",{className:"flex-1 overflow-auto p-8",children:(0,Ug.jsx)("div",{className:"bg-white rounded-xl shadow border",children:(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-4",children:"Time"}),(0,Ug.jsx)("th",{className:"p-4",children:"Item"}),(0,Ug.jsx)("th",{className:"p-4",children:"Qty"}),(0,Ug.jsx)("th",{className:"p-4",children:"Value"}),(0,Ug.jsx)("th",{className:"p-4",children:"Staff"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:e.map(e=>(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{className:"p-4 text-slate-500",children:new Date(e.date).toLocaleString()}),(0,Ug.jsx)("td",{className:"p-4 font-bold",children:e.item}),(0,Ug.jsx)("td",{className:"p-4",children:e.qty}),(0,Ug.jsx)("td",{className:"p-4 text-red-600",children:(e.price*e.qty).toLocaleString()}),(0,Ug.jsx)("td",{className:"p-4",children:e.staff})]},e.id))})]})})})]})},Mv=e=>{let{rooms:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)([]);(0,r.useEffect)(()=>{const e=(new Date).toLocaleDateString(),t=Gp(bp(Tm(dv,"artifacts",fv,"public","data","sales"),jp("date","desc")),t=>s(t.docs.map(e=>e.data()).filter(t=>new Date(t.date).toLocaleDateString()===e))),n=Gp(bp(Tm(dv,"artifacts",fv,"public","data","payments"),jp("date","desc")),t=>a(t.docs.map(e=>e.data()).filter(t=>new Date(t.date).toLocaleDateString()===e))),r=Gp(bp(Tm(dv,"artifacts",fv,"public","data","expenses"),jp("date","desc")),t=>l(t.docs.map(e=>e.data()).filter(t=>new Date(t.date).toLocaleDateString()===e)));return()=>{t(),n(),r()}},[]);const u={pos:n.filter(e=>"room"!==e.method).reduce((e,t)=>e+t.total,0),rooms:i.reduce((e,t)=>e+t.amount,0)},d=o.reduce((e,t)=>e+t.amount,0),h=u.pos+u.rooms-d;return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-6 shadow-sm flex justify-between items-center",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(A,{className:"text-emerald-600"})," Daily Report"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm",children:(new Date).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,Ug.jsxs)("div",{className:"text-right",children:[(0,Ug.jsx)("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Net Cash"}),(0,Ug.jsxs)("p",{className:"text-3xl font-bold text-emerald-600",children:[h.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"p-8 grid grid-cols-1 md:grid-cols-3 gap-6 overflow-y-auto",children:[(0,Ug.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[(0,Ug.jsxs)("h3",{className:"font-bold mb-4 flex items-center gap-2",children:[(0,Ug.jsx)(H,{size:18})," Cash Flow"]}),(0,Ug.jsxs)("div",{className:"space-y-3",children:[(0,Ug.jsxs)("div",{className:"flex justify-between p-3 bg-emerald-50 text-emerald-900 rounded-lg",children:[(0,Ug.jsx)("span",{children:"POS Collected"}),(0,Ug.jsx)("span",{className:"font-bold",children:u.pos.toLocaleString()})]}),(0,Ug.jsxs)("div",{className:"flex justify-between p-3 bg-emerald-50 text-emerald-900 rounded-lg",children:[(0,Ug.jsx)("span",{children:"Room Payments"}),(0,Ug.jsx)("span",{className:"font-bold",children:u.rooms.toLocaleString()})]}),(0,Ug.jsxs)("div",{className:"flex justify-between p-3 bg-red-50 text-red-900 rounded-lg",children:[(0,Ug.jsx)("span",{children:"Expenses"}),(0,Ug.jsxs)("span",{className:"font-bold",children:["-",d.toLocaleString()]})]}),(0,Ug.jsxs)("div",{className:"border-t pt-2 flex justify-between font-bold text-lg",children:[(0,Ug.jsx)("span",{children:"Net Cash"}),(0,Ug.jsx)("span",{children:h.toLocaleString()})]})]})]}),(0,Ug.jsxs)("div",{className:"md:col-span-2 bg-white rounded-xl shadow-sm border overflow-hidden",children:[(0,Ug.jsx)("div",{className:"p-4 bg-slate-50 border-b font-bold",children:"Today's Transactions"}),(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-500",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3",children:"Time"}),(0,Ug.jsx)("th",{className:"p-3",children:"Type"}),(0,Ug.jsx)("th",{className:"p-3",children:"Details"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Amount"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:[...n.map(e=>c(c({},e),{},{type:"POS Sale"})),...i.map(e=>c(c({},e),{},{type:"Room Payment"})),...o.map(e=>c(c({},e),{},{type:"Expense",total:-e.amount}))].sort((e,t)=>new Date(t.date)-new Date(e.date)).slice(0,10).map((e,t)=>(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{className:"p-3 text-slate-400",children:new Date(e.date).toLocaleTimeString()}),(0,Ug.jsx)("td",{className:"p-3 font-medium ".concat("Expense"===e.type?"text-red-600":""),children:e.type}),(0,Ug.jsx)("td",{className:"p-3 text-slate-600",children:e.staff||e.description||"Room ".concat(e.roomNumber)}),(0,Ug.jsx)("td",{className:"p-3 text-right font-mono font-bold ".concat("Expense"===e.type?"text-red-600":"text-emerald-600"),children:(e.total||e.amount).toLocaleString()})]},t))})]})]})]})]})},Fv=["Food & Beverages","Utilities","Maintenance & Repairs","Cleaning Supplies","Office Supplies","Fuel & Transport","Staff Welfare","Marketing","Equipment","Rent","Licenses & Permits","Security","Laundry","Guest Amenities","Miscellaneous"],Uv=["Cash","Mobile Money","Bank Transfer","Cheque","Credit"],Vv=["Front Office","Bar - River","Bar - Poolside","Kitchen","Housekeeping","Admin","Maintenance","Security"],zv=e=>{let{staffName:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(()=>{try{const e=localStorage.getItem("sourcegarden_pending_expenses");return e?JSON.parse(e):[]}catch(e){return[]}}),[o,l]=(0,r.useState)(!1),[u,d]=(0,r.useState)((new Date).toISOString().split("T")[0]),[h,f]=(0,r.useState)(""),[m,p]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),[y,x]=(0,r.useState)("1"),[b,w]=(0,r.useState)(""),[N,S]=(0,r.useState)("Cash"),[k,j]=(0,r.useState)(""),[_,I]=(0,r.useState)(""),[E,C]=(0,r.useState)(""),T=(parseFloat(y)||0)*(parseFloat(b)||0);(0,r.useEffect)(()=>{localStorage.setItem("sourcegarden_pending_expenses",JSON.stringify(i))},[i]),(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","expenses"),jp("date","desc")),e=>s(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,r.useEffect)(()=>{const e=async()=>{for(const t of i)try{await Bp(Am(dv,"artifacts",fv,"public","data","expenses",t.id),c(c({},t),{},{synced:!0})),a(e=>e.filter(e=>e.id!==t.id))}catch(e){break}};return e(),window.addEventListener("online",e),()=>window.removeEventListener("online",e)},[i]);const A=()=>{d((new Date).toISOString().split("T")[0]),f(""),p(""),v(""),x("1"),w(""),S("Cash"),j(""),I(""),C(""),l(!1)},[D,P]=(0,r.useState)(null);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-6 shadow-sm flex justify-between items-center",children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(R,{className:"text-rose-600"})," Expenses Log"]}),(0,Ug.jsx)(xv,{variant:"danger",onClick:()=>l(!0),children:"+ Record New Expense"})]}),(0,Ug.jsxs)("div",{className:"p-8 flex-1 overflow-auto",children:[i.length>0&&(0,Ug.jsxs)("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg text-amber-800 text-sm",children:["\u23f3 ",i.length," expense(s) pending sync..."]}),(0,Ug.jsx)("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-4",children:"Date"}),(0,Ug.jsx)("th",{className:"p-4",children:"Supplier"}),(0,Ug.jsx)("th",{className:"p-4",children:"Category"}),(0,Ug.jsx)("th",{className:"p-4",children:"Description"}),(0,Ug.jsx)("th",{className:"p-4",children:"Department"}),(0,Ug.jsx)("th",{className:"p-4",children:"Payment"}),(0,Ug.jsx)("th",{className:"p-4 text-right",children:"Amount"})]})}),(0,Ug.jsxs)("tbody",{className:"divide-y",children:[n.map(e=>(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>P(e),children:[(0,Ug.jsx)("td",{className:"p-4 text-slate-500",children:new Date(e.date).toLocaleDateString()}),(0,Ug.jsx)("td",{className:"p-4 font-medium",children:e.supplier||"-"}),(0,Ug.jsx)("td",{className:"p-4",children:(0,Ug.jsx)("span",{className:"bg-slate-200 px-2 py-1 rounded text-xs",children:e.category||"N/A"})}),(0,Ug.jsx)("td",{className:"p-4 text-slate-600",children:e.description}),(0,Ug.jsx)("td",{className:"p-4 text-slate-500",children:e.department||"-"}),(0,Ug.jsx)("td",{className:"p-4 text-slate-500",children:e.paymentMethod||"Cash"}),(0,Ug.jsxs)("td",{className:"p-4 text-right font-mono font-bold text-rose-600",children:["-",(e.amount||0).toLocaleString()]})]},e.id)),0===n.length&&(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"7",className:"p-8 text-center text-slate-400",children:"No expenses recorded yet"})})]})]})})]}),o&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:[(0,Ug.jsx)("div",{className:"bg-rose-600 text-white px-6 py-4 rounded-t-2xl",children:(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Record New Expense"})}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Date *"}),(0,Ug.jsx)("input",{type:"date",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",value:u,onChange:e=>d(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supplier / Payee *"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",placeholder:"e.g., Kampala Suppliers Ltd",value:h,onChange:e=>f(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Expense Category *"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500 bg-white",value:m,onChange:e=>p(e.target.value),children:[(0,Ug.jsx)("option",{value:"",children:"Select Category"}),Fv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Department / Outlet *"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500 bg-white",value:_,onChange:e=>I(e.target.value),children:[(0,Ug.jsx)("option",{value:"",children:"Select Department"}),Vv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))]})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Item Description *"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",placeholder:"e.g., 50kg Rice for kitchen",value:g,onChange:e=>v(e.target.value)})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,Ug.jsx)("input",{type:"number",min:"1",step:"0.01",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",placeholder:"1",value:y,onChange:e=>x(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Unit Cost (UGX) *"}),(0,Ug.jsx)("input",{type:"number",min:"0",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",placeholder:"0",value:b,onChange:e=>w(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Total Amount"}),(0,Ug.jsxs)("div",{className:"w-full p-3 bg-slate-100 border rounded-lg font-mono font-bold text-rose-600",children:[T.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Payment Method"}),(0,Ug.jsx)("select",{className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500 bg-white",value:N,onChange:e=>S(e.target.value),children:Uv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reference / Receipt / Transaction ID"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500",placeholder:"e.g., RCP-001234 or MM-TXN-789",value:k,onChange:e=>j(e.target.value)})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Recorded By"}),(0,Ug.jsx)("div",{className:"w-full p-3 bg-slate-100 border rounded-lg text-slate-600",children:t||"Admin"})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,Ug.jsx)("textarea",{className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500 resize-none",rows:"2",placeholder:"Any additional notes or remarks...",value:E,onChange:e=>C(e.target.value)})]})]}),(0,Ug.jsxs)("div",{className:"border-t px-6 py-4 bg-slate-50 rounded-b-2xl flex justify-end gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",onClick:A,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"danger",onClick:async()=>{if(!h||!m||!g||!b||!_)return void alert("Please fill in all required fields: Supplier, Category, Description, Unit Cost, and Department");const e="EXP-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5)),n={id:e,date:new Date(u).toISOString(),supplier:h,category:m,description:g,quantity:parseFloat(y)||1,unitCost:parseFloat(b)||0,amount:T,paymentMethod:N,reference:k||null,department:_,recordedBy:t||"Admin",notes:E||null,createdAt:(new Date).toISOString()};a(e=>[...e,n]),A();try{await Bp(Am(dv,"artifacts",fv,"public","data","expenses",e),c(c({},n),{},{synced:!0})),a(t=>t.filter(t=>t.id!==e))}catch(r){console.error("Expense queued offline:",r),alert("Expense saved locally. Will sync when online.")}},disabled:!h||!m||!g||!b||!_,children:"Record Expense"})]})]})}),D&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>P(null),children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",onClick:e=>e.stopPropagation(),children:[(0,Ug.jsxs)("div",{className:"bg-slate-800 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Expense Details"}),(0,Ug.jsx)("button",{onClick:()=>P(null),className:"text-white/70 hover:text-white",children:"\u2715"})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-3 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Date"}),(0,Ug.jsx)("span",{className:"font-medium",children:new Date(D.date).toLocaleDateString()})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Supplier / Payee"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.supplier||"-"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Category"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.category||"N/A"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Description"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.description})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Quantity"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.quantity||1})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Unit Cost"}),(0,Ug.jsxs)("span",{className:"font-medium",children:[(D.unitCost||D.amount||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Total Amount"}),(0,Ug.jsxs)("span",{className:"font-mono font-bold text-rose-600",children:[(D.amount||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Payment Method"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.paymentMethod||"Cash"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Reference"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.reference||"-"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Department"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.department||"-"})]}),(0,Ug.jsxs)("div",{className:"flex justify-between py-2 border-b",children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Recorded By"}),(0,Ug.jsx)("span",{className:"font-medium",children:D.recordedBy||D.staff||"Admin"})]}),D.notes&&(0,Ug.jsxs)("div",{className:"py-2",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block mb-1",children:"Notes"}),(0,Ug.jsx)("span",{className:"text-slate-700",children:D.notes})]})]})]})})]})},Bv=e=>{let{rooms:t}=e;const[n,s]=(0,r.useState)(new Date),[i,a]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[u,d]=(0,r.useState)("all");(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","events"),jp("eventDate","asc")),e=>l(e.docs.map(e=>c({id:e.id},e.data()))),e=>console.error("Events load error:",e)),[]);const h=t.filter(e=>"occupied"===e.status&&e.guest).map(e=>({type:"room",roomId:e.id,roomNumber:e.number,roomType:e.type,guestName:e.guest.name,guestPhone:e.guest.phone,checkIn:new Date(e.guest.checkIn),checkOut:new Date(e.guest.checkOut),nights:e.guest.nights,adults:e.guest.adults,children:e.guest.children})),m=(e=>{const t=e.getFullYear(),n=e.getMonth(),r=new Date(t,n,1),s=new Date(t,n+1,0).getDate(),i=r.getDay(),a=[];for(let o=0;o<i;o++)a.push(null);for(let o=1;o<=s;o++)a.push(new Date(t,n,o));return a})(n),p=e=>{if(!e)return[];const t=new Date(e).setHours(0,0,0,0);return h.filter(e=>{const n=new Date(e.checkIn).setHours(0,0,0,0),r=new Date(e.checkOut).setHours(0,0,0,0);return t>=n&&t<r})},g=e=>{if(!e)return[];const t=e.toISOString().split("T")[0];return o.filter(e=>e.eventDate===t&&"Cancelled"!==e.status)},v=e=>e&&(new Date).toDateString()===e.toDateString();return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-6 shadow-sm flex justify-between items-center",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(O,{className:"text-indigo-600"})," Bookings & Events Calendar"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"View all room reservations and events"})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ug.jsxs)("div",{className:"flex bg-slate-100 rounded-lg p-1",children:[(0,Ug.jsx)("button",{onClick:()=>d("all"),className:"px-3 py-1 rounded text-sm font-medium ".concat("all"===u?"bg-white shadow":""),children:"All"}),(0,Ug.jsx)("button",{onClick:()=>d("rooms"),className:"px-3 py-1 rounded text-sm font-medium ".concat("rooms"===u?"bg-white shadow":""),children:"Rooms"}),(0,Ug.jsx)("button",{onClick:()=>d("events"),className:"px-3 py-1 rounded text-sm font-medium ".concat("events"===u?"bg-white shadow":""),children:"Events"})]}),(0,Ug.jsx)("button",{onClick:()=>s(new Date),className:"px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg font-medium hover:bg-indigo-200",children:"Today"})]})]}),(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-2 flex gap-6 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-3 h-3 rounded bg-emerald-500"})," Room Booking"]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-3 h-3 rounded bg-purple-500"})," Event"]})]}),(0,Ug.jsxs)("div",{className:"p-8 flex-1 overflow-auto",children:[(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden max-w-5xl mx-auto",children:[(0,Ug.jsxs)("div",{className:"flex items-center justify-between p-4 bg-indigo-600 text-white",children:[(0,Ug.jsx)("button",{onClick:()=>s(new Date(n.getFullYear(),n.getMonth()-1)),className:"p-2 hover:bg-indigo-700 rounded-lg",children:"\u2190"}),(0,Ug.jsxs)("h3",{className:"text-xl font-bold",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()]," ",n.getFullYear()]}),(0,Ug.jsx)("button",{onClick:()=>s(new Date(n.getFullYear(),n.getMonth()+1)),className:"p-2 hover:bg-indigo-700 rounded-lg",children:"\u2192"})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-7",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,Ug.jsx)("div",{className:"p-3 text-center font-bold text-slate-600 bg-slate-100 border-b",children:e},e)),m.map((e,t)=>{const{bookings:n,events:r}=(s=e?new Date(e):null)?{bookings:"events"===u?[]:p(s),events:"rooms"===u?[]:g(s)}:{bookings:[],events:[]};var s;const i=n.length+r.length;return(0,Ug.jsx)("div",{className:"min-h-[100px] p-2 border-b border-r ".concat(e?"hover:bg-slate-50 cursor-pointer":"bg-slate-50"," ").concat(v(e)?"bg-indigo-50":""),onClick:()=>e&&a(e),children:e&&(0,Ug.jsxs)(Ug.Fragment,{children:[(0,Ug.jsx)("div",{className:"text-sm font-medium ".concat(v(e)?"bg-indigo-600 text-white w-7 h-7 rounded-full flex items-center justify-center":"text-slate-600"),children:e.getDate()}),(0,Ug.jsxs)("div",{className:"mt-1 space-y-1",children:[r.slice(0,2).map((e,t)=>(0,Ug.jsxs)("div",{className:"text-xs bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded truncate",title:e.eventName,children:["\ud83c\udf89 ",e.eventName]},"evt-".concat(t))),n.slice(0,2-Math.min(r.length,2)).map((e,t)=>{var n;return(0,Ug.jsxs)("div",{className:"text-xs bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded truncate",title:"".concat(e.guestName," - Room ").concat(e.roomNumber),children:["\ud83d\udecf ",e.roomNumber,": ",null===(n=e.guestName)||void 0===n?void 0:n.split(" ")[0]]},"rm-".concat(t))}),i>2&&(0,Ug.jsxs)("div",{className:"text-xs text-slate-500",children:["+",i-2," more"]})]})]})},t)})]})]}),(0,Ug.jsxs)("div",{className:"mt-6 bg-white rounded-xl shadow-sm border p-6 max-w-5xl mx-auto",children:[(0,Ug.jsxs)("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[(0,Ug.jsx)(f,{size:20,className:"text-indigo-600"})," Current Reservations (",h.length,")"]}),0===h.length?(0,Ug.jsx)("p",{className:"text-slate-400 text-center py-8",children:"No active reservations"}):(0,Ug.jsx)("div",{className:"overflow-x-auto",children:(0,Ug.jsxs)("table",{className:"w-full text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Room"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Guest"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Phone"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Check-In"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Check-Out"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Nights"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Guests"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:h.map((e,t)=>(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsx)("td",{className:"p-3 font-bold",children:e.roomNumber}),(0,Ug.jsx)("td",{className:"p-3",children:e.guestName}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.guestPhone||"-"}),(0,Ug.jsx)("td",{className:"p-3 text-emerald-600",children:e.checkIn.toLocaleDateString()}),(0,Ug.jsx)("td",{className:"p-3 text-red-600",children:e.checkOut.toLocaleDateString()}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:e.nights}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:e.adults+e.children})]},t))})]})})]})]}),i&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>a(null),children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,Ug.jsxs)("div",{className:"bg-indigo-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center sticky top-0",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:i.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,Ug.jsx)("button",{onClick:()=>a(null),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"p-6",children:[g(i).length>0&&(0,Ug.jsxs)("div",{className:"mb-6",children:[(0,Ug.jsxs)("h4",{className:"font-bold text-purple-700 mb-3 flex items-center gap-2",children:[(0,Ug.jsx)(L,{size:18})," Events (",g(i).length,")"]}),(0,Ug.jsx)("div",{className:"space-y-3",children:g(i).map((e,t)=>(0,Ug.jsxs)("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-bold text-purple-800",children:e.eventName}),(0,Ug.jsxs)("div",{className:"text-sm text-purple-600",children:[e.eventType," \u2022 ",e.venue]})]}),(0,Ug.jsx)("span",{className:"px-2 py-1 text-xs rounded font-medium ".concat("Confirmed"===e.status?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"),children:e.status})]}),(0,Ug.jsxs)("div",{className:"mt-2 text-sm text-slate-600 flex items-center gap-4",children:[(0,Ug.jsxs)("span",{children:[(0,Ug.jsx)(G,{size:14,className:"inline mr-1"}),e.startTime," - ",e.endTime]}),(0,Ug.jsxs)("span",{children:[(0,Ug.jsx)(W,{size:14,className:"inline mr-1"}),e.expectedGuests," guests"]})]}),e.contactName&&(0,Ug.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:["Contact: ",e.contactName]})]},t))})]}),p(i).length>0&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h4",{className:"font-bold text-emerald-700 mb-3 flex items-center gap-2",children:[(0,Ug.jsx)(f,{size:18})," Room Bookings (",p(i).length,")"]}),(0,Ug.jsx)("div",{className:"space-y-3",children:p(i).map((e,t)=>(0,Ug.jsxs)("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-lg",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-bold text-emerald-800",children:e.guestName}),(0,Ug.jsxs)("div",{className:"text-sm text-emerald-600",children:["Room ",e.roomNumber," \u2022 ",e.roomType]})]}),(0,Ug.jsxs)("div",{className:"text-right text-sm",children:[(0,Ug.jsxs)("div",{className:"text-slate-500",children:[e.nights," nights"]}),(0,Ug.jsxs)("div",{className:"text-slate-400",children:[e.adults,"A + ",e.children,"C"]})]})]}),(0,Ug.jsxs)("div",{className:"mt-2 text-xs text-slate-500",children:[e.checkIn.toLocaleDateString()," \u2192 ",e.checkOut.toLocaleDateString()]})]},t))})]}),0===g(i).length&&0===p(i).length&&(0,Ug.jsx)("p",{className:"text-center text-slate-400 py-8",children:"No events or bookings for this date"})]})]})})]})},qv=["Conference","Wedding","Birthday Party","Corporate Meeting","Workshop","Retreat","Gala Dinner","Private Function","Other"],Hv=["Main Hall","Conference Room A","Conference Room B","Garden Area","Poolside","Restaurant","Rooftop"],Gv=["Confirmed","Tentative","Cancelled","Completed"],Wv=["Cash","Mobile Money","Bank Transfer","Cheque"],Kv=e=>{let{staffName:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[u,d]=(0,r.useState)("upcoming"),[h,f]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),[g,v]=(0,r.useState)(""),[y,x]=(0,r.useState)(""),[b,w]=(0,r.useState)((new Date).toISOString().split("T")[0]),[N,S]=(0,r.useState)("09:00"),[k,j]=(0,r.useState)("17:00"),[_,I]=(0,r.useState)(""),[E,C]=(0,r.useState)(""),[T,A]=(0,r.useState)(""),[D,R]=(0,r.useState)(""),[P,M]=(0,r.useState)(""),[F,V]=(0,r.useState)("Confirmed"),[z,B]=(0,r.useState)(""),[H,G]=(0,r.useState)(""),[X,J]=(0,r.useState)(""),[Y,$]=(0,r.useState)("Cash"),[Z,ee]=(0,r.useState)(""),[te,ne]=(0,r.useState)("");(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","events"),jp("eventDate","asc")),e=>s(e.docs.map(e=>c({id:e.id},e.data()))),e=>console.error("Events load error:",e)),[]);const re=()=>{v(""),x(""),w((new Date).toISOString().split("T")[0]),S("09:00"),j("17:00"),I(""),C(""),A(""),R(""),M(""),V("Confirmed"),B(""),G(""),a(!1)},se=()=>{J(""),$("Cash"),ee(""),ne(""),f(!1)},ie=e=>e-Math.round(e/1.18),ae=e=>{const t=(e.payments||[]).reduce((e,t)=>e+t.amount,0),n=e.totalAmount||0;return 0===t?{status:"Unpaid",color:"red",paid:0,balance:n}:t>=n?{status:"Paid",color:"emerald",paid:t,balance:0}:{status:"Partial",color:"amber",paid:t,balance:n-t}},oe=(new Date).toISOString().split("T")[0],le=n.filter(e=>"upcoming"===u?e.eventDate>=oe&&"Cancelled"!==e.status:"past"===u?e.eventDate<oe:"cancelled"===u?"Cancelled"===e.status:"unpaid"!==u||"Paid"!==ae(e).status);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsxs)("div",{className:"bg-white border-b px-8 py-6 shadow-sm flex justify-between items-center",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(L,{className:"text-purple-600"})," Events Management"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"Manage conferences, functions, and payments"})]}),(0,Ug.jsxs)(xv,{variant:"primary",onClick:()=>a(!0),className:"flex items-center gap-2",children:[(0,Ug.jsx)(K,{size:18})," New Event"]})]}),(0,Ug.jsxs)("div",{className:"p-8 flex-1 overflow-auto",children:[(0,Ug.jsx)("div",{className:"flex gap-2 mb-6 flex-wrap",children:[{id:"upcoming",label:"Upcoming",count:n.filter(e=>e.eventDate>=oe&&"Cancelled"!==e.status).length},{id:"unpaid",label:"Unpaid/Partial",count:n.filter(e=>"Paid"!==ae(e).status).length},{id:"past",label:"Past",count:n.filter(e=>e.eventDate<oe).length},{id:"all",label:"All",count:n.length}].map(e=>(0,Ug.jsxs)("button",{onClick:()=>d(e.id),className:"px-4 py-2 rounded-lg font-medium ".concat(u===e.id?"bg-purple-600 text-white":"bg-white border hover:bg-slate-50"),children:[e.label," (",e.count,")"]},e.id))}),0===le.length?(0,Ug.jsxs)("div",{className:"bg-white rounded-xl p-12 text-center border",children:[(0,Ug.jsx)(L,{size:48,className:"mx-auto text-slate-300 mb-4"}),(0,Ug.jsx)("p",{className:"text-slate-400",children:"No events found"}),(0,Ug.jsx)(xv,{variant:"primary",onClick:()=>a(!0),className:"mt-4",children:"Create First Event"})]}):(0,Ug.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:le.map(e=>{const t=ae(e);return(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border hover:shadow-md transition-shadow cursor-pointer overflow-hidden",onClick:()=>l(e),children:[(0,Ug.jsx)("div",{className:"h-2 ".concat("Confirmed"===e.status?"bg-emerald-500":"Tentative"===e.status?"bg-amber-500":"Cancelled"===e.status?"bg-red-500":"bg-slate-400")}),(0,Ug.jsxs)("div",{className:"p-5",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,Ug.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded font-medium",children:e.eventType}),(0,Ug.jsx)("span",{className:"px-2 py-1 text-xs rounded font-medium bg-".concat(t.color,"-100 text-").concat(t.color,"-700"),children:t.status})]}),(0,Ug.jsx)("h3",{className:"font-bold text-lg text-slate-800 mb-2",children:e.eventName}),(0,Ug.jsxs)("div",{className:"space-y-1 text-sm text-slate-500",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)(O,{size:14})," ",new Date(e.eventDate).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)(Q,{size:14})," ",e.venue]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ug.jsx)(W,{size:14})," ",e.expectedGuests," guests"]})]}),(0,Ug.jsxs)("div",{className:"mt-3 pt-3 border-t flex justify-between items-center",children:[(0,Ug.jsx)("span",{className:"text-slate-500 text-sm",children:"Total (incl. VAT)"}),(0,Ug.jsxs)("span",{className:"font-bold text-lg",children:[(e.grossTotal||0).toLocaleString()," UGX"]})]}),t.balance>0&&(0,Ug.jsxs)("div",{className:"text-sm text-amber-600 font-medium mt-1",children:["Balance: ",t.balance.toLocaleString()," UGX"]})]})]},e.id)})})]}),i&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:[(0,Ug.jsxs)("div",{className:"bg-purple-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Create New Event"}),(0,Ug.jsx)("button",{onClick:re,className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsx)("div",{className:"p-6 space-y-4",children:(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ug.jsxs)("div",{className:"col-span-2",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Event Name *"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",placeholder:"e.g., Annual Corporate Retreat",value:g,onChange:e=>v(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Event Type *"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg bg-white",value:y,onChange:e=>x(e.target.value),children:[(0,Ug.jsx)("option",{value:"",children:"Select Type"}),qv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Venue *"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg bg-white",value:_,onChange:e=>I(e.target.value),children:[(0,Ug.jsx)("option",{value:"",children:"Select Venue"}),Hv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Event Date *"}),(0,Ug.jsx)("input",{type:"date",className:"w-full p-3 border rounded-lg",value:b,onChange:e=>w(e.target.value)})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start Time"}),(0,Ug.jsx)("input",{type:"time",className:"w-full p-3 border rounded-lg",value:N,onChange:e=>S(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"End Time"}),(0,Ug.jsx)("input",{type:"time",className:"w-full p-3 border rounded-lg",value:k,onChange:e=>j(e.target.value)})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Expected Guests"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",placeholder:"0",value:E,onChange:e=>C(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Total Amount (excl. VAT) *"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",placeholder:"0",value:H,onChange:e=>G(e.target.value)})]}),H&&(0,Ug.jsxs)("div",{className:"col-span-2 bg-slate-100 p-4 rounded-lg",children:[(0,Ug.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ug.jsx)("span",{children:"Subtotal"}),(0,Ug.jsxs)("span",{children:[parseFloat(H||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ug.jsx)("span",{children:"VAT (18%)"}),(0,Ug.jsxs)("span",{children:[ie(parseFloat(H||0)).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t mt-2 pt-2",children:[(0,Ug.jsx)("span",{children:"Gross Total"}),(0,Ug.jsxs)("span",{children:[parseFloat(H||0).toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Contact Name"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",placeholder:"Event organizer",value:T,onChange:e=>A(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Contact Phone"}),(0,Ug.jsx)("input",{type:"tel",className:"w-full p-3 border rounded-lg",placeholder:"+256...",value:D,onChange:e=>R(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Contact Email"}),(0,Ug.jsx)("input",{type:"email",className:"w-full p-3 border rounded-lg",placeholder:"email@example.com",value:P,onChange:e=>M(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status"}),(0,Ug.jsx)("select",{className:"w-full p-3 border rounded-lg bg-white",value:F,onChange:e=>V(e.target.value),children:Gv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))})]}),(0,Ug.jsxs)("div",{className:"col-span-2",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,Ug.jsx)("textarea",{className:"w-full p-3 border rounded-lg",rows:"2",placeholder:"Additional details...",value:z,onChange:e=>B(e.target.value)})]})]})}),(0,Ug.jsxs)("div",{className:"border-t px-6 py-4 bg-slate-50 rounded-b-2xl flex justify-end gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",onClick:re,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"primary",onClick:async()=>{if(!g||!y||!b||!_||!H)return void alert("Please fill in all required fields: Event Name, Type, Date, Venue, and Total Amount");const e="EVT-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5).toUpperCase()),n={id:e,eventName:g,eventType:y,eventDate:b,startTime:N,endTime:k,venue:_,expectedGuests:parseInt(E)||0,contactName:T,contactPhone:D,contactEmail:P,status:F,notes:z,totalAmount:parseFloat(H)||0,vatAmount:ie(parseFloat(H)||0),grossTotal:parseFloat(H)||0,payments:[],createdBy:t||"Admin",createdAt:(new Date).toISOString()};try{await Bp(Am(dv,"artifacts",fv,"public","data","events",e),n),re(),alert("\u2713 Event created successfully!")}catch(r){alert("Failed to save event: "+r.message)}},children:"Create Event"})]})]})}),o&&!h&&!m&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>l(null),children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,Ug.jsx)("div",{className:"h-2 rounded-t-2xl ".concat("Confirmed"===o.status?"bg-emerald-500":"Tentative"===o.status?"bg-amber-500":"Cancelled"===o.status?"bg-red-500":"bg-slate-400")}),(0,Ug.jsxs)("div",{className:"p-6",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded font-medium",children:o.eventType}),(0,Ug.jsx)("h3",{className:"text-2xl font-bold mt-2",children:o.eventName})]}),(0,Ug.jsx)("button",{onClick:()=>l(null),className:"text-slate-400 hover:text-slate-600",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Date"}),(0,Ug.jsx)("span",{className:"font-medium",children:new Date(o.eventDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Time"}),(0,Ug.jsxs)("span",{className:"font-medium",children:[o.startTime," - ",o.endTime]})]}),(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Venue"}),(0,Ug.jsx)("span",{className:"font-medium",children:o.venue})]}),(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Guests"}),(0,Ug.jsx)("span",{className:"font-medium",children:o.expectedGuests})]}),o.contactName&&(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Contact"}),(0,Ug.jsx)("span",{className:"font-medium",children:o.contactName})]}),o.contactPhone&&(0,Ug.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,Ug.jsx)("span",{className:"text-slate-500 block",children:"Phone"}),(0,Ug.jsx)("span",{className:"font-medium",children:o.contactPhone})]})]}),(0,Ug.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 mb-6",children:[(0,Ug.jsx)("h4",{className:"font-bold text-purple-800 mb-3",children:"Financial Summary"}),(0,Ug.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{children:"Subtotal"}),(0,Ug.jsxs)("span",{children:[(o.totalAmount||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{children:"VAT (18%)"}),(0,Ug.jsxs)("span",{children:[(o.vatAmount||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t border-purple-200 pt-2 mt-2",children:[(0,Ug.jsx)("span",{children:"Gross Total"}),(0,Ug.jsxs)("span",{children:[(o.grossTotal||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-emerald-600",children:[(0,Ug.jsx)("span",{children:"Total Paid"}),(0,Ug.jsxs)("span",{children:[ae(o).paid.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between font-bold ".concat(ae(o).balance>0?"text-red-600":"text-emerald-600"),children:[(0,Ug.jsx)("span",{children:"Balance Due"}),(0,Ug.jsxs)("span",{children:[ae(o).balance.toLocaleString()," UGX"]})]})]})]}),(0,Ug.jsxs)("div",{className:"mb-6",children:[(0,Ug.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,Ug.jsx)("h4",{className:"font-bold",children:"Payment History"}),ae(o).balance>0&&(0,Ug.jsxs)(xv,{variant:"success",size:"sm",onClick:()=>f(!0),className:"flex items-center gap-1",children:[(0,Ug.jsx)(K,{size:16})," Record Payment"]})]}),0===(o.payments||[]).length?(0,Ug.jsx)("p",{className:"text-slate-400 text-center py-4 bg-slate-50 rounded-lg",children:"No payments recorded yet"}):(0,Ug.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,Ug.jsxs)("table",{className:"w-full text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Date"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Method"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Reference"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Amount"}),(0,Ug.jsx)("th",{className:"p-3"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:(o.payments||[]).map((e,t)=>(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("td",{className:"p-3",children:new Date(e.date).toLocaleDateString()}),(0,Ug.jsx)("td",{className:"p-3",children:e.method}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.reference||"-"}),(0,Ug.jsx)("td",{className:"p-3 text-right font-mono font-bold text-emerald-600",children:e.amount.toLocaleString()}),(0,Ug.jsx)("td",{className:"p-3",children:(0,Ug.jsx)("button",{onClick:()=>p({event:o,payment:e}),className:"text-blue-600 hover:text-blue-800",children:(0,Ug.jsx)(q,{size:16})})})]},t))})]})})]}),(0,Ug.jsxs)("div",{className:"flex gap-3",children:[(0,Ug.jsxs)(xv,{variant:"secondary",onClick:()=>p({event:o,payment:null}),className:"flex items-center gap-2",children:[(0,Ug.jsx)(q,{size:16})," Print Invoice"]}),(0,Ug.jsx)(xv,{variant:"danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this event?"))try{await Hp(Am(dv,"artifacts",fv,"public","data","events",e)),l(null)}catch(t){alert("Failed to delete event: "+t.message)}})(o.id),children:"Delete Event"}),(0,Ug.jsx)(xv,{variant:"secondary",onClick:()=>l(null),className:"ml-auto",children:"Close"})]})]})]})}),h&&o&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",children:[(0,Ug.jsxs)("div",{className:"bg-emerald-600 text-white px-6 py-4 rounded-t-2xl",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Record Payment"}),(0,Ug.jsx)("p",{className:"text-emerald-100 text-sm",children:o.eventName})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsxs)("div",{className:"bg-slate-100 p-4 rounded-lg text-center",children:[(0,Ug.jsx)("span",{className:"text-slate-500 text-sm",children:"Balance Due"}),(0,Ug.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:[ae(o).balance.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Payment Amount (UGX) *"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg text-lg font-mono",placeholder:"0",value:X,onChange:e=>J(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Payment Method"}),(0,Ug.jsx)("select",{className:"w-full p-3 border rounded-lg bg-white",value:Y,onChange:e=>$(e.target.value),children:Wv.map(e=>(0,Ug.jsx)("option",{value:e,children:e},e))})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reference / Receipt No."}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",placeholder:"e.g., TXN-12345",value:Z,onChange:e=>ee(e.target.value)})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",placeholder:"e.g., Deposit payment",value:te,onChange:e=>ne(e.target.value)})]})]}),(0,Ug.jsxs)("div",{className:"border-t px-6 py-4 bg-slate-50 rounded-b-2xl flex justify-end gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",onClick:se,children:"Cancel"}),(0,Ug.jsx)(xv,{variant:"success",onClick:async()=>{if(!X||parseFloat(X)<=0)return void alert("Please enter a valid payment amount");const e={id:"PAY-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5).toUpperCase()),amount:parseFloat(X),method:Y,reference:Z||null,notes:te||null,date:(new Date).toISOString(),recordedBy:t||"Admin"},n=[...o.payments||[],e];try{await qp(Am(dv,"artifacts",fv,"public","data","events",o.id),{payments:n}),l(c(c({},o),{},{payments:n})),se(),window.confirm("Payment recorded! Would you like to print a receipt?")&&p({event:o,payment:e})}catch(r){alert("Failed to record payment: "+r.message)}},children:"Record Payment"})]})]})}),m&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-auto",children:[(0,Ug.jsx)("div",{className:"print:block hidden",children:(0,Ug.jsx)(Xv,{event:m.event,payment:m.payment})}),(0,Ug.jsxs)("div",{className:"print:hidden",children:[(0,Ug.jsxs)("div",{className:"bg-slate-800 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:m.payment?"Payment Receipt":"Event Invoice"}),(0,Ug.jsx)("button",{onClick:()=>p(null),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsx)("div",{className:"p-6",children:(0,Ug.jsx)(Qv,{event:m.event,payment:m.payment})}),(0,Ug.jsxs)("div",{className:"border-t px-6 py-4 bg-slate-50 rounded-b-2xl flex justify-end gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",onClick:()=>p(null),children:"Close"}),(0,Ug.jsxs)(xv,{variant:"primary",onClick:()=>window.print(),className:"flex items-center gap-2",children:[(0,Ug.jsx)(q,{size:16})," Print"]})]})]})]})})]})},Qv=e=>{let{event:t,payment:n}=e;const r=t?{paid:(t.payments||[]).reduce((e,t)=>e+t.amount,0),balance:(t.grossTotal||0)-(t.payments||[]).reduce((e,t)=>e+t.amount,0)}:{paid:0,balance:0};return(0,Ug.jsxs)("div",{className:"text-sm",children:[(0,Ug.jsxs)("div",{className:"text-center mb-6 pb-4 border-b",children:[(0,Ug.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:_v}),(0,Ug.jsx)("p",{className:"text-slate-500",children:Iv}),(0,Ug.jsx)("p",{className:"text-slate-500",children:Ev}),(0,Ug.jsx)("p",{className:"text-slate-500",children:Cv}),(0,Ug.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:Tv})]}),(0,Ug.jsxs)("div",{className:"text-center mb-4",children:[(0,Ug.jsx)("h3",{className:"text-lg font-bold uppercase",children:n?"Payment Receipt":"Tax Invoice"}),(0,Ug.jsxs)("p",{className:"text-slate-500",children:["#",n?n.id:t.id]}),(0,Ug.jsx)("p",{className:"text-slate-500",children:new Date((null===n||void 0===n?void 0:n.date)||t.createdAt).toLocaleDateString()})]}),(0,Ug.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg mb-4",children:[(0,Ug.jsx)("div",{className:"font-bold mb-2",children:"Event Details"}),(0,Ug.jsxs)("div",{className:"space-y-1",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Event:"})," ",t.eventName]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Type:"})," ",t.eventType]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Date:"})," ",new Date(t.eventDate).toLocaleDateString()]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Venue:"})," ",t.venue]}),t.contactName&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Client:"})," ",t.contactName]}),t.contactPhone&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("strong",{children:"Phone:"})," ",t.contactPhone]})]})]}),!n&&(0,Ug.jsx)("div",{className:"border rounded-lg overflow-hidden mb-4",children:(0,Ug.jsxs)("table",{className:"w-full",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-2 text-left",children:"Description"}),(0,Ug.jsx)("th",{className:"p-2 text-right",children:"Amount"})]})}),(0,Ug.jsxs)("tbody",{children:[(0,Ug.jsxs)("tr",{className:"border-b",children:[(0,Ug.jsxs)("td",{className:"p-2",children:["Event Services - ",t.eventType]}),(0,Ug.jsx)("td",{className:"p-2 text-right",children:(t.totalAmount||0).toLocaleString()})]}),(0,Ug.jsxs)("tr",{className:"border-b",children:[(0,Ug.jsx)("td",{className:"p-2",children:"VAT (18%)"}),(0,Ug.jsx)("td",{className:"p-2 text-right",children:(t.vatAmount||0).toLocaleString()})]}),(0,Ug.jsxs)("tr",{className:"font-bold",children:[(0,Ug.jsx)("td",{className:"p-2",children:"TOTAL"}),(0,Ug.jsxs)("td",{className:"p-2 text-right",children:[(t.grossTotal||0).toLocaleString()," UGX"]})]})]})]})}),n&&(0,Ug.jsx)("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-4 mb-4",children:(0,Ug.jsxs)("div",{className:"text-center",children:[(0,Ug.jsx)("div",{className:"text-slate-500 mb-1",children:"Amount Received"}),(0,Ug.jsxs)("div",{className:"text-3xl font-bold text-emerald-600",children:[n.amount.toLocaleString()," UGX"]}),(0,Ug.jsxs)("div",{className:"text-sm text-slate-500 mt-2",children:[(0,Ug.jsxs)("div",{children:["Method: ",n.method]}),n.reference&&(0,Ug.jsxs)("div",{children:["Ref: ",n.reference]})]})]})}),(0,Ug.jsxs)("div",{className:"border-t pt-4 space-y-1 text-sm",children:[(0,Ug.jsxs)("div",{className:"flex justify-between",children:[(0,Ug.jsx)("span",{children:"Total Invoice Amount"}),(0,Ug.jsxs)("span",{children:[(t.grossTotal||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between text-emerald-600",children:[(0,Ug.jsx)("span",{children:"Total Paid"}),(0,Ug.jsxs)("span",{children:[r.paid.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{className:"flex justify-between font-bold ".concat(r.balance>0?"text-red-600":"text-emerald-600"),children:[(0,Ug.jsx)("span",{children:"Balance Due"}),(0,Ug.jsxs)("span",{children:[r.balance.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{className:"text-center mt-6 pt-4 border-t text-xs text-slate-400",children:[(0,Ug.jsxs)("p",{children:["Recorded by: ",(null===n||void 0===n?void 0:n.recordedBy)||t.createdBy]}),(0,Ug.jsxs)("p",{className:"mt-2 italic",children:['"',Av,'"']}),(0,Ug.jsxs)("p",{className:"mt-2",children:["Thank you for choosing ",_v,"!"]})]})]})},Xv=e=>{let{event:t,payment:n}=e;const r=t?{paid:(t.payments||[]).reduce((e,t)=>e+t.amount,0),balance:(t.totalAmount||0)-(t.payments||[]).reduce((e,t)=>e+t.amount,0)}:{paid:0,balance:0};return(0,Ug.jsxs)("div",{style:{fontFamily:"Arial, sans-serif",padding:"20px",maxWidth:"400px",margin:"0 auto"},children:[(0,Ug.jsxs)("div",{style:{textAlign:"center",marginBottom:"20px",borderBottom:"2px solid #000",paddingBottom:"15px"},children:[(0,Ug.jsx)("h1",{style:{fontSize:"18px",margin:"0 0 5px 0",fontWeight:"bold"},children:_v}),(0,Ug.jsx)("p",{style:{margin:"2px 0",fontSize:"12px"},children:Iv}),(0,Ug.jsxs)("p",{style:{margin:"2px 0",fontSize:"12px"},children:[Ev," | ",Cv]}),(0,Ug.jsx)("p",{style:{margin:"5px 0",fontSize:"10px"},children:Tv})]}),(0,Ug.jsxs)("div",{style:{textAlign:"center",marginBottom:"15px"},children:[(0,Ug.jsx)("h2",{style:{fontSize:"14px",margin:"0",fontWeight:"bold",textTransform:"uppercase"},children:n?"Payment Receipt":"Tax Invoice"}),(0,Ug.jsxs)("p",{style:{margin:"5px 0",fontSize:"12px"},children:["#",n?n.id:t.id]}),(0,Ug.jsx)("p",{style:{margin:"5px 0",fontSize:"12px"},children:new Date((null===n||void 0===n?void 0:n.date)||t.createdAt).toLocaleString()})]}),(0,Ug.jsxs)("div",{style:{marginBottom:"15px",fontSize:"12px",borderTop:"1px dashed #000",borderBottom:"1px dashed #000",padding:"10px 0"},children:[(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:[(0,Ug.jsx)("strong",{children:"Event:"})," ",t.eventName]}),(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:[(0,Ug.jsx)("strong",{children:"Type:"})," ",t.eventType]}),(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:[(0,Ug.jsx)("strong",{children:"Date:"})," ",new Date(t.eventDate).toLocaleDateString()]}),(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:[(0,Ug.jsx)("strong",{children:"Venue:"})," ",t.venue]}),t.contactName&&(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:[(0,Ug.jsx)("strong",{children:"Client:"})," ",t.contactName]})]}),n?(0,Ug.jsxs)("div",{style:{textAlign:"center",padding:"15px",border:"2px solid #000",marginBottom:"15px"},children:[(0,Ug.jsx)("p",{style:{margin:"0",fontSize:"12px"},children:"Amount Received"}),(0,Ug.jsxs)("p",{style:{margin:"5px 0",fontSize:"24px",fontWeight:"bold"},children:[n.amount.toLocaleString()," UGX"]}),(0,Ug.jsxs)("p",{style:{margin:"5px 0",fontSize:"11px"},children:["Method: ",n.method]}),n.reference&&(0,Ug.jsxs)("p",{style:{margin:"5px 0",fontSize:"11px"},children:["Ref: ",n.reference]})]}):(0,Ug.jsx)("table",{style:{width:"100%",marginBottom:"15px",fontSize:"12px",borderCollapse:"collapse"},children:(0,Ug.jsxs)("tbody",{children:[(0,Ug.jsxs)("tr",{style:{borderBottom:"1px solid #ccc"},children:[(0,Ug.jsx)("td",{style:{padding:"5px 0"},children:"Event Services (Net)"}),(0,Ug.jsx)("td",{style:{padding:"5px 0",textAlign:"right"},children:(s=t.totalAmount||0,Math.round(s/1.18)).toLocaleString()})]}),(0,Ug.jsxs)("tr",{style:{borderBottom:"1px solid #ccc"},children:[(0,Ug.jsx)("td",{style:{padding:"5px 0"},children:"VAT (18%)"}),(0,Ug.jsx)("td",{style:{padding:"5px 0",textAlign:"right"},children:(e=>e-Math.round(e/1.18))(t.totalAmount||0).toLocaleString()})]}),(0,Ug.jsxs)("tr",{style:{fontWeight:"bold"},children:[(0,Ug.jsx)("td",{style:{padding:"5px 0"},children:"TOTAL"}),(0,Ug.jsxs)("td",{style:{padding:"5px 0",textAlign:"right"},children:[(t.totalAmount||0).toLocaleString()," UGX"]})]})]})}),(0,Ug.jsxs)("div",{style:{borderTop:"1px solid #000",paddingTop:"10px",fontSize:"12px"},children:[(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px"},children:[(0,Ug.jsx)("span",{children:"Invoice Total:"}),(0,Ug.jsxs)("span",{children:[(t.totalAmount||0).toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px"},children:[(0,Ug.jsx)("span",{children:"Paid:"}),(0,Ug.jsxs)("span",{children:[r.paid.toLocaleString()," UGX"]})]}),(0,Ug.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold"},children:[(0,Ug.jsx)("span",{children:"Balance:"}),(0,Ug.jsxs)("span",{children:[r.balance.toLocaleString()," UGX"]})]})]}),(0,Ug.jsxs)("div",{style:{textAlign:"center",marginTop:"20px",paddingTop:"15px",borderTop:"1px dashed #000",fontSize:"10px"},children:[(0,Ug.jsxs)("p",{style:{margin:"3px 0"},children:["Recorded by: ",(null===n||void 0===n?void 0:n.recordedBy)||t.createdBy]}),(0,Ug.jsxs)("p",{style:{margin:"10px 0",fontStyle:"italic"},children:['"',Av,'"']}),(0,Ug.jsxs)("p",{style:{margin:"5px 0"},children:["Thank you for choosing ",_v,"!"]})]})]});var s},Jv=e=>{var t,n;let{menu:s,staffName:i,userRole:a}=e;const[o,l]=(0,r.useState)("main_store"),[u,d]=(0,r.useState)(null===(t=pv[0])||void 0===t?void 0:t.id),[h,f]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[g,v]=(0,r.useState)([]),[y,x]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[N,S]=(0,r.useState)(null),[k,j]=(0,r.useState)(""),[C,T]=(0,r.useState)("");(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","mainStoreStock"),e=>f(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,r.useEffect)(()=>{if(!u)return;return Gp(Tm(dv,"artifacts",fv,"public","data","serviceCenterStock",u,"items"),e=>p(e.docs.map(e=>c({id:e.id},e.data()))))},[u]),(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","stockTransactions"),jp("date","desc")),e=>v(e.docs.slice(0,50).map(e=>c({id:e.id},e.data())))),[]);const A=h.filter(e=>e.quantity<(e.minThreshold||10)),D=s.filter(e=>"bar"===e.type),R=s.filter(e=>"kitchen"===e.type);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsx)("div",{className:"bg-white border-b px-6 py-4 shadow-sm",children:(0,Ug.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(I,{className:"text-teal-600"})," Stock Management"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm",children:"3-tier inventory: Main Store \u2192 Service Centers \u2192 Sales"})]}),A.length>0&&(0,Ug.jsxs)("div",{className:"flex items-center gap-2 bg-amber-100 text-amber-800 px-4 py-2 rounded-lg",children:[(0,Ug.jsx)(X,{size:20}),(0,Ug.jsxs)("span",{className:"font-bold",children:[A.length," items low in stock"]})]})]})}),(0,Ug.jsxs)("div",{className:"bg-white border-b flex",children:[(0,Ug.jsxs)("button",{onClick:()=>l("main_store"),className:"px-6 py-3 font-medium border-b-2 transition-colors ".concat("main_store"===o?"border-teal-500 text-teal-600":"border-transparent text-slate-500 hover:text-slate-700"),children:[(0,Ug.jsx)(_,{className:"inline mr-2",size:18})," Main Store"]}),(0,Ug.jsxs)("button",{onClick:()=>l("service_centers"),className:"px-6 py-3 font-medium border-b-2 transition-colors ".concat("service_centers"===o?"border-teal-500 text-teal-600":"border-transparent text-slate-500 hover:text-slate-700"),children:[(0,Ug.jsx)(I,{className:"inline mr-2",size:18})," Service Centers"]}),(0,Ug.jsxs)("button",{onClick:()=>l("transactions"),className:"px-6 py-3 font-medium border-b-2 transition-colors ".concat("transactions"===o?"border-teal-500 text-teal-600":"border-transparent text-slate-500 hover:text-slate-700"),children:[(0,Ug.jsx)(J,{className:"inline mr-2",size:18})," Transactions"]})]}),(0,Ug.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:["main_store"===o&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,Ug.jsx)(xv,{onClick:()=>x(!0),icon:K,children:"Receive Stock"}),(0,Ug.jsx)(xv,{onClick:()=>w(!0),variant:"secondary",icon:E,children:"Issue to Center"})]}),(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:[(0,Ug.jsx)("div",{className:"bg-teal-50 px-4 py-3 border-b font-bold text-teal-800",children:"Main Store Inventory"}),(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 uppercase text-xs font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3",children:"Item"}),(0,Ug.jsx)("th",{className:"p-3",children:"Category"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Quantity"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Min Level"}),(0,Ug.jsx)("th",{className:"p-3",children:"Status"}),(0,Ug.jsx)("th",{className:"p-3",children:"Last Updated"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:0===h.length?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"6",className:"p-8 text-center text-slate-400",children:"No stock records. Receive items to get started."})}):h.map(e=>(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50 ".concat(e.quantity<(e.minThreshold||10)?"bg-red-50":""),children:[(0,Ug.jsx)("td",{className:"p-3 font-medium",children:e.itemName}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.category}),(0,Ug.jsx)("td",{className:"p-3 text-center font-bold text-lg",children:e.quantity}),(0,Ug.jsx)("td",{className:"p-3 text-center text-slate-500",children:e.minThreshold||10}),(0,Ug.jsx)("td",{className:"p-3",children:e.quantity<(e.minThreshold||10)?(0,Ug.jsx)("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-bold",children:"LOW"}):(0,Ug.jsx)("span",{className:"bg-emerald-100 text-emerald-700 px-2 py-1 rounded text-xs font-bold",children:"OK"})}),(0,Ug.jsx)("td",{className:"p-3 text-slate-400 text-xs",children:e.lastUpdated?new Date(e.lastUpdated).toLocaleDateString():"-"})]},e.id))})]})]})]}),"service_centers"===o&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"flex gap-2 mb-6",children:pv.map(e=>(0,Ug.jsx)("button",{onClick:()=>d(e.id),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat(u===e.id?"bg-teal-600 text-white":"bg-white border hover:bg-slate-50"),children:e.name},e.id))}),(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"bg-blue-50 px-4 py-3 border-b font-bold text-blue-800",children:[null===(n=pv.find(e=>e.id===u))||void 0===n?void 0:n.name," Stock"]}),(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 uppercase text-xs font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3",children:"Item"}),(0,Ug.jsx)("th",{className:"p-3",children:"Category"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Quantity"}),(0,Ug.jsx)("th",{className:"p-3",children:"Last Received"}),(0,Ug.jsx)("th",{className:"p-3",children:"Received By"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:0===m.length?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"5",className:"p-8 text-center text-slate-400",children:"No stock in this center yet"})}):m.map(e=>(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsx)("td",{className:"p-3 font-medium",children:e.itemName}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.category}),(0,Ug.jsx)("td",{className:"p-3 text-center font-bold text-lg",children:e.quantity}),(0,Ug.jsx)("td",{className:"p-3 text-slate-400 text-xs",children:e.lastReceived?new Date(e.lastReceived).toLocaleDateString():"-"}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.receivedBy||"-"})]},e.id))})]})]})]}),"transactions"===o&&(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:[(0,Ug.jsx)("div",{className:"bg-violet-50 px-4 py-3 border-b font-bold text-violet-800",children:"Stock Movement History"}),(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 uppercase text-xs font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3",children:"Date/Time"}),(0,Ug.jsx)("th",{className:"p-3",children:"Type"}),(0,Ug.jsx)("th",{className:"p-3",children:"Item"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Qty"}),(0,Ug.jsx)("th",{className:"p-3",children:"From"}),(0,Ug.jsx)("th",{className:"p-3",children:"To"}),(0,Ug.jsx)("th",{className:"p-3",children:"By"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:g.map(e=>{var t;return(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsx)("td",{className:"p-3 text-slate-500 text-xs",children:new Date(e.date).toLocaleString()}),(0,Ug.jsxs)("td",{className:"p-3",children:["receive"===e.type&&(0,Ug.jsx)("span",{className:"bg-emerald-100 text-emerald-700 px-2 py-1 rounded text-xs font-bold",children:"RECEIVE"}),"issue"===e.type&&(0,Ug.jsx)("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs font-bold",children:"ISSUE"})]}),(0,Ug.jsx)("td",{className:"p-3 font-medium",children:e.itemName}),(0,Ug.jsx)("td",{className:"p-3 text-center font-bold",children:e.quantity}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:"main_store"===e.fromLocation?"Main Store":e.fromLocation}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:(null===(t=pv.find(t=>t.id===e.toLocation))||void 0===t?void 0:t.name)||e.toLocation}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:e.receivedBy||e.issuedBy})]},e.id)})})]})]})]}),y&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",children:[(0,Ug.jsxs)("div",{className:"bg-teal-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Receive Stock to Main Store"}),(0,Ug.jsx)("button",{onClick:()=>x(!1),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Select Item"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg",value:(null===N||void 0===N?void 0:N.id)||"",onChange:e=>S([...D,...R,...gv].find(t=>t.id===e.target.value)),children:[(0,Ug.jsx)("option",{value:"",children:"-- Select Item --"}),(0,Ug.jsx)("optgroup",{label:"Bar Items",children:D.map(e=>(0,Ug.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,Ug.jsx)("optgroup",{label:"Kitchen Items (Menu)",children:R.map(e=>(0,Ug.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,Ug.jsx)("optgroup",{label:"Kitchen Raw Materials",children:gv.map(e=>(0,Ug.jsxs)("option",{value:e.id,children:[e.name," (",e.unit,")"]},e.id))})]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",value:k,onChange:e=>j(e.target.value),placeholder:"Enter quantity"})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supplier"}),(0,Ug.jsx)("input",{type:"text",className:"w-full p-3 border rounded-lg",value:C,onChange:e=>T(e.target.value),placeholder:"Supplier name"})]}),(0,Ug.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:()=>x(!1),children:"Cancel"}),(0,Ug.jsx)(xv,{className:"flex-1",onClick:async()=>{if(!N||!k||!C)return;const e="RCV-".concat(Date.now());try{await Bp(Am(dv,"artifacts",fv,"public","data","mainStoreStock",N.id),{itemId:N.id,itemName:N.name,category:N.category,type:N.type||"stock",quantity:eg(parseInt(k)),unit:N.unit||"pcs",lastUpdated:(new Date).toISOString(),minThreshold:10},{merge:!0}),await Bp(Am(dv,"artifacts",fv,"public","data","stockTransactions",e),{id:e,type:"receive",itemId:N.id,itemName:N.name,quantity:parseInt(k),fromLocation:C,toLocation:"main_store",receivedBy:i,date:(new Date).toISOString()}),alert("\u2713 Received ".concat(k," x ").concat(N.name," from ").concat(C)),x(!1),S(null),j(""),T("")}catch(t){console.error("Stock Receive Error:",t),alert("Error receiving stock: "+t.message)}},disabled:!N||!k||!C,children:"Receive Stock"})]})]})]})}),b&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",children:[(0,Ug.jsxs)("div",{className:"bg-blue-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Issue Stock to Service Center"}),(0,Ug.jsx)("button",{onClick:()=>w(!1),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Select Item (from Main Store)"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg",value:(null===N||void 0===N?void 0:N.id)||"",onChange:e=>{const t=h.find(t=>t.id===e.target.value);S(t)},children:[(0,Ug.jsx)("option",{value:"",children:"-- Select Item --"}),h.map(e=>(0,Ug.jsxs)("option",{value:e.id,children:[e.itemName," (Qty: ",e.quantity,")"]},e.id))]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Issue To"}),(0,Ug.jsx)("select",{className:"w-full p-3 border rounded-lg",value:u,onChange:e=>d(e.target.value),children:pv.map(e=>(0,Ug.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",value:k,onChange:e=>j(e.target.value),placeholder:"Enter quantity"}),N&&(0,Ug.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Available: ",N.quantity]})]}),(0,Ug.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:()=>w(!1),children:"Cancel"}),(0,Ug.jsx)(xv,{className:"flex-1",onClick:async()=>{var e;if(!N||!k||!u)return;const t=h.find(e=>e.id===N.id),n=(null===t||void 0===t?void 0:t.quantity)||0,r=parseInt(k);if(n<r)return void alert("Insufficient stock. Only ".concat(n," available."));const s="ISS-".concat(Date.now()),a=(null===(e=pv.find(e=>e.id===u))||void 0===e?void 0:e.name)||"Service Center";try{await qp(Am(dv,"artifacts",fv,"public","data","mainStoreStock",N.id),{quantity:eg(-r),lastUpdated:(new Date).toISOString()}),await Bp(Am(dv,"artifacts",fv,"public","data","serviceCenterStock",u,"items",N.id),{itemId:N.id,itemName:N.itemName||N.name||"Unknown Item",category:N.category||"Uncategorized",quantity:eg(r),lastReceived:(new Date).toISOString(),receivedBy:i},{merge:!0}),await Bp(Am(dv,"artifacts",fv,"public","data","stockTransactions",s),{id:s,type:"issue",itemId:N.id,itemName:N.itemName||N.name||"Unknown Item",quantity:r,fromLocation:"main_store",toLocation:u,destinationName:a,issuedBy:i,date:(new Date).toISOString()}),alert("\u2713 Issued ".concat(k," x ").concat(N.itemName||N.name||"Unknown Item"," to ").concat(a)),w(!1),S(null),j("")}catch(o){console.error("Stock Issue Error:",o),alert("Error issuing stock: "+o.message)}},disabled:!N||!k,children:"Issue Stock"})]})]})]})})]})},Yv=e=>{let{staffName:t,userRole:n,serviceCenter:s}=e;const[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)([]),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)([]),[m,p]=(0,r.useState)(""),[g,v]=(0,r.useState)("all"),y=["admin","supervisor"].includes(n);(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","requisitions"),jp("createdAt","desc")),e=>a(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","mainStoreStock"),e=>l(e.docs.map(e=>c({id:e.id},e.data())))),[]);const x=i.filter(e=>"all"===g?!!y||e.serviceCenter===s:"pending"===g?"pending"===e.status:"approved"===g?"approved"===e.status:"mine"!==g||e.serviceCenter===s);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsx)("div",{className:"bg-white border-b px-6 py-4 shadow-sm",children:(0,Ug.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(E,{className:"text-orange-600"})," Digital Requisitions"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm",children:"Request stock from main store with approval workflow"})]}),s&&(0,Ug.jsx)(xv,{onClick:()=>d(!0),icon:K,children:"New Requisition"})]})}),(0,Ug.jsx)("div",{className:"bg-white border-b px-6 py-3 flex gap-2",children:["all","pending","approved","mine"].map(e=>(0,Ug.jsx)("button",{onClick:()=>v(e),className:"px-4 py-1.5 rounded-full text-sm font-medium transition-all ".concat(g===e?"bg-orange-500 text-white":"bg-slate-100 hover:bg-slate-200"),children:"all"===e?"All":"pending"===e?"Pending":"approved"===e?"Approved":"My Requests"},e))}),(0,Ug.jsx)("div",{className:"flex-1 overflow-auto p-6",children:(0,Ug.jsx)("div",{className:"space-y-4",children:0===x.length?(0,Ug.jsx)("div",{className:"bg-white rounded-xl p-8 text-center text-slate-400",children:"No requisitions found"}):x.map(e=>(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b flex items-center justify-between ".concat("pending"===e.status?"bg-amber-50":"approved"===e.status?"bg-blue-50":"fulfilled"===e.status?"bg-emerald-50":"bg-red-50"),children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ug.jsxs)("span",{className:"font-mono text-sm text-slate-500",children:["#",e.id]}),(0,Ug.jsx)("span",{className:"font-bold",children:e.serviceCenterName}),(0,Ug.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-bold ".concat("pending"===e.status?"bg-amber-200 text-amber-800":"approved"===e.status?"bg-blue-200 text-blue-800":"fulfilled"===e.status?"bg-emerald-200 text-emerald-800":"bg-red-200 text-red-800"),children:e.status.toUpperCase()})]}),(0,Ug.jsx)("span",{className:"text-sm text-slate-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,Ug.jsxs)("div",{className:"p-4",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Requested by:"})," ",(0,Ug.jsx)("span",{className:"font-medium",children:e.requestedBy})]}),e.approvedBy&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Approved by:"})," ",(0,Ug.jsx)("span",{className:"font-medium",children:e.approvedBy})]}),e.issuedBy&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Issued by:"})," ",(0,Ug.jsx)("span",{className:"font-medium",children:e.issuedBy})]}),e.rejectedBy&&(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Rejected by:"})," ",(0,Ug.jsx)("span",{className:"font-medium text-red-600",children:e.rejectedBy})]})]}),(0,Ug.jsxs)("table",{className:"w-full text-sm mb-4",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-2 text-left",children:"Item"}),(0,Ug.jsx)("th",{className:"p-2 text-center",children:"Qty"})]})}),(0,Ug.jsx)("tbody",{children:e.items.map((e,t)=>(0,Ug.jsxs)("tr",{className:"border-b",children:[(0,Ug.jsx)("td",{className:"p-2",children:e.itemName}),(0,Ug.jsx)("td",{className:"p-2 text-center font-bold",children:e.quantity})]},t))})]}),e.notes&&(0,Ug.jsxs)("p",{className:"text-sm text-slate-600 bg-slate-50 p-2 rounded mb-4",children:[(0,Ug.jsx)("strong",{children:"Notes:"})," ",e.notes]}),e.rejectionReason&&(0,Ug.jsxs)("p",{className:"text-sm text-red-600 bg-red-50 p-2 rounded mb-4",children:[(0,Ug.jsx)("strong",{children:"Rejection reason:"})," ",e.rejectionReason]}),y&&"pending"===e.status&&(0,Ug.jsxs)("div",{className:"flex gap-2",children:[(0,Ug.jsx)(xv,{variant:"success",onClick:()=>(async e=>{try{await qp(Am(dv,"artifacts",fv,"public","data","requisitions",e.id),{status:"approved",approvedBy:t,approvedAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),alert("\u2713 Requisition approved")}catch(n){alert("Error: "+n.message)}})(e),icon:Y,children:"Approve"}),(0,Ug.jsx)(xv,{variant:"danger",onClick:()=>(async e=>{const n=window.prompt("Rejection reason:");if(n)try{await qp(Am(dv,"artifacts",fv,"public","data","requisitions",e.id),{status:"rejected",rejectedBy:t,rejectedAt:(new Date).toISOString(),rejectionReason:n,updatedAt:(new Date).toISOString()}),alert("\u2713 Requisition rejected")}catch(r){alert("Error: "+r.message)}})(e),icon:$,children:"Reject"})]}),y&&"approved"===e.status&&(0,Ug.jsx)(xv,{onClick:()=>(async e=>{try{for(const n of e.items){const r=o.find(e=>e.id===n.itemId);if(!r||r.quantity<n.quantity)return void alert("Insufficient stock for ".concat(n.itemName));await qp(Am(dv,"artifacts",fv,"public","data","mainStoreStock",n.itemId),{quantity:eg(-n.quantity),lastUpdated:(new Date).toISOString()});const s=await Up(Am(dv,"artifacts",fv,"public","data","serviceCenterStock",e.serviceCenter,"items",n.itemId)),i=s.exists()?s.data().quantity:0;await Bp(Am(dv,"artifacts",fv,"public","data","serviceCenterStock",e.serviceCenter,"items",n.itemId),{itemId:n.itemId,itemName:n.itemName||"Unknown Item",quantity:i+n.quantity,lastReceived:(new Date).toISOString(),receivedBy:t});const a="ISS-REQ-".concat(Date.now(),"-").concat(n.itemId);await Bp(Am(dv,"artifacts",fv,"public","data","stockTransactions",a),{id:a,type:"issue",itemId:n.itemId,itemName:n.itemName||"Unknown Item",quantity:n.quantity,fromLocation:"main_store",toLocation:e.serviceCenter,issuedBy:t,requisitionId:e.id,date:(new Date).toISOString()})}await qp(Am(dv,"artifacts",fv,"public","data","requisitions",e.id),{status:"fulfilled",issuedBy:t,issuedAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),alert("\u2713 Requisition fulfilled and stock issued")}catch(n){alert("Error: "+n.message)}})(e),icon:I,children:"Fulfill & Issue Stock"})]})]},e.id))})}),u&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:[(0,Ug.jsxs)("div",{className:"bg-orange-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center sticky top-0",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"New Requisition"}),(0,Ug.jsx)("button",{onClick:()=>d(!1),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"p-6",children:[(0,Ug.jsxs)("div",{className:"mb-4",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Items from Main Store"}),(0,Ug.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border rounded-lg p-2",children:o.filter(e=>e.quantity>0).map(e=>(0,Ug.jsxs)("button",{onClick:()=>{return t=e,void(h.find(e=>e.id===t.id)||f([...h,c(c({},t),{},{requestQty:1})]));var t},className:"p-2 text-left text-sm rounded border transition-all ".concat(h.find(t=>t.id===e.id)?"bg-orange-100 border-orange-300":"hover:bg-slate-50"),children:[(0,Ug.jsx)("div",{className:"font-medium",children:e.itemName}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-500",children:["Available: ",e.quantity]})]},e.id))})]}),h.length>0&&(0,Ug.jsxs)("div",{className:"mb-4",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Requested Items"}),(0,Ug.jsxs)("table",{className:"w-full text-sm border rounded-lg overflow-hidden",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-2 text-left",children:"Item"}),(0,Ug.jsx)("th",{className:"p-2 text-center",children:"Qty"}),(0,Ug.jsx)("th",{className:"p-2"})]})}),(0,Ug.jsx)("tbody",{children:h.map((e,t)=>(0,Ug.jsxs)("tr",{className:"border-b",children:[(0,Ug.jsx)("td",{className:"p-2",children:e.itemName}),(0,Ug.jsx)("td",{className:"p-2 text-center",children:(0,Ug.jsx)("input",{type:"number",className:"w-20 p-1 border rounded text-center",min:"1",max:e.quantity,value:e.requestQty,onChange:e=>{const n=[...h];n[t].requestQty=e.target.value,f(n)}})}),(0,Ug.jsx)("td",{className:"p-2 text-center",children:(0,Ug.jsx)("button",{onClick:()=>f(h.filter(t=>t.id!==e.id)),className:"text-red-500 hover:text-red-700",children:(0,Ug.jsx)(U,{size:16})})})]},e.id))})]})]}),(0,Ug.jsxs)("div",{className:"mb-4",children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes (optional)"}),(0,Ug.jsx)("textarea",{className:"w-full p-3 border rounded-lg",rows:"2",value:m,onChange:e=>p(e.target.value),placeholder:"Any special instructions..."})]}),(0,Ug.jsxs)("div",{className:"flex gap-3",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:()=>d(!1),children:"Cancel"}),(0,Ug.jsx)(xv,{className:"flex-1",onClick:async()=>{var e;if(0===h.length)return void alert("Add at least one item");const n="REQ-".concat(Date.now()),r={id:n,serviceCenter:s,serviceCenterName:(null===(e=pv.find(e=>e.id===s))||void 0===e?void 0:e.name)||s,requestedBy:t,items:h.map(e=>({itemId:e.id,itemName:e.itemName,quantity:parseInt(e.requestQty),unit:"pcs"})),status:"pending",notes:m,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};try{await Bp(Am(dv,"artifacts",fv,"public","data","requisitions",n),r),alert("\u2713 Requisition submitted"),d(!1),f([]),p("")}catch(i){alert("Error: "+i.message)}},disabled:0===h.length,children:"Submit Requisition"})]})]})]})})]})},$v=e=>{let{staffName:t,userRole:n}=e;const[s,i]=(0,r.useState)([]),[a,o]=(0,r.useState)([]),[l,u]=(0,r.useState)([]),[d,h]=(0,r.useState)((new Date).toISOString().slice(0,7)),[f,m]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),[v,y]=(0,r.useState)(""),x=["admin","supervisor"].includes(n);(0,r.useEffect)(()=>{const e=Gp(Tm(dv,"artifacts",fv,"public","data","staffPerformance"),e=>i(e.docs.map(e=>c({id:e.id},e.data())).filter(e=>e.month===d)));return e},[d]),(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","salesTargets"),e=>o(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","staffShifts"),e=>u(e.docs.map(e=>c({id:e.id},e.data())))),[]);const b=e=>a.find(t=>t.staffId===e&&t.month===d);return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-50",children:[(0,Ug.jsx)("div",{className:"bg-white border-b px-6 py-4 shadow-sm",children:(0,Ug.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(C,{className:"text-violet-600"})," Performance Tracking"]}),(0,Ug.jsx)("p",{className:"text-slate-500 text-sm",children:"Staff sales, targets, and productivity metrics"})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ug.jsx)("input",{type:"month",className:"p-2 border rounded-lg",value:d,onChange:e=>h(e.target.value)}),x&&(0,Ug.jsx)(xv,{onClick:()=>m(!0),icon:C,children:"Set Target"})]})]})}),(0,Ug.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,Ug.jsxs)("div",{className:"mb-6",children:[(0,Ug.jsxs)("h3",{className:"font-bold text-slate-800 mb-3 flex items-center gap-2",children:[(0,Ug.jsx)(T,{className:"text-emerald-600"})," Currently On Shift"]}),(0,Ug.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:0===l.length?(0,Ug.jsx)("div",{className:"col-span-full bg-white rounded-xl p-4 text-center text-slate-400",children:"No active shifts"}):l.map(e=>{var t;return(0,Ug.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-emerald-200 shadow-sm",children:[(0,Ug.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Ug.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),(0,Ug.jsx)("span",{className:"font-bold",children:e.staffName})]}),(0,Ug.jsx)("div",{className:"text-sm text-slate-500",children:(null===(t=pv.find(t=>t.id===e.serviceCenter))||void 0===t?void 0:t.name)||e.serviceCenter}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-400 mt-1",children:["Since ",new Date(e.loginTime).toLocaleTimeString()]}),(0,Ug.jsxs)("div",{className:"mt-2 pt-2 border-t grid grid-cols-2 gap-2 text-xs",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Orders:"})," ",(0,Ug.jsx)("span",{className:"font-bold",children:e.ordersCount||0})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("span",{className:"text-slate-500",children:"Sales:"})," ",(0,Ug.jsx)("span",{className:"font-bold text-emerald-600",children:(e.totalSales||0).toLocaleString()})]})]})]},e.id)})})]}),(0,Ug.jsxs)("div",{className:"bg-white rounded-xl shadow border overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"bg-violet-50 px-4 py-3 border-b font-bold text-violet-800 flex items-center gap-2",children:[(0,Ug.jsx)(Z,{size:18})," Monthly Performance - ",new Date(d+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),(0,Ug.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-100 text-slate-600 uppercase text-xs font-bold",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3",children:"Staff"}),(0,Ug.jsx)("th",{className:"p-3",children:"Service Center"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Orders"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Items Sold"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Total Sales"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Target"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Achievement"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y",children:0===s.length?(0,Ug.jsx)("tr",{children:(0,Ug.jsx)("td",{colSpan:"7",className:"p-8 text-center text-slate-400",children:"No performance data for this month"})}):s.map(e=>{var t;const n=b(e.staffId),r=(e=>{const t=b(e.staffId);return t&&0!==t.target?Math.round(e.totalSales/t.target*100):null})(e);return(0,Ug.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,Ug.jsx)("td",{className:"p-3 font-medium",children:e.staffName||e.staffId}),(0,Ug.jsx)("td",{className:"p-3 text-slate-500",children:(null===(t=pv.find(t=>t.id===e.serviceCenter))||void 0===t?void 0:t.name)||e.serviceCenter}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:e.ordersCount||0}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:e.itemsSold||0}),(0,Ug.jsxs)("td",{className:"p-3 text-right font-bold text-emerald-600",children:[(e.totalSales||0).toLocaleString()," UGX"]}),(0,Ug.jsx)("td",{className:"p-3 text-right text-slate-500",children:n?n.target.toLocaleString():"-"}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:null!==r?(0,Ug.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat(r>=100?"bg-emerald-100 text-emerald-700":r>=75?"bg-blue-100 text-blue-700":r>=50?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"),children:[r,"%"]}):"-"})]},e.id)})})]})]}),s.length>0&&(0,Ug.jsxs)("div",{className:"mt-6",children:[(0,Ug.jsxs)("h3",{className:"font-bold text-slate-800 mb-3 flex items-center gap-2",children:[(0,Ug.jsx)(ee,{className:"text-amber-500"})," Top Performers"]}),(0,Ug.jsx)("div",{className:"grid grid-cols-3 gap-4",children:s.sort((e,t)=>(t.totalSales||0)-(e.totalSales||0)).slice(0,3).map((e,t)=>{var n;return(0,Ug.jsxs)("div",{className:"rounded-xl p-4 text-center ".concat(0===t?"bg-amber-100 border-2 border-amber-300":"bg-white border"),children:[(0,Ug.jsx)("div",{className:"text-3xl mb-2 ".concat(0===t?"":"grayscale opacity-50"),children:0===t?"\ud83e\udd47":1===t?"\ud83e\udd48":"\ud83e\udd49"}),(0,Ug.jsx)("div",{className:"font-bold",children:e.staffName||e.staffId}),(0,Ug.jsx)("div",{className:"text-sm text-slate-500",children:null===(n=pv.find(t=>t.id===e.serviceCenter))||void 0===n?void 0:n.name}),(0,Ug.jsxs)("div",{className:"text-lg font-bold text-emerald-600 mt-2",children:[(e.totalSales||0).toLocaleString()," UGX"]})]},e.id)})})]})]}),f&&(0,Ug.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,Ug.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",children:[(0,Ug.jsxs)("div",{className:"bg-violet-600 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center",children:[(0,Ug.jsx)("h3",{className:"text-xl font-bold",children:"Set Sales Target"}),(0,Ug.jsx)("button",{onClick:()=>m(!1),className:"text-white/70 hover:text-white",children:(0,Ug.jsx)(U,{size:24})})]}),(0,Ug.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Staff Member"}),(0,Ug.jsxs)("select",{className:"w-full p-3 border rounded-lg",value:p,onChange:e=>g(e.target.value),children:[(0,Ug.jsx)("option",{value:"",children:"-- Select Staff --"}),mv.filter(e=>["barperson","service_staff"].includes(e.role)).map(e=>(0,Ug.jsxs)("option",{value:e.email,children:[e.name," (",e.serviceCenter,")"]},e.email))]})]}),(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Monthly Target (UGX)"}),(0,Ug.jsx)("input",{type:"number",className:"w-full p-3 border rounded-lg",value:v,onChange:e=>y(e.target.value),placeholder:"e.g. 5000000"})]}),(0,Ug.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,Ug.jsx)(xv,{variant:"secondary",className:"flex-1",onClick:()=>m(!1),children:"Cancel"}),(0,Ug.jsx)(xv,{className:"flex-1",onClick:async()=>{if(!p||!v)return;const e="".concat(p,"_").concat(d);try{var n;await Bp(Am(dv,"artifacts",fv,"public","data","salesTargets",e),{staffId:p,staffName:(null===(n=mv.find(e=>e.email===p))||void 0===n?void 0:n.name)||p,month:d,target:parseInt(v),setBy:t,setAt:(new Date).toISOString()}),alert("\u2713 Target set"),m(!1),g(""),y("")}catch(r){alert("Error: "+r.message)}},disabled:!p||!v,children:"Set Target"})]})]})]})})]})},Zv=e=>{let{staffName:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)([]),[u,d]=(0,r.useState)([]),[h,f]=(0,r.useState)([]),[m,p]=(0,r.useState)(0);(0,r.useEffect)(()=>{const e=setInterval(()=>p(e=>e+1),3e4);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","staffShifts"),e=>s(e.docs.map(e=>c({id:e.id},e.data())))),[]),(0,r.useEffect)(()=>{const e=(new Date).toLocaleDateString();return Gp(bp(Tm(dv,"artifacts",fv,"public","data","sales"),jp("date","desc")),t=>a(t.docs.map(e=>e.data()).filter(t=>new Date(t.date).toLocaleDateString()===e)))},[m]),(0,r.useEffect)(()=>{const e=(new Date).toLocaleDateString();return Gp(bp(Tm(dv,"artifacts",fv,"public","data","voids"),jp("date","desc")),t=>l(t.docs.map(e=>e.data()).filter(t=>new Date(t.date).toLocaleDateString()===e)))},[m]),(0,r.useEffect)(()=>Gp(bp(Tm(dv,"artifacts",fv,"public","data","requisitions"),jp("createdAt","desc")),e=>d(e.docs.map(e=>c({id:e.id},e.data())).filter(e=>"pending"===e.status))),[]),(0,r.useEffect)(()=>Gp(Tm(dv,"artifacts",fv,"public","data","mainStoreStock"),e=>f(e.docs.map(e=>c({id:e.id},e.data())).filter(e=>e.quantity<(e.minThreshold||10)))),[]);const g=i.reduce((e,t)=>e+t.total,0),v=o.reduce((e,t)=>e+t.price*t.qty,0),y=pv.map(e=>c(c({},e),{},{sales:i.filter(t=>t.department===e.name).reduce((e,t)=>e+t.total,0),orders:i.filter(t=>t.department===e.name).length}));return(0,Ug.jsxs)("div",{className:"h-full flex flex-col bg-slate-900 text-white",children:[(0,Ug.jsx)("div",{className:"bg-slate-800 border-b border-slate-700 px-6 py-4",children:(0,Ug.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,Ug.jsx)(T,{className:"text-fuchsia-400"})," Supervisor Dashboard"]}),(0,Ug.jsx)("p",{className:"text-slate-400 text-sm",children:"Real-time operations visibility"})]}),(0,Ug.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ug.jsx)("button",{onClick:()=>p(e=>e+1),className:"p-2 bg-slate-700 rounded-lg hover:bg-slate-600",children:(0,Ug.jsx)(te,{size:20})}),(0,Ug.jsxs)("div",{className:"text-right",children:[(0,Ug.jsx)("div",{className:"text-xs text-slate-400",children:"Last updated"}),(0,Ug.jsx)("div",{className:"text-sm font-mono",children:(new Date).toLocaleTimeString()})]})]})]})}),(0,Ug.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,Ug.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,Ug.jsxs)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-700 rounded-xl p-4",children:[(0,Ug.jsx)("div",{className:"text-emerald-100 text-sm",children:"Today's Sales"}),(0,Ug.jsx)("div",{className:"text-3xl font-bold",children:g.toLocaleString()}),(0,Ug.jsxs)("div",{className:"text-emerald-200 text-sm",children:[i.length," transactions"]})]}),(0,Ug.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-red-700 rounded-xl p-4",children:[(0,Ug.jsx)("div",{className:"text-red-100 text-sm",children:"Today's Voids"}),(0,Ug.jsx)("div",{className:"text-3xl font-bold",children:v.toLocaleString()}),(0,Ug.jsxs)("div",{className:"text-red-200 text-sm",children:[o.length," items voided"]})]}),(0,Ug.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-700 rounded-xl p-4",children:[(0,Ug.jsx)("div",{className:"text-blue-100 text-sm",children:"Active Staff"}),(0,Ug.jsx)("div",{className:"text-3xl font-bold",children:n.length}),(0,Ug.jsx)("div",{className:"text-blue-200 text-sm",children:"currently on shift"})]}),(0,Ug.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-700 rounded-xl p-4",children:[(0,Ug.jsx)("div",{className:"text-amber-100 text-sm",children:"Pending Requisitions"}),(0,Ug.jsx)("div",{className:"text-3xl font-bold",children:u.length}),(0,Ug.jsx)("div",{className:"text-amber-200 text-sm",children:"awaiting approval"})]})]}),(0,Ug.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Ug.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 font-bold flex items-center gap-2",children:[(0,Ug.jsx)(Z,{size:18,className:"text-emerald-400"})," Sales by Service Center"]}),(0,Ug.jsx)("div",{className:"p-4 space-y-3",children:y.map(e=>(0,Ug.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ug.jsx)("div",{className:"w-32 text-sm text-slate-300",children:e.name}),(0,Ug.jsx)("div",{className:"flex-1 bg-slate-700 rounded-full h-6 overflow-hidden",children:(0,Ug.jsx)("div",{className:"bg-emerald-500 h-full rounded-full transition-all",style:{width:"".concat(g>0?e.sales/g*100:0,"%")}})}),(0,Ug.jsx)("div",{className:"w-24 text-right font-mono text-sm",children:e.sales.toLocaleString()}),(0,Ug.jsxs)("div",{className:"w-16 text-right text-xs text-slate-400",children:[e.orders," orders"]})]},e.id))})]}),(0,Ug.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 font-bold flex items-center gap-2",children:[(0,Ug.jsx)(T,{size:18,className:"text-blue-400"})," Active Shifts"]}),(0,Ug.jsx)("div",{className:"divide-y divide-slate-700 max-h-64 overflow-y-auto",children:0===n.length?(0,Ug.jsx)("div",{className:"p-4 text-center text-slate-500",children:"No active shifts"}):n.map(e=>{var t;return(0,Ug.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsxs)("div",{className:"font-medium flex items-center gap-2",children:[(0,Ug.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.staffName]}),(0,Ug.jsx)("div",{className:"text-xs text-slate-400",children:null===(t=pv.find(t=>t.id===e.serviceCenter))||void 0===t?void 0:t.name})]}),(0,Ug.jsxs)("div",{className:"text-right",children:[(0,Ug.jsxs)("div",{className:"font-mono text-emerald-400",children:[(e.totalSales||0).toLocaleString()," UGX"]}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-400",children:[e.ordersCount||0," orders"]})]})]},e.id)})})]}),(0,Ug.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 font-bold flex items-center gap-2",children:[(0,Ug.jsx)(X,{size:18,className:"text-amber-400"})," Low Stock Alerts"]}),(0,Ug.jsx)("div",{className:"divide-y divide-slate-700 max-h-64 overflow-y-auto",children:0===h.length?(0,Ug.jsx)("div",{className:"p-4 text-center text-slate-500",children:"No low stock items"}):h.map(e=>(0,Ug.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,Ug.jsxs)("div",{children:[(0,Ug.jsx)("div",{className:"font-medium",children:e.itemName}),(0,Ug.jsx)("div",{className:"text-xs text-slate-400",children:e.category})]}),(0,Ug.jsxs)("div",{className:"text-right",children:[(0,Ug.jsxs)("div",{className:"font-mono text-red-400",children:[e.quantity," left"]}),(0,Ug.jsxs)("div",{className:"text-xs text-slate-400",children:["min: ",e.minThreshold||10]})]})]},e.id))})]}),(0,Ug.jsxs)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 font-bold flex items-center gap-2",children:[(0,Ug.jsx)(E,{size:18,className:"text-orange-400"})," Pending Requisitions"]}),(0,Ug.jsx)("div",{className:"divide-y divide-slate-700 max-h-64 overflow-y-auto",children:0===u.length?(0,Ug.jsx)("div",{className:"p-4 text-center text-slate-500",children:"No pending requisitions"}):u.map(e=>(0,Ug.jsxs)("div",{className:"p-3",children:[(0,Ug.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,Ug.jsx)("div",{className:"font-medium",children:e.serviceCenterName}),(0,Ug.jsx)("div",{className:"text-xs text-slate-400",children:new Date(e.createdAt).toLocaleString()})]}),(0,Ug.jsxs)("div",{className:"text-sm text-slate-400",children:[e.items.length," items requested by ",e.requestedBy]})]},e.id))})]})]}),(0,Ug.jsxs)("div",{className:"mt-6 bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[(0,Ug.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700 font-bold flex items-center gap-2",children:[(0,Ug.jsx)(ne,{size:18,className:"text-emerald-400"})," Recent Transactions"]}),(0,Ug.jsxs)("table",{className:"w-full text-sm",children:[(0,Ug.jsx)("thead",{className:"bg-slate-700/50 text-slate-400 uppercase text-xs",children:(0,Ug.jsxs)("tr",{children:[(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Time"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Staff"}),(0,Ug.jsx)("th",{className:"p-3 text-left",children:"Department"}),(0,Ug.jsx)("th",{className:"p-3 text-center",children:"Items"}),(0,Ug.jsx)("th",{className:"p-3 text-right",children:"Total"})]})}),(0,Ug.jsx)("tbody",{className:"divide-y divide-slate-700",children:i.slice(0,10).map(e=>{var t;return(0,Ug.jsxs)("tr",{className:"hover:bg-slate-700/50",children:[(0,Ug.jsx)("td",{className:"p-3 text-slate-400 text-xs",children:new Date(e.date).toLocaleTimeString()}),(0,Ug.jsx)("td",{className:"p-3 font-medium",children:e.staff}),(0,Ug.jsx)("td",{className:"p-3 text-slate-400",children:e.department}),(0,Ug.jsx)("td",{className:"p-3 text-center",children:(null===(t=e.items)||void 0===t?void 0:t.length)||0}),(0,Ug.jsx)("td",{className:"p-3 text-right font-mono text-emerald-400",children:e.total.toLocaleString()})]},e.id)})})]})]})]})]})};"undefined"===typeof window.__firebase_config&&console.error("FATAL: Firebase config not found. Please configure window.__firebase_config in public/index.html");s.createRoot(document.getElementById("root")).render((0,Ug.jsx)(r.StrictMode,{children:(0,Ug.jsx)(bv,{})}))})();
//# sourceMappingURL=main.21537a79.js.map